{"version":3,"file":"formula.min.js","sources":["../../src/utils/error.js","../../src/utils/common.js","../../src/date-time.js","../../node_modules/bessel/bessel.js","../../node_modules/jstat/dist/jstat.js","../../src/text.js","../../src/engineering.js","../../src/utils/criteria-eval.js","../../src/information.js","../../src/miscellaneous.js","../../src/statistical.js","../../src/math-trig.js","../../src/compatibility.js","../../src/database.js","../../src/financial.js","../../src/lookup-reference.js","../../src/logical.js"],"sourcesContent":["export const nil = new Error('#NULL!')\nexport const div0 = new Error('#DIV/0!')\nexport const value = new Error('#VALUE!')\nexport const ref = new Error('#REF!')\nexport const name = new Error('#NAME?')\nexport const num = new Error('#NUM!')\nexport const na = new Error('#N/A')\nexport const error = new Error('#ERROR!')\nexport const data = new Error('#GETTING_DATA')\n","import * as error from './error.js'\n\nexport function flattenShallow(array) {\n  if (!array || !array.reduce) {\n    return array\n  }\n\n  return array.reduce((a, b) => {\n    const aIsArray = Array.isArray(a)\n    const bIsArray = Array.isArray(b)\n\n    if (aIsArray && bIsArray) {\n      return a.concat(b)\n    }\n\n    if (aIsArray) {\n      a.push(b)\n\n      return a\n    }\n\n    if (bIsArray) {\n      return [a].concat(b)\n    }\n\n    return [a, b]\n  })\n}\n\nexport function isFlat(array) {\n  if (!array) {\n    return false\n  }\n\n  for (let i = 0; i < array.length; ++i) {\n    if (Array.isArray(array[i])) {\n      return false\n    }\n  }\n\n  return true\n}\n\nexport function flatten() {\n  let result = argsToArray.apply(null, arguments)\n\n  while (!isFlat(result)) {\n    result = flattenShallow(result)\n  }\n\n  return result\n}\n\nexport function argsToArray(args) {\n  const result = []\n\n  arrayEach(args, (value) => {\n    result.push(value)\n  })\n\n  return result\n}\n\nexport function numbers() {\n  const possibleNumbers = flatten.apply(null, arguments)\n\n  return possibleNumbers.filter((el) => typeof el === 'number')\n}\n\nexport function cleanFloat(number) {\n  const power = 1e14\n\n  return Math.round(number * power) / power\n}\n\nexport function parseBool(bool) {\n  if (typeof bool === 'boolean') {\n    return bool\n  }\n\n  if (bool instanceof Error) {\n    return bool\n  }\n\n  if (typeof bool === 'number') {\n    return bool !== 0\n  }\n\n  if (typeof bool === 'string') {\n    const up = bool.toUpperCase()\n\n    if (up === 'TRUE') {\n      return true\n    }\n\n    if (up === 'FALSE') {\n      return false\n    }\n  }\n\n  if (bool instanceof Date && !isNaN(bool)) {\n    return true\n  }\n\n  return error.value\n}\n\nexport function parseNumber(string) {\n  if (string instanceof Error) {\n    return string\n  }\n\n  if (string === undefined || string === null || string === '') {\n    return 0\n  }\n\n  if (typeof string === 'boolean') {\n    string = +string\n  }\n\n  if (!isNaN(string)) {\n    return parseFloat(string)\n  }\n\n  return error.value\n}\n\nexport function parseString(string) {\n  if (string instanceof Error) {\n    return string\n  }\n\n  if (string === undefined || string === null) {\n    return ''\n  }\n\n  return string.toString()\n}\n\nexport function parseNumberArray(arr) {\n  let len\n\n  if (!arr || (len = arr.length) === 0) {\n    return error.value\n  }\n\n  let parsed\n\n  while (len--) {\n    if (arr[len] instanceof Error) {\n      return arr[len]\n    }\n\n    parsed = parseNumber(arr[len])\n\n    if (parsed instanceof Error) {\n      return parsed\n    }\n\n    arr[len] = parsed\n  }\n\n  return arr\n}\n\nexport function parseMatrix(matrix) {\n  const n = matrix.length\n\n  if (!matrix || n === 0) {\n    return error.value\n  }\n\n  let pnarr\n\n  for (let i = 0; i < matrix.length; i++) {\n    pnarr = parseNumberArray(matrix[i])\n    matrix[i] = pnarr\n\n    if (pnarr instanceof Error) {\n      return pnarr\n    }\n  }\n\n  return matrix\n}\n\nfunction serialNumberToDate(serial) {\n  if (serial < 60) {\n    serial += 1\n  }\n\n  const utc_days = Math.floor(serial - 25569)\n  const utc_value = utc_days * 86400\n  const date_info = new Date(utc_value * 1000)\n  const fractional_day = serial - Math.floor(serial) + 0.0000001\n\n  let total_seconds = Math.floor(86400 * fractional_day)\n\n  const seconds = total_seconds % 60\n\n  total_seconds -= seconds\n\n  const hours = Math.floor(total_seconds / (60 * 60))\n  const minutes = Math.floor(total_seconds / 60) % 60\n  let days = date_info.getDate()\n  let month = date_info.getMonth()\n\n  if (serial >= 60 && serial < 61) {\n    days = 29\n    month = 1\n  }\n\n  return new Date(date_info.getFullYear(), month, days, hours, minutes, seconds)\n}\n\nexport function parseDate(date) {\n  if (!isNaN(date)) {\n    if (date instanceof Date) {\n      return new Date(date)\n    }\n\n    const d = parseFloat(date)\n\n    if (d < 0 || d >= 2958466) {\n      return error.num\n    }\n\n    return serialNumberToDate(d)\n  }\n\n  if (typeof date === 'string') {\n    date = new Date(date)\n\n    if (!isNaN(date)) {\n      return date\n    }\n  }\n\n  return error.value\n}\n\nexport function parseDateArray(arr) {\n  let len = arr.length\n  let parsed\n\n  while (len--) {\n    parsed = parseDate(arr[len])\n\n    if (parsed === error.value) {\n      return parsed\n    }\n\n    arr[len] = parsed\n  }\n\n  return arr\n}\n\nexport function anyError() {\n  for (let n = 0; n < arguments.length; n++) {\n    if (arguments[n] instanceof Error) {\n      return arguments[n]\n    }\n  }\n\n  return undefined\n}\n\nexport function isDefined(arg) {\n  return arg !== undefined && arg !== null\n}\n\nexport function anyIsError() {\n  let n = arguments.length\n\n  while (n--) {\n    if (arguments[n] instanceof Error) {\n      return true\n    }\n  }\n\n  return false\n}\n\nexport function anyIsString() {\n  let n = arguments.length\n\n  while (n--) {\n    if (typeof arguments[n] === 'string') {\n      return true\n    }\n  }\n\n  return false\n}\n\nexport function arrayValuesToNumbers(arr) {\n  let n = arr.length\n  let el\n\n  while (n--) {\n    el = arr[n]\n\n    if (typeof el === 'number') {\n      continue\n    }\n\n    if (el === true) {\n      arr[n] = 1\n      continue\n    }\n\n    if (el === false) {\n      arr[n] = 0\n      continue\n    }\n\n    if (typeof el === 'string') {\n      const number = parseNumber(el)\n\n      if (number instanceof Error) {\n        arr[n] = 0\n      } else {\n        arr[n] = number\n      }\n    }\n  }\n\n  return arr\n}\n\nexport function rest(array, idx) {\n  idx = idx || 1\n\n  if (!array || typeof array.slice !== 'function') {\n    return array\n  }\n\n  return array.slice(idx)\n}\n\nexport function initial(array, idx) {\n  idx = idx || 1\n\n  if (!array || typeof array.slice !== 'function') {\n    return array\n  }\n\n  return array.slice(0, array.length - idx)\n}\n\nexport function arrayEach(array, iteratee) {\n  let index = -1\n  const length = array.length\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break\n    }\n  }\n\n  return array\n}\n\nexport function transpose(matrix) {\n  if (!matrix) {\n    return error.value\n  }\n\n  return matrix[0].map((col, i) => matrix.map((row) => row[i]))\n}\n","import * as error from './utils/error.js'\nimport * as utils from './utils/common.js'\n\nconst d1900 = new Date(Date.UTC(1900, 0, 1))\nconst WEEK_STARTS = [\n  undefined,\n  0,\n  1,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  1,\n  2,\n  3,\n  4,\n  5,\n  6,\n  0\n]\nconst WEEK_TYPES = [\n  [],\n  [1, 2, 3, 4, 5, 6, 7],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 0, 1, 2, 3, 4, 5],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 7, 1, 2, 3, 4, 5],\n  [5, 6, 7, 1, 2, 3, 4],\n  [4, 5, 6, 7, 1, 2, 3],\n  [3, 4, 5, 6, 7, 1, 2],\n  [2, 3, 4, 5, 6, 7, 1],\n  [1, 2, 3, 4, 5, 6, 7]\n]\nconst WEEKEND_TYPES = [\n  [],\n  [6, 0],\n  [0, 1],\n  [1, 2],\n  [2, 3],\n  [3, 4],\n  [4, 5],\n  [5, 6],\n  undefined,\n  undefined,\n  undefined,\n  [0, 0],\n  [1, 1],\n  [2, 2],\n  [3, 3],\n  [4, 4],\n  [5, 5],\n  [6, 6]\n]\n\nexport function DATE(year, month, day) {\n  let result\n\n  year = utils.parseNumber(year)\n  month = utils.parseNumber(month)\n  day = utils.parseNumber(day)\n\n  if (utils.anyIsError(year, month, day)) {\n    result = error.value\n  } else {\n    result = new Date(year, month - 1, day)\n\n    if (result.getFullYear() < 0) {\n      result = error.num\n    }\n  }\n\n  return result\n}\n\nexport function DATEDIF(start_date, end_date, unit) {\n  unit = unit.toUpperCase()\n  start_date = utils.parseDate(start_date)\n  end_date = utils.parseDate(end_date)\n\n  const start_date_year = start_date.getFullYear()\n  const start_date_month = start_date.getMonth()\n  const start_date_day = start_date.getDate()\n  const end_date_year = end_date.getFullYear()\n  const end_date_month = end_date.getMonth()\n  const end_date_day = end_date.getDate()\n\n  let result\n\n  switch (unit) {\n    case 'Y':\n      result = Math.floor(YEARFRAC(start_date, end_date))\n      break\n    case 'D':\n      result = DAYS(end_date, start_date)\n      break\n    case 'M':\n      result = end_date_month - start_date_month + 12 * (end_date_year - start_date_year)\n\n      if (end_date_day < start_date_day) {\n        result--\n      }\n\n      break\n    case 'MD':\n      if (start_date_day <= end_date_day) {\n        result = end_date_day - start_date_day\n      } else {\n        if (end_date_month === 0) {\n          start_date.setFullYear(end_date_year - 1)\n          start_date.setMonth(12)\n        } else {\n          start_date.setFullYear(end_date_year)\n          start_date.setMonth(end_date_month - 1)\n        }\n\n        result = DAYS(end_date, start_date)\n      }\n\n      break\n    case 'YM':\n      result = end_date_month - start_date_month + 12 * (end_date_year - start_date_year)\n\n      if (end_date_day < start_date_day) {\n        result--\n      }\n\n      result = result % 12\n      break\n    case 'YD':\n      if (end_date_month > start_date_month || (end_date_month === start_date_month && end_date_day < start_date_day)) {\n        start_date.setFullYear(end_date_year)\n      } else {\n        start_date.setFullYear(end_date_year - 1)\n      }\n\n      result = DAYS(end_date, start_date)\n      break\n  }\n\n  return result\n}\n\nexport function DATEVALUE(date_text) {\n  if (typeof date_text !== 'string') {\n    return error.value\n  }\n\n  const date = Date.parse(date_text)\n\n  if (isNaN(date)) {\n    return error.value\n  }\n\n  return new Date(date_text)\n}\n\nexport function DAY(serial_number) {\n  const date = utils.parseDate(serial_number)\n\n  if (date instanceof Error) {\n    return date\n  }\n\n  return date.getDate()\n}\n\nfunction startOfDay(date) {\n  const newDate = new Date(date)\n  newDate.setHours(0, 0, 0, 0)\n\n  return newDate\n}\n\nexport function DAYS(end_date, start_date) {\n  end_date = utils.parseDate(end_date)\n  start_date = utils.parseDate(start_date)\n\n  if (end_date instanceof Error) {\n    return end_date\n  }\n\n  if (start_date instanceof Error) {\n    return start_date\n  }\n\n  return serial(startOfDay(end_date)) - serial(startOfDay(start_date))\n}\n\nexport function DAYS360(start_date, end_date, method) {\n  method = utils.parseBool(method || 'false')\n  start_date = utils.parseDate(start_date)\n  end_date = utils.parseDate(end_date)\n\n  if (start_date instanceof Error) {\n    return start_date\n  }\n\n  if (end_date instanceof Error) {\n    return end_date\n  }\n\n  if (method instanceof Error) {\n    return method\n  }\n\n  const sm = start_date.getMonth()\n  let em = end_date.getMonth()\n  let sd, ed\n\n  if (method) {\n    sd = start_date.getDate() === 31 ? 30 : start_date.getDate()\n    ed = end_date.getDate() === 31 ? 30 : end_date.getDate()\n  } else {\n    const smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate()\n    const emd = new Date(end_date.getFullYear(), em + 1, 0).getDate()\n    sd = start_date.getDate() === smd ? 30 : start_date.getDate()\n\n    if (end_date.getDate() === emd) {\n      if (sd < 30) {\n        em++\n        ed = 1\n      } else {\n        ed = 30\n      }\n    } else {\n      ed = end_date.getDate()\n    }\n  }\n\n  return 360 * (end_date.getFullYear() - start_date.getFullYear()) + 30 * (em - sm) + (ed - sd)\n}\n\nexport function EDATE(start_date, months) {\n  start_date = utils.parseDate(start_date)\n\n  if (start_date instanceof Error) {\n    return start_date\n  }\n\n  if (isNaN(months)) {\n    return error.value\n  }\n\n  months = parseInt(months, 10)\n  start_date.setMonth(start_date.getMonth() + months)\n\n  return start_date\n}\n\nexport function EOMONTH(start_date, months) {\n  start_date = utils.parseDate(start_date)\n\n  if (start_date instanceof Error) {\n    return start_date\n  }\n\n  if (isNaN(months)) {\n    return error.value\n  }\n\n  months = parseInt(months, 10)\n\n  return new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0)\n}\n\nexport function HOUR(serial_number) {\n  serial_number = utils.parseDate(serial_number)\n\n  if (serial_number instanceof Error) {\n    return serial_number\n  }\n\n  return serial_number.getHours()\n}\n\nexport function INTERVAL(second) {\n  if (typeof second !== 'number' && typeof second !== 'string') {\n    return error.value\n  } else {\n    second = parseInt(second, 10)\n  }\n\n  let year = Math.floor(second / 946080000)\n  second = second % 946080000\n  let month = Math.floor(second / 2592000)\n  second = second % 2592000\n  let day = Math.floor(second / 86400)\n  second = second % 86400\n\n  let hour = Math.floor(second / 3600)\n  second = second % 3600\n  let min = Math.floor(second / 60)\n  second = second % 60\n  let sec = second\n\n  year = year > 0 ? year + 'Y' : ''\n  month = month > 0 ? month + 'M' : ''\n  day = day > 0 ? day + 'D' : ''\n  hour = hour > 0 ? hour + 'H' : ''\n  min = min > 0 ? min + 'M' : ''\n  sec = sec > 0 ? sec + 'S' : ''\n\n  return 'P' + year + month + day + 'T' + hour + min + sec\n}\n\nexport function ISOWEEKNUM(date) {\n  date = utils.parseDate(date)\n\n  if (date instanceof Error) {\n    return date\n  }\n\n  date = startOfDay(date)\n  date.setDate(date.getDate() + 4 - (date.getDay() || 7))\n  const yearStart = new Date(date.getFullYear(), 0, 1)\n\n  return Math.ceil(((date - yearStart) / 86400000 + 1) / 7)\n}\n\nexport function MINUTE(serial_number) {\n  serial_number = utils.parseDate(serial_number)\n\n  if (serial_number instanceof Error) {\n    return serial_number\n  }\n\n  return serial_number.getMinutes()\n}\n\nexport function MONTH(serial_number) {\n  serial_number = utils.parseDate(serial_number)\n\n  if (serial_number instanceof Error) {\n    return serial_number\n  }\n\n  return serial_number.getMonth() + 1\n}\n\nexport function NETWORKDAYS(start_date, end_date, holidays) {\n  return NETWORKDAYS.INTL(start_date, end_date, 1, holidays)\n}\n\nNETWORKDAYS.INTL = (start_date, end_date, weekend, holidays) => {\n  start_date = utils.parseDate(start_date)\n\n  if (start_date instanceof Error) {\n    return start_date\n  }\n\n  end_date = utils.parseDate(end_date)\n\n  if (end_date instanceof Error) {\n    return end_date\n  }\n\n  let isMask = false\n  const maskDays = []\n  const maskIndex = [1, 2, 3, 4, 5, 6, 0]\n  const maskRegex = new RegExp('^[0|1]{7}$')\n\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1]\n  } else if (typeof weekend === 'string' && maskRegex.test(weekend)) {\n    isMask = true\n    weekend = weekend.split('')\n\n    for (let i = 0; i < weekend.length; i++) {\n      if (weekend[i] === '1') {\n        maskDays.push(maskIndex[i])\n      }\n    }\n  } else {\n    weekend = WEEKEND_TYPES[weekend]\n  }\n\n  if (!(weekend instanceof Array)) {\n    return error.value\n  }\n\n  if (holidays === undefined) {\n    holidays = []\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays]\n  }\n\n  for (let i = 0; i < holidays.length; i++) {\n    const h = utils.parseDate(holidays[i])\n\n    if (h instanceof Error) {\n      return h\n    }\n\n    holidays[i] = h\n  }\n\n  const days = Math.round((end_date - start_date) / (1000 * 60 * 60 * 24)) + 1\n  let total = days\n  const day = start_date\n\n  for (let i = 0; i < days; i++) {\n    const d = new Date().getTimezoneOffset() > 0 ? day.getUTCDay() : day.getDay()\n    let dec = isMask ? maskDays.includes(d) : d === weekend[0] || d === weekend[1]\n\n    for (let j = 0; j < holidays.length; j++) {\n      const holiday = holidays[j]\n\n      if (\n        holiday.getDate() === day.getDate() &&\n        holiday.getMonth() === day.getMonth() &&\n        holiday.getFullYear() === day.getFullYear()\n      ) {\n        dec = true\n        break\n      }\n    }\n\n    if (dec) {\n      total--\n    }\n\n    day.setDate(day.getDate() + 1)\n  }\n\n  return total\n}\n\nexport function NOW() {\n  return new Date()\n}\n\nexport function SECOND(serial_number) {\n  serial_number = utils.parseDate(serial_number)\n\n  if (serial_number instanceof Error) {\n    return serial_number\n  }\n\n  return serial_number.getSeconds()\n}\n\nexport function TIME(hour, minute, second) {\n  hour = utils.parseNumber(hour)\n  minute = utils.parseNumber(minute)\n  second = utils.parseNumber(second)\n\n  if (utils.anyIsError(hour, minute, second)) {\n    return error.value\n  }\n\n  if (hour < 0 || minute < 0 || second < 0) {\n    return error.num\n  }\n\n  return (3600 * hour + 60 * minute + second) / 86400\n}\n\nexport function TIMEVALUE(time_text) {\n  time_text = utils.parseDate(time_text)\n\n  if (time_text instanceof Error) {\n    return time_text\n  }\n\n  return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400\n}\n\nexport function TODAY() {\n  return startOfDay(new Date())\n}\n\nexport function WEEKDAY(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number)\n\n  if (serial_number instanceof Error) {\n    return serial_number\n  }\n\n  if (return_type === undefined) {\n    return_type = 1\n  }\n\n  const day = serial_number.getDay()\n\n  return WEEK_TYPES[return_type][day]\n}\n\nexport function WEEKNUM(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number)\n\n  if (serial_number instanceof Error) {\n    return serial_number\n  }\n\n  if (return_type === undefined) {\n    return_type = 1\n  }\n\n  if (return_type === 21) {\n    return ISOWEEKNUM(serial_number)\n  }\n\n  const week_start = WEEK_STARTS[return_type]\n  let jan = new Date(serial_number.getFullYear(), 0, 1)\n  const inc = jan.getDay() < week_start ? 1 : 0\n  jan -= Math.abs(jan.getDay() - week_start) * 24 * 60 * 60 * 1000\n\n  return Math.floor((serial_number - jan) / (1000 * 60 * 60 * 24) / 7 + 1) + inc\n}\n\nexport function WORKDAY(start_date, days, holidays) {\n  return WORKDAY.INTL(start_date, days, 1, holidays)\n}\n\nWORKDAY.INTL = (start_date, days, weekend, holidays) => {\n  start_date = utils.parseDate(start_date)\n\n  if (start_date instanceof Error) {\n    return start_date\n  }\n\n  days = utils.parseNumber(days)\n\n  if (days instanceof Error) {\n    return days\n  }\n\n  if (days < 0) {\n    return error.num\n  }\n\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1]\n  } else {\n    weekend = WEEKEND_TYPES[weekend]\n  }\n\n  if (!(weekend instanceof Array)) {\n    return error.value\n  }\n\n  if (holidays === undefined) {\n    holidays = []\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays]\n  }\n\n  for (let i = 0; i < holidays.length; i++) {\n    const h = utils.parseDate(holidays[i])\n\n    if (h instanceof Error) {\n      return h\n    }\n\n    holidays[i] = h\n  }\n\n  let d = 0\n\n  while (d < days) {\n    start_date.setDate(start_date.getDate() + 1)\n    const day = start_date.getDay()\n\n    if (day === weekend[0] || day === weekend[1]) {\n      continue\n    }\n\n    for (let j = 0; j < holidays.length; j++) {\n      const holiday = holidays[j]\n\n      if (\n        holiday.getDate() === start_date.getDate() &&\n        holiday.getMonth() === start_date.getMonth() &&\n        holiday.getFullYear() === start_date.getFullYear()\n      ) {\n        d--\n        break\n      }\n    }\n\n    d++\n  }\n\n  return start_date\n}\n\nexport function YEAR(serial_number) {\n  serial_number = utils.parseDate(serial_number)\n\n  if (serial_number instanceof Error) {\n    return serial_number\n  }\n\n  return serial_number.getFullYear()\n}\n\nfunction isLeapYear(year) {\n  return new Date(year, 1, 29).getMonth() === 1\n}\n\n// TODO : Use DAYS ?\nfunction daysBetween(start_date, end_date) {\n  return Math.ceil((end_date - start_date) / 1000 / 60 / 60 / 24)\n}\n\nexport function YEARFRAC(start_date, end_date, basis) {\n  start_date = utils.parseDate(start_date)\n\n  if (start_date instanceof Error) {\n    return start_date\n  }\n\n  end_date = utils.parseDate(end_date)\n\n  if (end_date instanceof Error) {\n    return end_date\n  }\n\n  basis = basis || 0\n  let sd = start_date.getDate()\n  const sm = start_date.getMonth() + 1\n  const sy = start_date.getFullYear()\n  let ed = end_date.getDate()\n  const em = end_date.getMonth() + 1\n  const ey = end_date.getFullYear()\n\n  switch (basis) {\n    case 0:\n      // US (NASD) 30/360\n      if (sd === 31 && ed === 31) {\n        sd = 30\n        ed = 30\n      } else if (sd === 31) {\n        sd = 30\n      } else if (sd === 30 && ed === 31) {\n        ed = 30\n      }\n\n      return (ed + em * 30 + ey * 360 - (sd + sm * 30 + sy * 360)) / 360\n    case 1: {\n      // Actual/actual\n      const feb29Between = (date1, date2) => {\n        const year1 = date1.getFullYear()\n        const mar1year1 = new Date(year1, 2, 1)\n\n        if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {\n          return true\n        }\n\n        const year2 = date2.getFullYear()\n        const mar1year2 = new Date(year2, 2, 1)\n\n        return isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2\n      }\n\n      let ylength = 365\n\n      if (sy === ey || (sy + 1 === ey && (sm > em || (sm === em && sd >= ed)))) {\n        if ((sy === ey && isLeapYear(sy)) || feb29Between(start_date, end_date) || (em === 1 && ed === 29)) {\n          ylength = 366\n        }\n\n        return daysBetween(start_date, end_date) / ylength\n      }\n\n      const years = ey - sy + 1\n      const days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24\n      const average = days / years\n\n      return daysBetween(start_date, end_date) / average\n    }\n\n    case 2:\n      // Actual/360\n\n      return daysBetween(start_date, end_date) / 360\n    case 3:\n      // Actual/365\n\n      return daysBetween(start_date, end_date) / 365\n    case 4:\n      // European 30/360\n\n      return (ed + em * 30 + ey * 360 - (sd + sm * 30 + sy * 360)) / 360\n  }\n}\n\nfunction serial(date) {\n  const addOn = date > -2203891200000 ? 2 : 1\n\n  return Math.ceil((date - d1900) / 86400000) + addOn\n}\n","/* bessel.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported BESSEL */\nvar BESSEL;\n(function (factory) {\n  /*jshint ignore:start */\n  if(typeof DO_NOT_EXPORT_BESSEL === 'undefined') {\n    if('object' === typeof exports) {\n      factory(exports);\n    } else if ('function' === typeof define && define.amd) {\n      define(function () {\n        var module = {};\n        factory(module);\n        return module;\n      });\n    } else {\n      factory(BESSEL = {});\n    }\n  } else {\n    factory(BESSEL = {});\n  }\n  /*jshint ignore:end */\n}(function(BESSEL) {\nBESSEL.version = '1.0.2';\nvar M = Math;\n\nfunction _horner(arr, v) { for(var i = 0, z = 0; i < arr.length; ++i) z = v * z + arr[i]; return z; }\nfunction _bessel_iter(x, n, f0, f1, sign) {\n  if(n === 0) return f0;\n  if(n === 1) return f1;\n  var tdx = 2 / x, f2 = f1;\n  for(var o = 1; o < n; ++o) {\n    f2 = f1 * o * tdx + sign * f0;\n    f0 = f1; f1 = f2;\n  }\n  return f2;\n}\nfunction _bessel_wrap(bessel0, bessel1, name, nonzero, sign) {\n  return function bessel(x,n) {\n    if(nonzero) {\n      if(x === 0) return (nonzero == 1 ? -Infinity : Infinity);\n      else if(x < 0) return NaN;\n    }\n    if(n === 0) return bessel0(x);\n    if(n === 1) return bessel1(x);\n    if(n < 0) return NaN;\n    n|=0;\n    var b0 = bessel0(x), b1 = bessel1(x);\n    return _bessel_iter(x, n, b0, b1, sign);\n  };\n}\nvar besselj = (function() {\n  var W = 0.636619772; // 2 / Math.PI\n\n  var b0_a1a = [57568490574.0, -13362590354.0, 651619640.7, -11214424.18, 77392.33017, -184.9052456].reverse();\n  var b0_a2a = [57568490411.0, 1029532985.0, 9494680.718, 59272.64853, 267.8532712, 1.0].reverse();\n  var b0_a1b = [1.0, -0.1098628627e-2, 0.2734510407e-4, -0.2073370639e-5, 0.2093887211e-6].reverse();\n  var b0_a2b = [-0.1562499995e-1, 0.1430488765e-3, -0.6911147651e-5, 0.7621095161e-6, -0.934935152e-7].reverse();\n\n  function bessel0(x) {\n    var a=0, a1=0, a2=0, y = x * x;\n    if(x < 8) {\n      a1 = _horner(b0_a1a, y);\n      a2 = _horner(b0_a2a, y);\n      a = a1 / a2;\n    } else {\n      var xx = x - 0.785398164;\n      y = 64 / y;\n      a1 = _horner(b0_a1b, y);\n      a2 = _horner(b0_a2b, y);\n      a = M.sqrt(W/x)*(M.cos(xx)*a1-M.sin(xx)*a2*8/x);\n    }\n    return a;\n  }\n\n  var b1_a1a = [72362614232.0, -7895059235.0, 242396853.1, -2972611.439, 15704.48260, -30.16036606].reverse();\n  var b1_a2a = [144725228442.0, 2300535178.0, 18583304.74, 99447.43394, 376.9991397, 1.0].reverse();\n  var b1_a1b = [1.0, 0.183105e-2, -0.3516396496e-4, 0.2457520174e-5, -0.240337019e-6].reverse();\n  var b1_a2b = [0.04687499995, -0.2002690873e-3, 0.8449199096e-5, -0.88228987e-6, 0.105787412e-6].reverse();\n\n  function bessel1(x) {\n    var a=0, a1=0, a2=0, y = x*x, xx = M.abs(x) - 2.356194491;\n    if(Math.abs(x)< 8) {\n      a1 = x*_horner(b1_a1a, y);\n      a2 = _horner(b1_a2a, y);\n      a = a1 / a2;\n    } else {\n      y = 64 / y;\n      a1=_horner(b1_a1b, y);\n      a2=_horner(b1_a2b, y);\n      a=M.sqrt(W/M.abs(x))*(M.cos(xx)*a1-M.sin(xx)*a2*8/M.abs(x));\n      if(x < 0) a = -a;\n    }\n    return a;\n  }\n\n  return function besselj(x, n) {\n    n = Math.round(n);\n    if(!isFinite(x)) return isNaN(x) ? x : 0;\n    if(n < 0) return ((n%2)?-1:1)*besselj(x, -n);\n    if(x < 0) return ((n%2)?-1:1)*besselj(-x, n);\n    if(n === 0) return bessel0(x);\n    if(n === 1) return bessel1(x);\n    if(x === 0) return 0;\n\n    var ret=0.0;\n    if(x > n) {\n      ret = _bessel_iter(x, n, bessel0(x), bessel1(x),-1);\n    } else {\n      var m=2*M.floor((n+M.floor(M.sqrt(40*n)))/2);\n      var jsum=false;\n      var bjp=0.0, sum=0.0;\n      var bj=1.0, bjm = 0.0;\n      var tox = 2 / x;\n      for (var j=m;j>0;j--) {\n        bjm=j*tox*bj-bjp;\n        bjp=bj;\n        bj=bjm;\n        if (M.abs(bj) > 1E10) {\n          bj *= 1E-10;\n          bjp *= 1E-10;\n          ret *= 1E-10;\n          sum *= 1E-10;\n        }\n        if (jsum) sum += bj;\n        jsum=!jsum;\n        if (j == n) ret=bjp;\n      }\n      sum=2.0*sum-bj;\n      ret /= sum;\n    }\n    return ret;\n  };\n})();\nvar bessely = (function() {\n  var W = 0.636619772;\n\n  var b0_a1a = [-2957821389.0, 7062834065.0, -512359803.6, 10879881.29, -86327.92757, 228.4622733].reverse();\n  var b0_a2a = [40076544269.0, 745249964.8, 7189466.438, 47447.26470, 226.1030244, 1.0].reverse();\n  var b0_a1b = [1.0, -0.1098628627e-2, 0.2734510407e-4, -0.2073370639e-5, 0.2093887211e-6].reverse();\n  var b0_a2b = [-0.1562499995e-1, 0.1430488765e-3, -0.6911147651e-5, 0.7621095161e-6, -0.934945152e-7].reverse();\n\n  function bessel0(x) {\n    var a=0, a1=0, a2=0, y = x * x, xx = x - 0.785398164;\n    if(x < 8) {\n      a1 = _horner(b0_a1a, y);\n      a2 = _horner(b0_a2a, y);\n      a = a1/a2 + W * besselj(x,0) * M.log(x);\n    } else {\n      y = 64 / y;\n      a1 = _horner(b0_a1b, y);\n      a2 = _horner(b0_a2b, y);\n      a = M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);\n    }\n    return a;\n  }\n\n  var b1_a1a = [-0.4900604943e13, 0.1275274390e13, -0.5153438139e11, 0.7349264551e9, -0.4237922726e7, 0.8511937935e4].reverse();\n  var b1_a2a = [0.2499580570e14, 0.4244419664e12, 0.3733650367e10, 0.2245904002e8, 0.1020426050e6, 0.3549632885e3, 1].reverse();\n  var b1_a1b = [1.0, 0.183105e-2, -0.3516396496e-4, 0.2457520174e-5, -0.240337019e-6].reverse();\n  var b1_a2b = [0.04687499995, -0.2002690873e-3, 0.8449199096e-5, -0.88228987e-6, 0.105787412e-6].reverse();\n\n  function bessel1(x) {\n    var a=0, a1=0, a2=0, y = x*x, xx = x - 2.356194491;\n    if(x < 8) {\n      a1 = x*_horner(b1_a1a, y);\n      a2 = _horner(b1_a2a, y);\n      a = a1/a2 + W * (besselj(x,1) * M.log(x) - 1 / x);\n    } else {\n      y = 64 / y;\n      a1=_horner(b1_a1b, y);\n      a2=_horner(b1_a2b, y);\n      a=M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);\n    }\n    return a;\n  }\n\n  return _bessel_wrap(bessel0, bessel1, 'BESSELY', 1, -1);\n})();\nvar besseli = (function() {\n  var b0_a = [1.0, 3.5156229, 3.0899424, 1.2067492, 0.2659732, 0.360768e-1, 0.45813e-2].reverse();\n  var b0_b = [0.39894228, 0.1328592e-1, 0.225319e-2, -0.157565e-2, 0.916281e-2, -0.2057706e-1, 0.2635537e-1, -0.1647633e-1, 0.392377e-2].reverse();\n\n  function bessel0(x) {\n    if(x <= 3.75) return _horner(b0_a, x*x/(3.75*3.75));\n    return M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b0_b, 3.75/M.abs(x));\n  }\n\n  var b1_a = [0.5, 0.87890594, 0.51498869, 0.15084934, 0.2658733e-1, 0.301532e-2, 0.32411e-3].reverse();\n  var b1_b = [0.39894228, -0.3988024e-1, -0.362018e-2, 0.163801e-2, -0.1031555e-1, 0.2282967e-1, -0.2895312e-1, 0.1787654e-1, -0.420059e-2].reverse();\n\n  function bessel1(x) {\n    if(x < 3.75) return x * _horner(b1_a, x*x/(3.75*3.75));\n    return (x < 0 ? -1 : 1) * M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b1_b, 3.75/M.abs(x));\n  }\n\n  return function besseli(x, n) {\n    n = Math.round(n);\n    if(n === 0) return bessel0(x);\n    if(n === 1) return bessel1(x);\n    if(n < 0) return NaN;\n    if(M.abs(x) === 0) return 0;\n    if(x == Infinity) return Infinity;\n\n    var ret = 0.0, j, tox = 2 / M.abs(x), bip = 0.0, bi=1.0, bim=0.0;\n    var m=2*M.round((n+M.round(M.sqrt(40*n)))/2);\n    for (j=m;j>0;j--) {\n      bim=j*tox*bi + bip;\n      bip=bi; bi=bim;\n      if (M.abs(bi) > 1E10) {\n        bi *= 1E-10;\n        bip *= 1E-10;\n        ret *= 1E-10;\n      }\n      if(j == n) ret = bip;\n    }\n    ret *= besseli(x, 0) / bi;\n    return x < 0 && (n%2) ? -ret : ret;\n  };\n\n})();\n\nvar besselk = (function() {\n  var b0_a = [-0.57721566, 0.42278420, 0.23069756, 0.3488590e-1, 0.262698e-2, 0.10750e-3, 0.74e-5].reverse();\n  var b0_b = [1.25331414, -0.7832358e-1, 0.2189568e-1, -0.1062446e-1, 0.587872e-2, -0.251540e-2, 0.53208e-3].reverse();\n\n  function bessel0(x) {\n    if(x <= 2) return -M.log(x/2) * besseli(x,0) + _horner(b0_a, x*x/4);\n    return M.exp(-x) / M.sqrt(x) * _horner(b0_b, 2/x);\n  }\n\n  var b1_a = [1.0, 0.15443144, -0.67278579, -0.18156897, -0.1919402e-1, -0.110404e-2, -0.4686e-4].reverse();\n  var b1_b = [1.25331414, 0.23498619, -0.3655620e-1, 0.1504268e-1, -0.780353e-2, 0.325614e-2, -0.68245e-3].reverse();\n\n  function bessel1(x) {\n    if(x <= 2) return M.log(x/2) * besseli(x,1) + (1/x) * _horner(b1_a, x*x/4);\n    return M.exp(-x)/M.sqrt(x)*_horner(b1_b, 2/x);\n  }\n\n  return _bessel_wrap(bessel0, bessel1, 'BESSELK', 2, 1);\n})();\nBESSEL.besselj = besselj;\nBESSEL.bessely = bessely;\nBESSEL.besseli = besseli;\nBESSEL.besselk = besselk;\n}));\n","(function (window, factory) {\n    if (typeof exports === 'object') {\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        define(factory);\n    } else {\n        window.jStat = factory();\n    }\n})(this, function () {\nvar jStat = (function(Math, undefined) {\n\n// For quick reference.\nvar concat = Array.prototype.concat;\nvar slice = Array.prototype.slice;\nvar toString = Object.prototype.toString;\n\n// Calculate correction for IEEE error\n// TODO: This calculation can be improved.\nfunction calcRdx(n, m) {\n  var val = n > m ? n : m;\n  return Math.pow(10,\n                  17 - ~~(Math.log(((val > 0) ? val : -val)) * Math.LOG10E));\n}\n\n\nvar isArray = Array.isArray || function isArray(arg) {\n  return toString.call(arg) === '[object Array]';\n};\n\n\nfunction isFunction(arg) {\n  return toString.call(arg) === '[object Function]';\n}\n\n\nfunction isNumber(num) {\n  return (typeof num === 'number') ? num - num === 0 : false;\n}\n\n\n// Converts the jStat matrix to vector.\nfunction toVector(arr) {\n  return concat.apply([], arr);\n}\n\n\n// The one and only jStat constructor.\nfunction jStat() {\n  return new jStat._init(arguments);\n}\n\n\n// TODO: Remove after all references in src files have been removed.\njStat.fn = jStat.prototype;\n\n\n// By separating the initializer from the constructor it's easier to handle\n// always returning a new instance whether \"new\" was used or not.\njStat._init = function _init(args) {\n  // If first argument is an array, must be vector or matrix.\n  if (isArray(args[0])) {\n    // Check if matrix.\n    if (isArray(args[0][0])) {\n      // See if a mapping function was also passed.\n      if (isFunction(args[1]))\n        args[0] = jStat.map(args[0], args[1]);\n      // Iterate over each is faster than this.push.apply(this, args[0].\n      for (var i = 0; i < args[0].length; i++)\n        this[i] = args[0][i];\n      this.length = args[0].length;\n\n    // Otherwise must be a vector.\n    } else {\n      this[0] = isFunction(args[1]) ? jStat.map(args[0], args[1]) : args[0];\n      this.length = 1;\n    }\n\n  // If first argument is number, assume creation of sequence.\n  } else if (isNumber(args[0])) {\n    this[0] = jStat.seq.apply(null, args);\n    this.length = 1;\n\n  // Handle case when jStat object is passed to jStat.\n  } else if (args[0] instanceof jStat) {\n    // Duplicate the object and pass it back.\n    return jStat(args[0].toArray());\n\n  // Unexpected argument value, return empty jStat object.\n  // TODO: This is strange behavior. Shouldn't this throw or some such to let\n  // the user know they had bad arguments?\n  } else {\n    this[0] = [];\n    this.length = 1;\n  }\n\n  return this;\n};\njStat._init.prototype = jStat.prototype;\njStat._init.constructor = jStat;\n\n\n// Utility functions.\n// TODO: for internal use only?\njStat.utils = {\n  calcRdx: calcRdx,\n  isArray: isArray,\n  isFunction: isFunction,\n  isNumber: isNumber,\n  toVector: toVector\n};\n\n\njStat._random_fn = Math.random;\njStat.setRandom = function setRandom(fn) {\n  if (typeof fn !== 'function')\n    throw new TypeError('fn is not a function');\n  jStat._random_fn = fn;\n};\n\n\n// Easily extend the jStat object.\n// TODO: is this seriously necessary?\njStat.extend = function extend(obj) {\n  var i, j;\n\n  if (arguments.length === 1) {\n    for (j in obj)\n      jStat[j] = obj[j];\n    return this;\n  }\n\n  for (i = 1; i < arguments.length; i++) {\n    for (j in arguments[i])\n      obj[j] = arguments[i][j];\n  }\n\n  return obj;\n};\n\n\n// Returns the number of rows in the matrix.\njStat.rows = function rows(arr) {\n  return arr.length || 1;\n};\n\n\n// Returns the number of columns in the matrix.\njStat.cols = function cols(arr) {\n  return arr[0].length || 1;\n};\n\n\n// Returns the dimensions of the object { rows: i, cols: j }\njStat.dimensions = function dimensions(arr) {\n  return {\n    rows: jStat.rows(arr),\n    cols: jStat.cols(arr)\n  };\n};\n\n\n// Returns a specified row as a vector or return a sub matrix by pick some rows\njStat.row = function row(arr, index) {\n  if (isArray(index)) {\n    return index.map(function(i) {\n      return jStat.row(arr, i);\n    })\n  }\n  return arr[index];\n};\n\n\n// return row as array\n// rowa([[1,2],[3,4]],0) -> [1,2]\njStat.rowa = function rowa(arr, i) {\n  return jStat.row(arr, i);\n};\n\n\n// Returns the specified column as a vector or return a sub matrix by pick some\n// columns\njStat.col = function col(arr, index) {\n  if (isArray(index)) {\n    var submat = jStat.arange(arr.length).map(function() {\n      return new Array(index.length);\n    });\n    index.forEach(function(ind, i){\n      jStat.arange(arr.length).forEach(function(j) {\n        submat[j][i] = arr[j][ind];\n      });\n    });\n    return submat;\n  }\n  var column = new Array(arr.length);\n  for (var i = 0; i < arr.length; i++)\n    column[i] = [arr[i][index]];\n  return column;\n};\n\n\n// return column as array\n// cola([[1,2],[3,4]],0) -> [1,3]\njStat.cola = function cola(arr, i) {\n  return jStat.col(arr, i).map(function(a){ return a[0] });\n};\n\n\n// Returns the diagonal of the matrix\njStat.diag = function diag(arr) {\n  var nrow = jStat.rows(arr);\n  var res = new Array(nrow);\n  for (var row = 0; row < nrow; row++)\n    res[row] = [arr[row][row]];\n  return res;\n};\n\n\n// Returns the anti-diagonal of the matrix\njStat.antidiag = function antidiag(arr) {\n  var nrow = jStat.rows(arr) - 1;\n  var res = new Array(nrow);\n  for (var i = 0; nrow >= 0; nrow--, i++)\n    res[i] = [arr[i][nrow]];\n  return res;\n};\n\n// Transpose a matrix or array.\njStat.transpose = function transpose(arr) {\n  var obj = [];\n  var objArr, rows, cols, j, i;\n\n  // Make sure arr is in matrix format.\n  if (!isArray(arr[0]))\n    arr = [arr];\n\n  rows = arr.length;\n  cols = arr[0].length;\n\n  for (i = 0; i < cols; i++) {\n    objArr = new Array(rows);\n    for (j = 0; j < rows; j++)\n      objArr[j] = arr[j][i];\n    obj.push(objArr);\n  }\n\n  // If obj is vector, return only single array.\n  return obj.length === 1 ? obj[0] : obj;\n};\n\n\n// Map a function to an array or array of arrays.\n// \"toAlter\" is an internal variable.\njStat.map = function map(arr, func, toAlter) {\n  var row, nrow, ncol, res, col;\n\n  if (!isArray(arr[0]))\n    arr = [arr];\n\n  nrow = arr.length;\n  ncol = arr[0].length;\n  res = toAlter ? arr : new Array(nrow);\n\n  for (row = 0; row < nrow; row++) {\n    // if the row doesn't exist, create it\n    if (!res[row])\n      res[row] = new Array(ncol);\n    for (col = 0; col < ncol; col++)\n      res[row][col] = func(arr[row][col], row, col);\n  }\n\n  return res.length === 1 ? res[0] : res;\n};\n\n\n// Cumulatively combine the elements of an array or array of arrays using a function.\njStat.cumreduce = function cumreduce(arr, func, toAlter) {\n  var row, nrow, ncol, res, col;\n\n  if (!isArray(arr[0]))\n    arr = [arr];\n\n  nrow = arr.length;\n  ncol = arr[0].length;\n  res = toAlter ? arr : new Array(nrow);\n\n  for (row = 0; row < nrow; row++) {\n    // if the row doesn't exist, create it\n    if (!res[row])\n      res[row] = new Array(ncol);\n    if (ncol > 0)\n      res[row][0] = arr[row][0];\n    for (col = 1; col < ncol; col++)\n      res[row][col] = func(res[row][col-1], arr[row][col]);\n  }\n  return res.length === 1 ? res[0] : res;\n};\n\n\n// Destructively alter an array.\njStat.alter = function alter(arr, func) {\n  return jStat.map(arr, func, true);\n};\n\n\n// Generate a rows x cols matrix according to the supplied function.\njStat.create = function  create(rows, cols, func) {\n  var res = new Array(rows);\n  var i, j;\n\n  if (isFunction(cols)) {\n    func = cols;\n    cols = rows;\n  }\n\n  for (i = 0; i < rows; i++) {\n    res[i] = new Array(cols);\n    for (j = 0; j < cols; j++)\n      res[i][j] = func(i, j);\n  }\n\n  return res;\n};\n\n\nfunction retZero() { return 0; }\n\n\n// Generate a rows x cols matrix of zeros.\njStat.zeros = function zeros(rows, cols) {\n  if (!isNumber(cols))\n    cols = rows;\n  return jStat.create(rows, cols, retZero);\n};\n\n\nfunction retOne() { return 1; }\n\n\n// Generate a rows x cols matrix of ones.\njStat.ones = function ones(rows, cols) {\n  if (!isNumber(cols))\n    cols = rows;\n  return jStat.create(rows, cols, retOne);\n};\n\n\n// Generate a rows x cols matrix of uniformly random numbers.\njStat.rand = function rand(rows, cols) {\n  if (!isNumber(cols))\n    cols = rows;\n  return jStat.create(rows, cols, jStat._random_fn);\n};\n\n\nfunction retIdent(i, j) { return i === j ? 1 : 0; }\n\n\n// Generate an identity matrix of size row x cols.\njStat.identity = function identity(rows, cols) {\n  if (!isNumber(cols))\n    cols = rows;\n  return jStat.create(rows, cols, retIdent);\n};\n\n\n// Tests whether a matrix is symmetric\njStat.symmetric = function symmetric(arr) {\n  var size = arr.length;\n  var row, col;\n\n  if (arr.length !== arr[0].length)\n    return false;\n\n  for (row = 0; row < size; row++) {\n    for (col = 0; col < size; col++)\n      if (arr[col][row] !== arr[row][col])\n        return false;\n  }\n\n  return true;\n};\n\n\n// Set all values to zero.\njStat.clear = function clear(arr) {\n  return jStat.alter(arr, retZero);\n};\n\n\n// Generate sequence.\njStat.seq = function seq(min, max, length, func) {\n  if (!isFunction(func))\n    func = false;\n\n  var arr = [];\n  var hival = calcRdx(min, max);\n  var step = (max * hival - min * hival) / ((length - 1) * hival);\n  var current = min;\n  var cnt;\n\n  // Current is assigned using a technique to compensate for IEEE error.\n  // TODO: Needs better implementation.\n  for (cnt = 0;\n       current <= max && cnt < length;\n       cnt++, current = (min * hival + step * hival * cnt) / hival) {\n    arr.push((func ? func(current, cnt) : current));\n  }\n\n  return arr;\n};\n\n\n// arange(5) -> [0,1,2,3,4]\n// arange(1,5) -> [1,2,3,4]\n// arange(5,1,-1) -> [5,4,3,2]\njStat.arange = function arange(start, end, step) {\n  var rl = [];\n  var i;\n  step = step || 1;\n  if (end === undefined) {\n    end = start;\n    start = 0;\n  }\n  if (start === end || step === 0) {\n    return [];\n  }\n  if (start < end && step < 0) {\n    return [];\n  }\n  if (start > end && step > 0) {\n    return [];\n  }\n  if (step > 0) {\n    for (i = start; i < end; i += step) {\n      rl.push(i);\n    }\n  } else {\n    for (i = start; i > end; i += step) {\n      rl.push(i);\n    }\n  }\n  return rl;\n};\n\n\n// A=[[1,2,3],[4,5,6],[7,8,9]]\n// slice(A,{row:{end:2},col:{start:1}}) -> [[2,3],[5,6]]\n// slice(A,1,{start:1}) -> [5,6]\n// as numpy code A[:2,1:]\njStat.slice = (function(){\n  function _slice(list, start, end, step) {\n    // note it's not equal to range.map mode it's a bug\n    var i;\n    var rl = [];\n    var length = list.length;\n    if (start === undefined && end === undefined && step === undefined) {\n      return jStat.copy(list);\n    }\n\n    start = start || 0;\n    end = end || list.length;\n    start = start >= 0 ? start : length + start;\n    end = end >= 0 ? end : length + end;\n    step = step || 1;\n    if (start === end || step === 0) {\n      return [];\n    }\n    if (start < end && step < 0) {\n      return [];\n    }\n    if (start > end && step > 0) {\n      return [];\n    }\n    if (step > 0) {\n      for (i = start; i < end; i += step) {\n        rl.push(list[i]);\n      }\n    } else {\n      for (i = start; i > end;i += step) {\n        rl.push(list[i]);\n      }\n    }\n    return rl;\n  }\n\n  function slice(list, rcSlice) {\n    var colSlice, rowSlice;\n    rcSlice = rcSlice || {};\n    if (isNumber(rcSlice.row)) {\n      if (isNumber(rcSlice.col))\n        return list[rcSlice.row][rcSlice.col];\n      var row = jStat.rowa(list, rcSlice.row);\n      colSlice = rcSlice.col || {};\n      return _slice(row, colSlice.start, colSlice.end, colSlice.step);\n    }\n\n    if (isNumber(rcSlice.col)) {\n      var col = jStat.cola(list, rcSlice.col);\n      rowSlice = rcSlice.row || {};\n      return _slice(col, rowSlice.start, rowSlice.end, rowSlice.step);\n    }\n\n    rowSlice = rcSlice.row || {};\n    colSlice = rcSlice.col || {};\n    var rows = _slice(list, rowSlice.start, rowSlice.end, rowSlice.step);\n    return rows.map(function(row) {\n      return _slice(row, colSlice.start, colSlice.end, colSlice.step);\n    });\n  }\n\n  return slice;\n}());\n\n\n// A=[[1,2,3],[4,5,6],[7,8,9]]\n// sliceAssign(A,{row:{start:1},col:{start:1}},[[0,0],[0,0]])\n// A=[[1,2,3],[4,0,0],[7,0,0]]\njStat.sliceAssign = function sliceAssign(A, rcSlice, B) {\n  var nl, ml;\n  if (isNumber(rcSlice.row)) {\n    if (isNumber(rcSlice.col))\n      return A[rcSlice.row][rcSlice.col] = B;\n    rcSlice.col = rcSlice.col || {};\n    rcSlice.col.start = rcSlice.col.start || 0;\n    rcSlice.col.end = rcSlice.col.end || A[0].length;\n    rcSlice.col.step = rcSlice.col.step || 1;\n    nl = jStat.arange(rcSlice.col.start,\n                          Math.min(A.length, rcSlice.col.end),\n                          rcSlice.col.step);\n    var m = rcSlice.row;\n    nl.forEach(function(n, i) {\n      A[m][n] = B[i];\n    });\n    return A;\n  }\n\n  if (isNumber(rcSlice.col)) {\n    rcSlice.row = rcSlice.row || {};\n    rcSlice.row.start = rcSlice.row.start || 0;\n    rcSlice.row.end = rcSlice.row.end || A.length;\n    rcSlice.row.step = rcSlice.row.step || 1;\n    ml = jStat.arange(rcSlice.row.start,\n                          Math.min(A[0].length, rcSlice.row.end),\n                          rcSlice.row.step);\n    var n = rcSlice.col;\n    ml.forEach(function(m, j) {\n      A[m][n] = B[j];\n    });\n    return A;\n  }\n\n  if (B[0].length === undefined) {\n    B = [B];\n  }\n  rcSlice.row.start = rcSlice.row.start || 0;\n  rcSlice.row.end = rcSlice.row.end || A.length;\n  rcSlice.row.step = rcSlice.row.step || 1;\n  rcSlice.col.start = rcSlice.col.start || 0;\n  rcSlice.col.end = rcSlice.col.end || A[0].length;\n  rcSlice.col.step = rcSlice.col.step || 1;\n  ml = jStat.arange(rcSlice.row.start,\n                        Math.min(A.length, rcSlice.row.end),\n                        rcSlice.row.step);\n  nl = jStat.arange(rcSlice.col.start,\n                        Math.min(A[0].length, rcSlice.col.end),\n                        rcSlice.col.step);\n  ml.forEach(function(m, i) {\n    nl.forEach(function(n, j) {\n      A[m][n] = B[i][j];\n    });\n  });\n  return A;\n};\n\n\n// [1,2,3] ->\n// [[1,0,0],[0,2,0],[0,0,3]]\njStat.diagonal = function diagonal(diagArray) {\n  var mat = jStat.zeros(diagArray.length, diagArray.length);\n  diagArray.forEach(function(t, i) {\n    mat[i][i] = t;\n  });\n  return mat;\n};\n\n\n// return copy of A\njStat.copy = function copy(A) {\n  return A.map(function(row) {\n    if (isNumber(row))\n      return row;\n    return row.map(function(t) {\n      return t;\n    });\n  });\n};\n\n\n// TODO: Go over this entire implementation. Seems a tragic waste of resources\n// doing all this work. Instead, and while ugly, use new Function() to generate\n// a custom function for each static method.\n\n// Quick reference.\nvar jProto = jStat.prototype;\n\n// Default length.\njProto.length = 0;\n\n// For internal use only.\n// TODO: Check if they're actually used, and if they are then rename them\n// to _*\njProto.push = Array.prototype.push;\njProto.sort = Array.prototype.sort;\njProto.splice = Array.prototype.splice;\njProto.slice = Array.prototype.slice;\n\n\n// Return a clean array.\njProto.toArray = function toArray() {\n  return this.length > 1 ? slice.call(this) : slice.call(this)[0];\n};\n\n\n// Map a function to a matrix or vector.\njProto.map = function map(func, toAlter) {\n  return jStat(jStat.map(this, func, toAlter));\n};\n\n\n// Cumulatively combine the elements of a matrix or vector using a function.\njProto.cumreduce = function cumreduce(func, toAlter) {\n  return jStat(jStat.cumreduce(this, func, toAlter));\n};\n\n\n// Destructively alter an array.\njProto.alter = function alter(func) {\n  jStat.alter(this, func);\n  return this;\n};\n\n\n// Extend prototype with methods that have no argument.\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    jProto[passfunc] = function(func) {\n      var self = this,\n      results;\n      // Check for callback.\n      if (func) {\n        setTimeout(function() {\n          func.call(self, jProto[passfunc].call(self));\n        });\n        return this;\n      }\n      results = jStat[passfunc](this);\n      return isArray(results) ? jStat(results) : results;\n    };\n  })(funcs[i]);\n})('transpose clear symmetric rows cols dimensions diag antidiag'.split(' '));\n\n\n// Extend prototype with methods that have one argument.\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    jProto[passfunc] = function(index, func) {\n      var self = this;\n      // check for callback\n      if (func) {\n        setTimeout(function() {\n          func.call(self, jProto[passfunc].call(self, index));\n        });\n        return this;\n      }\n      return jStat(jStat[passfunc](this, index));\n    };\n  })(funcs[i]);\n})('row col'.split(' '));\n\n\n// Extend prototype with simple shortcut methods.\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    jProto[passfunc] = function() {\n      return jStat(jStat[passfunc].apply(null, arguments));\n    };\n  })(funcs[i]);\n})('create zeros ones rand identity'.split(' '));\n\n\n// Exposing jStat.\nreturn jStat;\n\n}(Math));\n(function(jStat, Math) {\n\nvar isFunction = jStat.utils.isFunction;\n\n// Ascending functions for sort\nfunction ascNum(a, b) { return a - b; }\n\nfunction clip(arg, min, max) {\n  return Math.max(min, Math.min(arg, max));\n}\n\n\n// sum of an array\njStat.sum = function sum(arr) {\n  var sum = 0;\n  var i = arr.length;\n  while (--i >= 0)\n    sum += arr[i];\n  return sum;\n};\n\n\n// sum squared\njStat.sumsqrd = function sumsqrd(arr) {\n  var sum = 0;\n  var i = arr.length;\n  while (--i >= 0)\n    sum += arr[i] * arr[i];\n  return sum;\n};\n\n\n// sum of squared errors of prediction (SSE)\njStat.sumsqerr = function sumsqerr(arr) {\n  var mean = jStat.mean(arr);\n  var sum = 0;\n  var i = arr.length;\n  var tmp;\n  while (--i >= 0) {\n    tmp = arr[i] - mean;\n    sum += tmp * tmp;\n  }\n  return sum;\n};\n\n// sum of an array in each row\njStat.sumrow = function sumrow(arr) {\n  var sum = 0;\n  var i = arr.length;\n  while (--i >= 0)\n    sum += arr[i];\n  return sum;\n};\n\n// product of an array\njStat.product = function product(arr) {\n  var prod = 1;\n  var i = arr.length;\n  while (--i >= 0)\n    prod *= arr[i];\n  return prod;\n};\n\n\n// minimum value of an array\njStat.min = function min(arr) {\n  var low = arr[0];\n  var i = 0;\n  while (++i < arr.length)\n    if (arr[i] < low)\n      low = arr[i];\n  return low;\n};\n\n\n// maximum value of an array\njStat.max = function max(arr) {\n  var high = arr[0];\n  var i = 0;\n  while (++i < arr.length)\n    if (arr[i] > high)\n      high = arr[i];\n  return high;\n};\n\n\n// unique values of an array\njStat.unique = function unique(arr) {\n  var hash = {}, _arr = [];\n  for(var i = 0; i < arr.length; i++) {\n    if (!hash[arr[i]]) {\n      hash[arr[i]] = true;\n      _arr.push(arr[i]);\n    }\n  }\n  return _arr;\n};\n\n\n// mean value of an array\njStat.mean = function mean(arr) {\n  return jStat.sum(arr) / arr.length;\n};\n\n\n// mean squared error (MSE)\njStat.meansqerr = function meansqerr(arr) {\n  return jStat.sumsqerr(arr) / arr.length;\n};\n\n\n// geometric mean of an array\njStat.geomean = function geomean(arr) {\n  return Math.pow(jStat.product(arr), 1 / arr.length);\n};\n\n\n// median of an array\njStat.median = function median(arr) {\n  var arrlen = arr.length;\n  var _arr = arr.slice().sort(ascNum);\n  // check if array is even or odd, then return the appropriate\n  return !(arrlen & 1)\n    ? (_arr[(arrlen / 2) - 1 ] + _arr[(arrlen / 2)]) / 2\n    : _arr[(arrlen / 2) | 0 ];\n};\n\n\n// cumulative sum of an array\njStat.cumsum = function cumsum(arr) {\n  return jStat.cumreduce(arr, function (a, b) { return a + b; });\n};\n\n\n// cumulative product of an array\njStat.cumprod = function cumprod(arr) {\n  return jStat.cumreduce(arr, function (a, b) { return a * b; });\n};\n\n\n// successive differences of a sequence\njStat.diff = function diff(arr) {\n  var diffs = [];\n  var arrLen = arr.length;\n  var i;\n  for (i = 1; i < arrLen; i++)\n    diffs.push(arr[i] - arr[i - 1]);\n  return diffs;\n};\n\n\n// ranks of an array\njStat.rank = function (arr) {\n  var i;\n  var distinctNumbers = [];\n  var numberCounts = {};\n  for (i = 0; i < arr.length; i++) {\n    var number = arr[i];\n    if (numberCounts[number]) {\n      numberCounts[number]++;\n    } else {\n      numberCounts[number] = 1;\n      distinctNumbers.push(number);\n    }\n  }\n\n  var sortedDistinctNumbers = distinctNumbers.sort(ascNum);\n  var numberRanks = {};\n  var currentRank = 1;\n  for (i = 0; i < sortedDistinctNumbers.length; i++) {\n    var number = sortedDistinctNumbers[i];\n    var count = numberCounts[number];\n    var first = currentRank;\n    var last = currentRank + count - 1;\n    var rank = (first + last) / 2;\n    numberRanks[number] = rank;\n    currentRank += count;\n  }\n\n  return arr.map(function (number) {\n    return numberRanks[number];\n  });\n};\n\n\n// mode of an array\n// if there are multiple modes of an array, return all of them\n// is this the appropriate way of handling it?\njStat.mode = function mode(arr) {\n  var arrLen = arr.length;\n  var _arr = arr.slice().sort(ascNum);\n  var count = 1;\n  var maxCount = 0;\n  var numMaxCount = 0;\n  var mode_arr = [];\n  var i;\n\n  for (i = 0; i < arrLen; i++) {\n    if (_arr[i] === _arr[i + 1]) {\n      count++;\n    } else {\n      if (count > maxCount) {\n        mode_arr = [_arr[i]];\n        maxCount = count;\n        numMaxCount = 0;\n      }\n      // are there multiple max counts\n      else if (count === maxCount) {\n        mode_arr.push(_arr[i]);\n        numMaxCount++;\n      }\n      // resetting count for new value in array\n      count = 1;\n    }\n  }\n\n  return numMaxCount === 0 ? mode_arr[0] : mode_arr;\n};\n\n\n// range of an array\njStat.range = function range(arr) {\n  return jStat.max(arr) - jStat.min(arr);\n};\n\n// variance of an array\n// flag = true indicates sample instead of population\njStat.variance = function variance(arr, flag) {\n  return jStat.sumsqerr(arr) / (arr.length - (flag ? 1 : 0));\n};\n\n// pooled variance of an array of arrays\njStat.pooledvariance = function pooledvariance(arr) {\n  var sumsqerr = arr.reduce(function (a, samples) {return a + jStat.sumsqerr(samples);}, 0);\n  var count = arr.reduce(function (a, samples) {return a + samples.length;}, 0);\n  return sumsqerr / (count - arr.length);\n};\n\n// deviation of an array\njStat.deviation = function (arr) {\n  var mean = jStat.mean(arr);\n  var arrlen = arr.length;\n  var dev = new Array(arrlen);\n  for (var i = 0; i < arrlen; i++) {\n    dev[i] = arr[i] - mean;\n  }\n  return dev;\n};\n\n// standard deviation of an array\n// flag = true indicates sample instead of population\njStat.stdev = function stdev(arr, flag) {\n  return Math.sqrt(jStat.variance(arr, flag));\n};\n\n// pooled standard deviation of an array of arrays\njStat.pooledstdev = function pooledstdev(arr) {\n  return Math.sqrt(jStat.pooledvariance(arr));\n};\n\n// mean deviation (mean absolute deviation) of an array\njStat.meandev = function meandev(arr) {\n  var mean = jStat.mean(arr);\n  var a = [];\n  for (var i = arr.length - 1; i >= 0; i--) {\n    a.push(Math.abs(arr[i] - mean));\n  }\n  return jStat.mean(a);\n};\n\n\n// median deviation (median absolute deviation) of an array\njStat.meddev = function meddev(arr) {\n  var median = jStat.median(arr);\n  var a = [];\n  for (var i = arr.length - 1; i >= 0; i--) {\n    a.push(Math.abs(arr[i] - median));\n  }\n  return jStat.median(a);\n};\n\n\n// coefficient of variation\njStat.coeffvar = function coeffvar(arr) {\n  return jStat.stdev(arr) / jStat.mean(arr);\n};\n\n\n// quartiles of an array\njStat.quartiles = function quartiles(arr) {\n  var arrlen = arr.length;\n  var _arr = arr.slice().sort(ascNum);\n  return [\n    _arr[ Math.round((arrlen) / 4) - 1 ],\n    _arr[ Math.round((arrlen) / 2) - 1 ],\n    _arr[ Math.round((arrlen) * 3 / 4) - 1 ]\n  ];\n};\n\n\n// Arbitary quantiles of an array. Direct port of the scipy.stats\n// implementation by Pierre GF Gerard-Marchant.\njStat.quantiles = function quantiles(arr, quantilesArray, alphap, betap) {\n  var sortedArray = arr.slice().sort(ascNum);\n  var quantileVals = [quantilesArray.length];\n  var n = arr.length;\n  var i, p, m, aleph, k, gamma;\n\n  if (typeof alphap === 'undefined')\n    alphap = 3 / 8;\n  if (typeof betap === 'undefined')\n    betap = 3 / 8;\n\n  for (i = 0; i < quantilesArray.length; i++) {\n    p = quantilesArray[i];\n    m = alphap + p * (1 - alphap - betap);\n    aleph = n * p + m;\n    k = Math.floor(clip(aleph, 1, n - 1));\n    gamma = clip(aleph - k, 0, 1);\n    quantileVals[i] = (1 - gamma) * sortedArray[k - 1] + gamma * sortedArray[k];\n  }\n\n  return quantileVals;\n};\n\n// Return the k-th percentile of values in a range, where k is in the range 0..1, inclusive.\n// Passing true for the exclusive parameter excludes both endpoints of the range.\njStat.percentile = function percentile(arr, k, exclusive) {\n  var _arr = arr.slice().sort(ascNum);\n  var realIndex = k * (_arr.length + (exclusive ? 1 : -1)) + (exclusive ? 0 : 1);\n  var index = parseInt(realIndex);\n  var frac = realIndex - index;\n  if (index + 1 < _arr.length) {\n    return _arr[index - 1] + frac * (_arr[index] - _arr[index - 1]);\n  } else {\n    return _arr[index - 1];\n  }\n}\n\n// The percentile rank of score in a given array. Returns the percentage\n// of all values in the input array that are less than (kind='strict') or\n// less or equal than (kind='weak') score. Default is weak.\njStat.percentileOfScore = function percentileOfScore(arr, score, kind) {\n  var counter = 0;\n  var len = arr.length;\n  var strict = false;\n  var value, i;\n\n  if (kind === 'strict')\n    strict = true;\n\n  for (i = 0; i < len; i++) {\n    value = arr[i];\n    if ((strict && value < score) ||\n        (!strict && value <= score)) {\n      counter++;\n    }\n  }\n\n  return counter / len;\n};\n\n\n// Histogram (bin count) data\njStat.histogram = function histogram(arr, binCnt) {\n  binCnt = binCnt || 4;\n  var first = jStat.min(arr);\n  var binWidth = (jStat.max(arr) - first) / binCnt;\n  var len = arr.length;\n  var bins = [];\n  var i;\n\n  for (i = 0; i < binCnt; i++)\n    bins[i] = 0;\n  for (i = 0; i < len; i++)\n    bins[Math.min(Math.floor(((arr[i] - first) / binWidth)), binCnt - 1)] += 1;\n\n  return bins;\n};\n\n\n// covariance of two arrays\njStat.covariance = function covariance(arr1, arr2) {\n  var u = jStat.mean(arr1);\n  var v = jStat.mean(arr2);\n  var arr1Len = arr1.length;\n  var sq_dev = new Array(arr1Len);\n  var i;\n\n  for (i = 0; i < arr1Len; i++)\n    sq_dev[i] = (arr1[i] - u) * (arr2[i] - v);\n\n  return jStat.sum(sq_dev) / (arr1Len - 1);\n};\n\n\n// (pearson's) population correlation coefficient, rho\njStat.corrcoeff = function corrcoeff(arr1, arr2) {\n  return jStat.covariance(arr1, arr2) /\n      jStat.stdev(arr1, 1) /\n      jStat.stdev(arr2, 1);\n};\n\n  // (spearman's) rank correlation coefficient, sp\njStat.spearmancoeff =  function (arr1, arr2) {\n  arr1 = jStat.rank(arr1);\n  arr2 = jStat.rank(arr2);\n  //return pearson's correlation of the ranks:\n  return jStat.corrcoeff(arr1, arr2);\n}\n\n\n// statistical standardized moments (general form of skew/kurt)\njStat.stanMoment = function stanMoment(arr, n) {\n  var mu = jStat.mean(arr);\n  var sigma = jStat.stdev(arr);\n  var len = arr.length;\n  var skewSum = 0;\n\n  for (var i = 0; i < len; i++)\n    skewSum += Math.pow((arr[i] - mu) / sigma, n);\n\n  return skewSum / arr.length;\n};\n\n// (pearson's) moment coefficient of skewness\njStat.skewness = function skewness(arr) {\n  return jStat.stanMoment(arr, 3);\n};\n\n// (pearson's) (excess) kurtosis\njStat.kurtosis = function kurtosis(arr) {\n  return jStat.stanMoment(arr, 4) - 3;\n};\n\n\nvar jProto = jStat.prototype;\n\n\n// Extend jProto with method for calculating cumulative sums and products.\n// This differs from the similar extension below as cumsum and cumprod should\n// not be run again in the case fullbool === true.\n// If a matrix is passed, automatically assume operation should be done on the\n// columns.\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    // If a matrix is passed, automatically assume operation should be done on\n    // the columns.\n    jProto[passfunc] = function(fullbool, func) {\n      var arr = [];\n      var i = 0;\n      var tmpthis = this;\n      // Assignment reassignation depending on how parameters were passed in.\n      if (isFunction(fullbool)) {\n        func = fullbool;\n        fullbool = false;\n      }\n      // Check if a callback was passed with the function.\n      if (func) {\n        setTimeout(function() {\n          func.call(tmpthis, jProto[passfunc].call(tmpthis, fullbool));\n        });\n        return this;\n      }\n      // Check if matrix and run calculations.\n      if (this.length > 1) {\n        tmpthis = fullbool === true ? this : this.transpose();\n        for (; i < tmpthis.length; i++)\n          arr[i] = jStat[passfunc](tmpthis[i]);\n        return arr;\n      }\n      // Pass fullbool if only vector, not a matrix. for variance and stdev.\n      return jStat[passfunc](this[0], fullbool);\n    };\n  })(funcs[i]);\n})(('cumsum cumprod').split(' '));\n\n\n// Extend jProto with methods which don't require arguments and work on columns.\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    // If a matrix is passed, automatically assume operation should be done on\n    // the columns.\n    jProto[passfunc] = function(fullbool, func) {\n      var arr = [];\n      var i = 0;\n      var tmpthis = this;\n      // Assignment reassignation depending on how parameters were passed in.\n      if (isFunction(fullbool)) {\n        func = fullbool;\n        fullbool = false;\n      }\n      // Check if a callback was passed with the function.\n      if (func) {\n        setTimeout(function() {\n          func.call(tmpthis, jProto[passfunc].call(tmpthis, fullbool));\n        });\n        return this;\n      }\n      // Check if matrix and run calculations.\n      if (this.length > 1) {\n        if (passfunc !== 'sumrow')\n          tmpthis = fullbool === true ? this : this.transpose();\n        for (; i < tmpthis.length; i++)\n          arr[i] = jStat[passfunc](tmpthis[i]);\n        return fullbool === true\n            ? jStat[passfunc](jStat.utils.toVector(arr))\n            : arr;\n      }\n      // Pass fullbool if only vector, not a matrix. for variance and stdev.\n      return jStat[passfunc](this[0], fullbool);\n    };\n  })(funcs[i]);\n})(('sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr ' +\n    'geomean median diff rank mode range variance deviation stdev meandev ' +\n    'meddev coeffvar quartiles histogram skewness kurtosis').split(' '));\n\n\n// Extend jProto with functions that take arguments. Operations on matrices are\n// done on columns.\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    jProto[passfunc] = function() {\n      var arr = [];\n      var i = 0;\n      var tmpthis = this;\n      var args = Array.prototype.slice.call(arguments);\n      var callbackFunction;\n\n      // If the last argument is a function, we assume it's a callback; we\n      // strip the callback out and call the function again.\n      if (isFunction(args[args.length - 1])) {\n        callbackFunction = args[args.length - 1];\n        var argsToPass = args.slice(0, args.length - 1);\n\n        setTimeout(function() {\n          callbackFunction.call(tmpthis,\n                                jProto[passfunc].apply(tmpthis, argsToPass));\n        });\n        return this;\n\n      // Otherwise we curry the function args and call normally.\n      } else {\n        callbackFunction = undefined;\n        var curriedFunction = function curriedFunction(vector) {\n          return jStat[passfunc].apply(tmpthis, [vector].concat(args));\n        }\n      }\n\n      // If this is a matrix, run column-by-column.\n      if (this.length > 1) {\n        tmpthis = tmpthis.transpose();\n        for (; i < tmpthis.length; i++)\n          arr[i] = curriedFunction(tmpthis[i]);\n        return arr;\n      }\n\n      // Otherwise run on the vector.\n      return curriedFunction(this[0]);\n    };\n  })(funcs[i]);\n})('quantiles percentileOfScore'.split(' '));\n\n}(jStat, Math));\n// Special functions //\n(function(jStat, Math) {\n\n// Log-gamma function\njStat.gammaln = function gammaln(x) {\n  var j = 0;\n  var cof = [\n    76.18009172947146, -86.50532032941677, 24.01409824083091,\n    -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5\n  ];\n  var ser = 1.000000000190015;\n  var xx, y, tmp;\n  tmp = (y = xx = x) + 5.5;\n  tmp -= (xx + 0.5) * Math.log(tmp);\n  for (; j < 6; j++)\n    ser += cof[j] / ++y;\n  return Math.log(2.5066282746310005 * ser / xx) - tmp;\n};\n\n/*\n * log-gamma function to support poisson distribution sampling. The\n * algorithm comes from SPECFUN by Shanjie Zhang and Jianming Jin and their\n * book \"Computation of Special Functions\", 1996, John Wiley & Sons, Inc.\n */\njStat.loggam = function loggam(x) {\n  var x0, x2, xp, gl, gl0;\n  var k, n;\n\n  var a = [8.333333333333333e-02, -2.777777777777778e-03,\n          7.936507936507937e-04, -5.952380952380952e-04,\n          8.417508417508418e-04, -1.917526917526918e-03,\n          6.410256410256410e-03, -2.955065359477124e-02,\n          1.796443723688307e-01, -1.39243221690590e+00];\n  x0 = x;\n  n = 0;\n  if ((x == 1.0) || (x == 2.0)) {\n      return 0.0;\n  }\n  if (x <= 7.0) {\n      n = Math.floor(7 - x);\n      x0 = x + n;\n  }\n  x2 = 1.0 / (x0 * x0);\n  xp = 2 * Math.PI;\n  gl0 = a[9];\n  for (k = 8; k >= 0; k--) {\n      gl0 *= x2;\n      gl0 += a[k];\n  }\n  gl = gl0 / x0 + 0.5 * Math.log(xp) + (x0 - 0.5) * Math.log(x0) - x0;\n  if (x <= 7.0) {\n      for (k = 1; k <= n; k++) {\n          gl -= Math.log(x0 - 1.0);\n          x0 -= 1.0;\n      }\n  }\n  return gl;\n}\n\n// gamma of x\njStat.gammafn = function gammafn(x) {\n  var p = [-1.716185138865495, 24.76565080557592, -379.80425647094563,\n           629.3311553128184, 866.9662027904133, -31451.272968848367,\n           -36144.413418691176, 66456.14382024054\n  ];\n  var q = [-30.8402300119739, 315.35062697960416, -1015.1563674902192,\n           -3107.771671572311, 22538.118420980151, 4755.8462775278811,\n           -134659.9598649693, -115132.2596755535];\n  var fact = false;\n  var n = 0;\n  var xden = 0;\n  var xnum = 0;\n  var y = x;\n  var i, z, yi, res;\n  if (x > 171.6243769536076) {\n    return Infinity;\n  }\n  if (y <= 0) {\n    res = y % 1 + 3.6e-16;\n    if (res) {\n      fact = (!(y & 1) ? 1 : -1) * Math.PI / Math.sin(Math.PI * res);\n      y = 1 - y;\n    } else {\n      return Infinity;\n    }\n  }\n  yi = y;\n  if (y < 1) {\n    z = y++;\n  } else {\n    z = (y -= n = (y | 0) - 1) - 1;\n  }\n  for (i = 0; i < 8; ++i) {\n    xnum = (xnum + p[i]) * z;\n    xden = xden * z + q[i];\n  }\n  res = xnum / xden + 1;\n  if (yi < y) {\n    res /= yi;\n  } else if (yi > y) {\n    for (i = 0; i < n; ++i) {\n      res *= y;\n      y++;\n    }\n  }\n  if (fact) {\n    res = fact / res;\n  }\n  return res;\n};\n\n\n// lower incomplete gamma function, which is usually typeset with a\n// lower-case greek gamma as the function symbol\njStat.gammap = function gammap(a, x) {\n  return jStat.lowRegGamma(a, x) * jStat.gammafn(a);\n};\n\n\n// The lower regularized incomplete gamma function, usually written P(a,x)\njStat.lowRegGamma = function lowRegGamma(a, x) {\n  var aln = jStat.gammaln(a);\n  var ap = a;\n  var sum = 1 / a;\n  var del = sum;\n  var b = x + 1 - a;\n  var c = 1 / 1.0e-30;\n  var d = 1 / b;\n  var h = d;\n  var i = 1;\n  // calculate maximum number of itterations required for a\n  var ITMAX = -~(Math.log((a >= 1) ? a : 1 / a) * 8.5 + a * 0.4 + 17);\n  var an;\n\n  if (x < 0 || a <= 0) {\n    return NaN;\n  } else if (x < a + 1) {\n    for (; i <= ITMAX; i++) {\n      sum += del *= x / ++ap;\n    }\n    return (sum * Math.exp(-x + a * Math.log(x) - (aln)));\n  }\n\n  for (; i <= ITMAX; i++) {\n    an = -i * (i - a);\n    b += 2;\n    d = an * d + b;\n    c = b + an / c;\n    d = 1 / d;\n    h *= d * c;\n  }\n\n  return (1 - h * Math.exp(-x + a * Math.log(x) - (aln)));\n};\n\n// natural log factorial of n\njStat.factorialln = function factorialln(n) {\n  return n < 0 ? NaN : jStat.gammaln(n + 1);\n};\n\n// factorial of n\njStat.factorial = function factorial(n) {\n  return n < 0 ? NaN : jStat.gammafn(n + 1);\n};\n\n// combinations of n, m\njStat.combination = function combination(n, m) {\n  // make sure n or m don't exceed the upper limit of usable values\n  return (n > 170 || m > 170)\n      ? Math.exp(jStat.combinationln(n, m))\n      : (jStat.factorial(n) / jStat.factorial(m)) / jStat.factorial(n - m);\n};\n\n\njStat.combinationln = function combinationln(n, m){\n  return jStat.factorialln(n) - jStat.factorialln(m) - jStat.factorialln(n - m);\n};\n\n\n// permutations of n, m\njStat.permutation = function permutation(n, m) {\n  return jStat.factorial(n) / jStat.factorial(n - m);\n};\n\n\n// beta function\njStat.betafn = function betafn(x, y) {\n  // ensure arguments are positive\n  if (x <= 0 || y <= 0)\n    return undefined;\n  // make sure x + y doesn't exceed the upper limit of usable values\n  return (x + y > 170)\n      ? Math.exp(jStat.betaln(x, y))\n      : jStat.gammafn(x) * jStat.gammafn(y) / jStat.gammafn(x + y);\n};\n\n\n// natural logarithm of beta function\njStat.betaln = function betaln(x, y) {\n  return jStat.gammaln(x) + jStat.gammaln(y) - jStat.gammaln(x + y);\n};\n\n\n// Evaluates the continued fraction for incomplete beta function by modified\n// Lentz's method.\njStat.betacf = function betacf(x, a, b) {\n  var fpmin = 1e-30;\n  var m = 1;\n  var qab = a + b;\n  var qap = a + 1;\n  var qam = a - 1;\n  var c = 1;\n  var d = 1 - qab * x / qap;\n  var m2, aa, del, h;\n\n  // These q's will be used in factors that occur in the coefficients\n  if (Math.abs(d) < fpmin)\n    d = fpmin;\n  d = 1 / d;\n  h = d;\n\n  for (; m <= 100; m++) {\n    m2 = 2 * m;\n    aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n    // One step (the even one) of the recurrence\n    d = 1 + aa * d;\n    if (Math.abs(d) < fpmin)\n      d = fpmin;\n    c = 1 + aa / c;\n    if (Math.abs(c) < fpmin)\n      c = fpmin;\n    d = 1 / d;\n    h *= d * c;\n    aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n    // Next step of the recurrence (the odd one)\n    d = 1 + aa * d;\n    if (Math.abs(d) < fpmin)\n      d = fpmin;\n    c = 1 + aa / c;\n    if (Math.abs(c) < fpmin)\n      c = fpmin;\n    d = 1 / d;\n    del = d * c;\n    h *= del;\n    if (Math.abs(del - 1.0) < 3e-7)\n      break;\n  }\n\n  return h;\n};\n\n\n// Returns the inverse of the lower regularized inomplete gamma function\njStat.gammapinv = function gammapinv(p, a) {\n  var j = 0;\n  var a1 = a - 1;\n  var EPS = 1e-8;\n  var gln = jStat.gammaln(a);\n  var x, err, t, u, pp, lna1, afac;\n\n  if (p >= 1)\n    return Math.max(100, a + 100 * Math.sqrt(a));\n  if (p <= 0)\n    return 0;\n  if (a > 1) {\n    lna1 = Math.log(a1);\n    afac = Math.exp(a1 * (lna1 - 1) - gln);\n    pp = (p < 0.5) ? p : 1 - p;\n    t = Math.sqrt(-2 * Math.log(pp));\n    x = (2.30753 + t * 0.27061) / (1 + t * (0.99229 + t * 0.04481)) - t;\n    if (p < 0.5)\n      x = -x;\n    x = Math.max(1e-3,\n                 a * Math.pow(1 - 1 / (9 * a) - x / (3 * Math.sqrt(a)), 3));\n  } else {\n    t = 1 - a * (0.253 + a * 0.12);\n    if (p < t)\n      x = Math.pow(p / t, 1 / a);\n    else\n      x = 1 - Math.log(1 - (p - t) / (1 - t));\n  }\n\n  for(; j < 12; j++) {\n    if (x <= 0)\n      return 0;\n    err = jStat.lowRegGamma(a, x) - p;\n    if (a > 1)\n      t = afac * Math.exp(-(x - a1) + a1 * (Math.log(x) - lna1));\n    else\n      t = Math.exp(-x + a1 * Math.log(x) - gln);\n    u = err / t;\n    x -= (t = u / (1 - 0.5 * Math.min(1, u * ((a - 1) / x - 1))));\n    if (x <= 0)\n      x = 0.5 * (x + t);\n    if (Math.abs(t) < EPS * x)\n      break;\n  }\n\n  return x;\n};\n\n\n// Returns the error function erf(x)\njStat.erf = function erf(x) {\n  var cof = [-1.3026537197817094, 6.4196979235649026e-1, 1.9476473204185836e-2,\n             -9.561514786808631e-3, -9.46595344482036e-4, 3.66839497852761e-4,\n             4.2523324806907e-5, -2.0278578112534e-5, -1.624290004647e-6,\n             1.303655835580e-6, 1.5626441722e-8, -8.5238095915e-8,\n             6.529054439e-9, 5.059343495e-9, -9.91364156e-10,\n             -2.27365122e-10, 9.6467911e-11, 2.394038e-12,\n             -6.886027e-12, 8.94487e-13, 3.13092e-13,\n             -1.12708e-13, 3.81e-16, 7.106e-15,\n             -1.523e-15, -9.4e-17, 1.21e-16,\n             -2.8e-17];\n  var j = cof.length - 1;\n  var isneg = false;\n  var d = 0;\n  var dd = 0;\n  var t, ty, tmp, res;\n\n  if (x < 0) {\n    x = -x;\n    isneg = true;\n  }\n\n  t = 2 / (2 + x);\n  ty = 4 * t - 2;\n\n  for(; j > 0; j--) {\n    tmp = d;\n    d = ty * d - dd + cof[j];\n    dd = tmp;\n  }\n\n  res = t * Math.exp(-x * x + 0.5 * (cof[0] + ty * d) - dd);\n  return isneg ? res - 1 : 1 - res;\n};\n\n\n// Returns the complmentary error function erfc(x)\njStat.erfc = function erfc(x) {\n  return 1 - jStat.erf(x);\n};\n\n\n// Returns the inverse of the complementary error function\njStat.erfcinv = function erfcinv(p) {\n  var j = 0;\n  var x, err, t, pp;\n  if (p >= 2)\n    return -100;\n  if (p <= 0)\n    return 100;\n  pp = (p < 1) ? p : 2 - p;\n  t = Math.sqrt(-2 * Math.log(pp / 2));\n  x = -0.70711 * ((2.30753 + t * 0.27061) /\n                  (1 + t * (0.99229 + t * 0.04481)) - t);\n  for (; j < 2; j++) {\n    err = jStat.erfc(x) - pp;\n    x += err / (1.12837916709551257 * Math.exp(-x * x) - x * err);\n  }\n  return (p < 1) ? x : -x;\n};\n\n\n// Returns the inverse of the incomplete beta function\njStat.ibetainv = function ibetainv(p, a, b) {\n  var EPS = 1e-8;\n  var a1 = a - 1;\n  var b1 = b - 1;\n  var j = 0;\n  var lna, lnb, pp, t, u, err, x, al, h, w, afac;\n  if (p <= 0)\n    return 0;\n  if (p >= 1)\n    return 1;\n  if (a >= 1 && b >= 1) {\n    pp = (p < 0.5) ? p : 1 - p;\n    t = Math.sqrt(-2 * Math.log(pp));\n    x = (2.30753 + t * 0.27061) / (1 + t* (0.99229 + t * 0.04481)) - t;\n    if (p < 0.5)\n      x = -x;\n    al = (x * x - 3) / 6;\n    h = 2 / (1 / (2 * a - 1)  + 1 / (2 * b - 1));\n    w = (x * Math.sqrt(al + h) / h) - (1 / (2 * b - 1) - 1 / (2 * a - 1)) *\n        (al + 5 / 6 - 2 / (3 * h));\n    x = a / (a + b * Math.exp(2 * w));\n  } else {\n    lna = Math.log(a / (a + b));\n    lnb = Math.log(b / (a + b));\n    t = Math.exp(a * lna) / a;\n    u = Math.exp(b * lnb) / b;\n    w = t + u;\n    if (p < t / w)\n      x = Math.pow(a * w * p, 1 / a);\n    else\n      x = 1 - Math.pow(b * w * (1 - p), 1 / b);\n  }\n  afac = -jStat.gammaln(a) - jStat.gammaln(b) + jStat.gammaln(a + b);\n  for(; j < 10; j++) {\n    if (x === 0 || x === 1)\n      return x;\n    err = jStat.ibeta(x, a, b) - p;\n    t = Math.exp(a1 * Math.log(x) + b1 * Math.log(1 - x) + afac);\n    u = err / t;\n    x -= (t = u / (1 - 0.5 * Math.min(1, u * (a1 / x - b1 / (1 - x)))));\n    if (x <= 0)\n      x = 0.5 * (x + t);\n    if (x >= 1)\n      x = 0.5 * (x + t + 1);\n    if (Math.abs(t) < EPS * x && j > 0)\n      break;\n  }\n  return x;\n};\n\n\n// Returns the incomplete beta function I_x(a,b)\njStat.ibeta = function ibeta(x, a, b) {\n  // Factors in front of the continued fraction.\n  var bt = (x === 0 || x === 1) ?  0 :\n    Math.exp(jStat.gammaln(a + b) - jStat.gammaln(a) -\n             jStat.gammaln(b) + a * Math.log(x) + b *\n             Math.log(1 - x));\n  if (x < 0 || x > 1)\n    return false;\n  if (x < (a + 1) / (a + b + 2))\n    // Use continued fraction directly.\n    return bt * jStat.betacf(x, a, b) / a;\n  // else use continued fraction after making the symmetry transformation.\n  return 1 - bt * jStat.betacf(1 - x, b, a) / b;\n};\n\n\n// Returns a normal deviate (mu=0, sigma=1).\n// If n and m are specified it returns a object of normal deviates.\njStat.randn = function randn(n, m) {\n  var u, v, x, y, q;\n  if (!m)\n    m = n;\n  if (n)\n    return jStat.create(n, m, function() { return jStat.randn(); });\n  do {\n    u = jStat._random_fn();\n    v = 1.7156 * (jStat._random_fn() - 0.5);\n    x = u - 0.449871;\n    y = Math.abs(v) + 0.386595;\n    q = x * x + y * (0.19600 * y - 0.25472 * x);\n  } while (q > 0.27597 && (q > 0.27846 || v * v > -4 * Math.log(u) * u * u));\n  return v / u;\n};\n\n\n// Returns a gamma deviate by the method of Marsaglia and Tsang.\njStat.randg = function randg(shape, n, m) {\n  var oalph = shape;\n  var a1, a2, u, v, x, mat;\n  if (!m)\n    m = n;\n  if (!shape)\n    shape = 1;\n  if (n) {\n    mat = jStat.zeros(n,m);\n    mat.alter(function() { return jStat.randg(shape); });\n    return mat;\n  }\n  if (shape < 1)\n    shape += 1;\n  a1 = shape - 1 / 3;\n  a2 = 1 / Math.sqrt(9 * a1);\n  do {\n    do {\n      x = jStat.randn();\n      v = 1 + a2 * x;\n    } while(v <= 0);\n    v = v * v * v;\n    u = jStat._random_fn();\n  } while(u > 1 - 0.331 * Math.pow(x, 4) &&\n          Math.log(u) > 0.5 * x*x + a1 * (1 - v + Math.log(v)));\n  // alpha > 1\n  if (shape == oalph)\n    return a1 * v;\n  // alpha < 1\n  do {\n    u = jStat._random_fn();\n  } while(u === 0);\n  return Math.pow(u, 1 / oalph) * a1 * v;\n};\n\n\n// making use of static methods on the instance\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    jStat.fn[passfunc] = function() {\n      return jStat(\n          jStat.map(this, function(value) { return jStat[passfunc](value); }));\n    }\n  })(funcs[i]);\n})('gammaln gammafn factorial factorialln'.split(' '));\n\n\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    jStat.fn[passfunc] = function() {\n      return jStat(jStat[passfunc].apply(null, arguments));\n    };\n  })(funcs[i]);\n})('randn'.split(' '));\n\n}(jStat, Math));\n(function(jStat, Math) {\n\n// generate all distribution instance methods\n(function(list) {\n  for (var i = 0; i < list.length; i++) (function(func) {\n    // distribution instance method\n    jStat[func] = function f(a, b, c) {\n      if (!(this instanceof f))\n        return new f(a, b, c);\n      this._a = a;\n      this._b = b;\n      this._c = c;\n      return this;\n    };\n    // distribution method to be used on a jStat instance\n    jStat.fn[func] = function(a, b, c) {\n      var newthis = jStat[func](a, b, c);\n      newthis.data = this;\n      return newthis;\n    };\n    // sample instance method\n    jStat[func].prototype.sample = function(arr) {\n      var a = this._a;\n      var b = this._b;\n      var c = this._c;\n      if (arr)\n        return jStat.alter(arr, function() {\n          return jStat[func].sample(a, b, c);\n        });\n      else\n        return jStat[func].sample(a, b, c);\n    };\n    // generate the pdf, cdf and inv instance methods\n    (function(vals) {\n      for (var i = 0; i < vals.length; i++) (function(fnfunc) {\n        jStat[func].prototype[fnfunc] = function(x) {\n          var a = this._a;\n          var b = this._b;\n          var c = this._c;\n          if (!x && x !== 0)\n            x = this.data;\n          if (typeof x !== 'number') {\n            return jStat.fn.map.call(x, function(x) {\n              return jStat[func][fnfunc](x, a, b, c);\n            });\n          }\n          return jStat[func][fnfunc](x, a, b, c);\n        };\n      })(vals[i]);\n    })('pdf cdf inv'.split(' '));\n    // generate the mean, median, mode and variance instance methods\n    (function(vals) {\n      for (var i = 0; i < vals.length; i++) (function(fnfunc) {\n        jStat[func].prototype[fnfunc] = function() {\n          return jStat[func][fnfunc](this._a, this._b, this._c);\n        };\n      })(vals[i]);\n    })('mean median mode variance'.split(' '));\n  })(list[i]);\n})((\n  'beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy ' +\n  'laplace lognormal noncentralt normal pareto studentt weibull uniform ' +\n  'binomial negbin hypgeom poisson triangular tukey arcsine'\n).split(' '));\n\n\n\n// extend beta function with static methods\njStat.extend(jStat.beta, {\n  pdf: function pdf(x, alpha, beta) {\n    // PDF is zero outside the support\n    if (x > 1 || x < 0)\n      return 0;\n    // PDF is one for the uniform case\n    if (alpha == 1 && beta == 1)\n      return 1;\n\n    if (alpha < 512 && beta < 512) {\n      return (Math.pow(x, alpha - 1) * Math.pow(1 - x, beta - 1)) /\n          jStat.betafn(alpha, beta);\n    } else {\n      return Math.exp((alpha - 1) * Math.log(x) +\n                      (beta - 1) * Math.log(1 - x) -\n                      jStat.betaln(alpha, beta));\n    }\n  },\n\n  cdf: function cdf(x, alpha, beta) {\n    return (x > 1 || x < 0) ? (x > 1) * 1 : jStat.ibeta(x, alpha, beta);\n  },\n\n  inv: function inv(x, alpha, beta) {\n    return jStat.ibetainv(x, alpha, beta);\n  },\n\n  mean: function mean(alpha, beta) {\n    return alpha / (alpha + beta);\n  },\n\n  median: function median(alpha, beta) {\n    return jStat.ibetainv(0.5, alpha, beta);\n  },\n\n  mode: function mode(alpha, beta) {\n    return (alpha - 1 ) / ( alpha + beta - 2);\n  },\n\n  // return a random sample\n  sample: function sample(alpha, beta) {\n    var u = jStat.randg(alpha);\n    return u / (u + jStat.randg(beta));\n  },\n\n  variance: function variance(alpha, beta) {\n    return (alpha * beta) / (Math.pow(alpha + beta, 2) * (alpha + beta + 1));\n  }\n});\n\n// extend F function with static methods\njStat.extend(jStat.centralF, {\n  // This implementation of the pdf function avoids float overflow\n  // See the way that R calculates this value:\n  // https://svn.r-project.org/R/trunk/src/nmath/df.c\n  pdf: function pdf(x, df1, df2) {\n    var p, q, f;\n\n    if (x < 0)\n      return 0;\n\n    if (df1 <= 2) {\n      if (x === 0 && df1 < 2) {\n        return Infinity;\n      }\n      if (x === 0 && df1 === 2) {\n        return 1;\n      }\n      return (1 / jStat.betafn(df1 / 2, df2 / 2)) *\n              Math.pow(df1 / df2, df1 / 2) *\n              Math.pow(x, (df1/2) - 1) *\n              Math.pow((1 + (df1 / df2) * x), -(df1 + df2) / 2);\n    }\n\n    p = (df1 * x) / (df2 + x * df1);\n    q = df2 / (df2 + x * df1);\n    f = df1 * q / 2.0;\n    return f * jStat.binomial.pdf((df1 - 2) / 2, (df1 + df2 - 2) / 2, p);\n  },\n\n  cdf: function cdf(x, df1, df2) {\n    if (x < 0)\n      return 0;\n    return jStat.ibeta((df1 * x) / (df1 * x + df2), df1 / 2, df2 / 2);\n  },\n\n  inv: function inv(x, df1, df2) {\n    return df2 / (df1 * (1 / jStat.ibetainv(x, df1 / 2, df2 / 2) - 1));\n  },\n\n  mean: function mean(df1, df2) {\n    return (df2 > 2) ? df2 / (df2 - 2) : undefined;\n  },\n\n  mode: function mode(df1, df2) {\n    return (df1 > 2) ? (df2 * (df1 - 2)) / (df1 * (df2 + 2)) : undefined;\n  },\n\n  // return a random sample\n  sample: function sample(df1, df2) {\n    var x1 = jStat.randg(df1 / 2) * 2;\n    var x2 = jStat.randg(df2 / 2) * 2;\n    return (x1 / df1) / (x2 / df2);\n  },\n\n  variance: function variance(df1, df2) {\n    if (df2 <= 4)\n      return undefined;\n    return 2 * df2 * df2 * (df1 + df2 - 2) /\n        (df1 * (df2 - 2) * (df2 - 2) * (df2 - 4));\n  }\n});\n\n\n// extend cauchy function with static methods\njStat.extend(jStat.cauchy, {\n  pdf: function pdf(x, local, scale) {\n    if (scale < 0) { return 0; }\n\n    return (scale / (Math.pow(x - local, 2) + Math.pow(scale, 2))) / Math.PI;\n  },\n\n  cdf: function cdf(x, local, scale) {\n    return Math.atan((x - local) / scale) / Math.PI + 0.5;\n  },\n\n  inv: function(p, local, scale) {\n    return local + scale * Math.tan(Math.PI * (p - 0.5));\n  },\n\n  median: function median(local/*, scale*/) {\n    return local;\n  },\n\n  mode: function mode(local/*, scale*/) {\n    return local;\n  },\n\n  sample: function sample(local, scale) {\n    return jStat.randn() *\n        Math.sqrt(1 / (2 * jStat.randg(0.5))) * scale + local;\n  }\n});\n\n\n\n// extend chisquare function with static methods\njStat.extend(jStat.chisquare, {\n  pdf: function pdf(x, dof) {\n    if (x < 0)\n      return 0;\n    return (x === 0 && dof === 2) ? 0.5 :\n        Math.exp((dof / 2 - 1) * Math.log(x) - x / 2 - (dof / 2) *\n                 Math.log(2) - jStat.gammaln(dof / 2));\n  },\n\n  cdf: function cdf(x, dof) {\n    if (x < 0)\n      return 0;\n    return jStat.lowRegGamma(dof / 2, x / 2);\n  },\n\n  inv: function(p, dof) {\n    return 2 * jStat.gammapinv(p, 0.5 * dof);\n  },\n\n  mean : function(dof) {\n    return dof;\n  },\n\n  // TODO: this is an approximation (is there a better way?)\n  median: function median(dof) {\n    return dof * Math.pow(1 - (2 / (9 * dof)), 3);\n  },\n\n  mode: function mode(dof) {\n    return (dof - 2 > 0) ? dof - 2 : 0;\n  },\n\n  sample: function sample(dof) {\n    return jStat.randg(dof / 2) * 2;\n  },\n\n  variance: function variance(dof) {\n    return 2 * dof;\n  }\n});\n\n\n\n// extend exponential function with static methods\njStat.extend(jStat.exponential, {\n  pdf: function pdf(x, rate) {\n    return x < 0 ? 0 : rate * Math.exp(-rate * x);\n  },\n\n  cdf: function cdf(x, rate) {\n    return x < 0 ? 0 : 1 - Math.exp(-rate * x);\n  },\n\n  inv: function(p, rate) {\n    return -Math.log(1 - p) / rate;\n  },\n\n  mean : function(rate) {\n    return 1 / rate;\n  },\n\n  median: function (rate) {\n    return (1 / rate) * Math.log(2);\n  },\n\n  mode: function mode(/*rate*/) {\n    return 0;\n  },\n\n  sample: function sample(rate) {\n    return -1 / rate * Math.log(jStat._random_fn());\n  },\n\n  variance : function(rate) {\n    return Math.pow(rate, -2);\n  }\n});\n\n\n\n// extend gamma function with static methods\njStat.extend(jStat.gamma, {\n  pdf: function pdf(x, shape, scale) {\n    if (x < 0)\n      return 0;\n    return (x === 0 && shape === 1) ? 1 / scale :\n            Math.exp((shape - 1) * Math.log(x) - x / scale -\n                    jStat.gammaln(shape) - shape * Math.log(scale));\n  },\n\n  cdf: function cdf(x, shape, scale) {\n    if (x < 0)\n      return 0;\n    return jStat.lowRegGamma(shape, x / scale);\n  },\n\n  inv: function(p, shape, scale) {\n    return jStat.gammapinv(p, shape) * scale;\n  },\n\n  mean : function(shape, scale) {\n    return shape * scale;\n  },\n\n  mode: function mode(shape, scale) {\n    if(shape > 1) return (shape - 1) * scale;\n    return undefined;\n  },\n\n  sample: function sample(shape, scale) {\n    return jStat.randg(shape) * scale;\n  },\n\n  variance: function variance(shape, scale) {\n    return shape * scale * scale;\n  }\n});\n\n// extend inverse gamma function with static methods\njStat.extend(jStat.invgamma, {\n  pdf: function pdf(x, shape, scale) {\n    if (x <= 0)\n      return 0;\n    return Math.exp(-(shape + 1) * Math.log(x) - scale / x -\n                    jStat.gammaln(shape) + shape * Math.log(scale));\n  },\n\n  cdf: function cdf(x, shape, scale) {\n    if (x <= 0)\n      return 0;\n    return 1 - jStat.lowRegGamma(shape, scale / x);\n  },\n\n  inv: function(p, shape, scale) {\n    return scale / jStat.gammapinv(1 - p, shape);\n  },\n\n  mean : function(shape, scale) {\n    return (shape > 1) ? scale / (shape - 1) : undefined;\n  },\n\n  mode: function mode(shape, scale) {\n    return scale / (shape + 1);\n  },\n\n  sample: function sample(shape, scale) {\n    return scale / jStat.randg(shape);\n  },\n\n  variance: function variance(shape, scale) {\n    if (shape <= 2)\n      return undefined;\n    return scale * scale / ((shape - 1) * (shape - 1) * (shape - 2));\n  }\n});\n\n\n// extend kumaraswamy function with static methods\njStat.extend(jStat.kumaraswamy, {\n  pdf: function pdf(x, alpha, beta) {\n    if (x === 0 && alpha === 1)\n      return beta;\n    else if (x === 1 && beta === 1)\n      return alpha;\n    return Math.exp(Math.log(alpha) + Math.log(beta) + (alpha - 1) *\n                    Math.log(x) + (beta - 1) *\n                    Math.log(1 - Math.pow(x, alpha)));\n  },\n\n  cdf: function cdf(x, alpha, beta) {\n    if (x < 0)\n      return 0;\n    else if (x > 1)\n      return 1;\n    return (1 - Math.pow(1 - Math.pow(x, alpha), beta));\n  },\n\n  inv: function inv(p, alpha, beta) {\n    return Math.pow(1 - Math.pow(1 - p, 1 / beta), 1 / alpha);\n  },\n\n  mean : function(alpha, beta) {\n    return (beta * jStat.gammafn(1 + 1 / alpha) *\n            jStat.gammafn(beta)) / (jStat.gammafn(1 + 1 / alpha + beta));\n  },\n\n  median: function median(alpha, beta) {\n    return Math.pow(1 - Math.pow(2, -1 / beta), 1 / alpha);\n  },\n\n  mode: function mode(alpha, beta) {\n    if (!(alpha >= 1 && beta >= 1 && (alpha !== 1 && beta !== 1)))\n      return undefined;\n    return Math.pow((alpha - 1) / (alpha * beta - 1), 1 / alpha);\n  },\n\n  variance: function variance(/*alpha, beta*/) {\n    throw new Error('variance not yet implemented');\n    // TODO: complete this\n  }\n});\n\n\n\n// extend lognormal function with static methods\njStat.extend(jStat.lognormal, {\n  pdf: function pdf(x, mu, sigma) {\n    if (x <= 0)\n      return 0;\n    return Math.exp(-Math.log(x) - 0.5 * Math.log(2 * Math.PI) -\n                    Math.log(sigma) - Math.pow(Math.log(x) - mu, 2) /\n                    (2 * sigma * sigma));\n  },\n\n  cdf: function cdf(x, mu, sigma) {\n    if (x < 0)\n      return 0;\n    return 0.5 +\n        (0.5 * jStat.erf((Math.log(x) - mu) / Math.sqrt(2 * sigma * sigma)));\n  },\n\n  inv: function(p, mu, sigma) {\n    return Math.exp(-1.41421356237309505 * sigma * jStat.erfcinv(2 * p) + mu);\n  },\n\n  mean: function mean(mu, sigma) {\n    return Math.exp(mu + sigma * sigma / 2);\n  },\n\n  median: function median(mu/*, sigma*/) {\n    return Math.exp(mu);\n  },\n\n  mode: function mode(mu, sigma) {\n    return Math.exp(mu - sigma * sigma);\n  },\n\n  sample: function sample(mu, sigma) {\n    return Math.exp(jStat.randn() * sigma + mu);\n  },\n\n  variance: function variance(mu, sigma) {\n    return (Math.exp(sigma * sigma) - 1) * Math.exp(2 * mu + sigma * sigma);\n  }\n});\n\n\n\n// extend noncentralt function with static methods\njStat.extend(jStat.noncentralt, {\n  pdf: function pdf(x, dof, ncp) {\n    var tol = 1e-14;\n    if (Math.abs(ncp) < tol)  // ncp approx 0; use student-t\n      return jStat.studentt.pdf(x, dof)\n\n    if (Math.abs(x) < tol) {  // different formula for x == 0\n      return Math.exp(jStat.gammaln((dof + 1) / 2) - ncp * ncp / 2 -\n                      0.5 * Math.log(Math.PI * dof) - jStat.gammaln(dof / 2));\n    }\n\n    // formula for x != 0\n    return dof / x *\n        (jStat.noncentralt.cdf(x * Math.sqrt(1 + 2 / dof), dof+2, ncp) -\n         jStat.noncentralt.cdf(x, dof, ncp));\n  },\n\n  cdf: function cdf(x, dof, ncp) {\n    var tol = 1e-14;\n    var min_iterations = 200;\n\n    if (Math.abs(ncp) < tol)  // ncp approx 0; use student-t\n      return jStat.studentt.cdf(x, dof);\n\n    // turn negative x into positive and flip result afterwards\n    var flip = false;\n    if (x < 0) {\n      flip = true;\n      ncp = -ncp;\n    }\n\n    var prob = jStat.normal.cdf(-ncp, 0, 1);\n    var value = tol + 1;\n    // use value at last two steps to determine convergence\n    var lastvalue = value;\n    var y = x * x / (x * x + dof);\n    var j = 0;\n    var p = Math.exp(-ncp * ncp / 2);\n    var q = Math.exp(-ncp * ncp / 2 - 0.5 * Math.log(2) -\n                     jStat.gammaln(3 / 2)) * ncp;\n    while (j < min_iterations || lastvalue > tol || value > tol) {\n      lastvalue = value;\n      if (j > 0) {\n        p *= (ncp * ncp) / (2 * j);\n        q *= (ncp * ncp) / (2 * (j + 1 / 2));\n      }\n      value = p * jStat.beta.cdf(y, j + 0.5, dof / 2) +\n          q * jStat.beta.cdf(y, j+1, dof/2);\n      prob += 0.5 * value;\n      j++;\n    }\n\n    return flip ? (1 - prob) : prob;\n  }\n});\n\n\n// extend normal function with static methods\njStat.extend(jStat.normal, {\n  pdf: function pdf(x, mean, std) {\n    return Math.exp(-0.5 * Math.log(2 * Math.PI) -\n                    Math.log(std) - Math.pow(x - mean, 2) / (2 * std * std));\n  },\n\n  cdf: function cdf(x, mean, std) {\n    return 0.5 * (1 + jStat.erf((x - mean) / Math.sqrt(2 * std * std)));\n  },\n\n  inv: function(p, mean, std) {\n    return -1.41421356237309505 * std * jStat.erfcinv(2 * p) + mean;\n  },\n\n  mean : function(mean/*, std*/) {\n    return mean;\n  },\n\n  median: function median(mean/*, std*/) {\n    return mean;\n  },\n\n  mode: function (mean/*, std*/) {\n    return mean;\n  },\n\n  sample: function sample(mean, std) {\n    return jStat.randn() * std + mean;\n  },\n\n  variance : function(mean, std) {\n    return std * std;\n  }\n});\n\n\n\n// extend pareto function with static methods\njStat.extend(jStat.pareto, {\n  pdf: function pdf(x, scale, shape) {\n    if (x < scale)\n      return 0;\n    return (shape * Math.pow(scale, shape)) / Math.pow(x, shape + 1);\n  },\n\n  cdf: function cdf(x, scale, shape) {\n    if (x < scale)\n      return 0;\n    return 1 - Math.pow(scale / x, shape);\n  },\n\n  inv: function inv(p, scale, shape) {\n    return scale / Math.pow(1 - p, 1 / shape);\n  },\n\n  mean: function mean(scale, shape) {\n    if (shape <= 1)\n      return undefined;\n    return (shape * Math.pow(scale, shape)) / (shape - 1);\n  },\n\n  median: function median(scale, shape) {\n    return scale * (shape * Math.SQRT2);\n  },\n\n  mode: function mode(scale/*, shape*/) {\n    return scale;\n  },\n\n  variance : function(scale, shape) {\n    if (shape <= 2)\n      return undefined;\n    return (scale*scale * shape) / (Math.pow(shape - 1, 2) * (shape - 2));\n  }\n});\n\n\n\n// extend studentt function with static methods\njStat.extend(jStat.studentt, {\n  pdf: function pdf(x, dof) {\n    dof = dof > 1e100 ? 1e100 : dof;\n    return (1/(Math.sqrt(dof) * jStat.betafn(0.5, dof/2))) *\n        Math.pow(1 + ((x * x) / dof), -((dof + 1) / 2));\n  },\n\n  cdf: function cdf(x, dof) {\n    var dof2 = dof / 2;\n    return jStat.ibeta((x + Math.sqrt(x * x + dof)) /\n                       (2 * Math.sqrt(x * x + dof)), dof2, dof2);\n  },\n\n  inv: function(p, dof) {\n    var x = jStat.ibetainv(2 * Math.min(p, 1 - p), 0.5 * dof, 0.5);\n    x = Math.sqrt(dof * (1 - x) / x);\n    return (p > 0.5) ? x : -x;\n  },\n\n  mean: function mean(dof) {\n    return (dof > 1) ? 0 : undefined;\n  },\n\n  median: function median(/*dof*/) {\n    return 0;\n  },\n\n  mode: function mode(/*dof*/) {\n    return 0;\n  },\n\n  sample: function sample(dof) {\n    return jStat.randn() * Math.sqrt(dof / (2 * jStat.randg(dof / 2)));\n  },\n\n  variance: function variance(dof) {\n    return (dof  > 2) ? dof / (dof - 2) : (dof > 1) ? Infinity : undefined;\n  }\n});\n\n\n\n// extend weibull function with static methods\njStat.extend(jStat.weibull, {\n  pdf: function pdf(x, scale, shape) {\n    if (x < 0 || scale < 0 || shape < 0)\n      return 0;\n    return (shape / scale) * Math.pow((x / scale), (shape - 1)) *\n        Math.exp(-(Math.pow((x / scale), shape)));\n  },\n\n  cdf: function cdf(x, scale, shape) {\n    return x < 0 ? 0 : 1 - Math.exp(-Math.pow((x / scale), shape));\n  },\n\n  inv: function(p, scale, shape) {\n    return scale * Math.pow(-Math.log(1 - p), 1 / shape);\n  },\n\n  mean : function(scale, shape) {\n    return scale * jStat.gammafn(1 + 1 / shape);\n  },\n\n  median: function median(scale, shape) {\n    return scale * Math.pow(Math.log(2), 1 / shape);\n  },\n\n  mode: function mode(scale, shape) {\n    if (shape <= 1)\n      return 0;\n    return scale * Math.pow((shape - 1) / shape, 1 / shape);\n  },\n\n  sample: function sample(scale, shape) {\n    return scale * Math.pow(-Math.log(jStat._random_fn()), 1 / shape);\n  },\n\n  variance: function variance(scale, shape) {\n    return scale * scale * jStat.gammafn(1 + 2 / shape) -\n        Math.pow(jStat.weibull.mean(scale, shape), 2);\n  }\n});\n\n\n\n// extend uniform function with static methods\njStat.extend(jStat.uniform, {\n  pdf: function pdf(x, a, b) {\n    return (x < a || x > b) ? 0 : 1 / (b - a);\n  },\n\n  cdf: function cdf(x, a, b) {\n    if (x < a)\n      return 0;\n    else if (x < b)\n      return (x - a) / (b - a);\n    return 1;\n  },\n\n  inv: function(p, a, b) {\n    return a + (p * (b - a));\n  },\n\n  mean: function mean(a, b) {\n    return 0.5 * (a + b);\n  },\n\n  median: function median(a, b) {\n    return jStat.mean(a, b);\n  },\n\n  mode: function mode(/*a, b*/) {\n    throw new Error('mode is not yet implemented');\n  },\n\n  sample: function sample(a, b) {\n    return (a / 2 + b / 2) + (b / 2 - a / 2) * (2 * jStat._random_fn() - 1);\n  },\n\n  variance: function variance(a, b) {\n    return Math.pow(b - a, 2) / 12;\n  }\n});\n\n\n// Got this from http://www.math.ucla.edu/~tom/distributions/binomial.html\nfunction betinc(x, a, b, eps) {\n  var a0 = 0;\n  var b0 = 1;\n  var a1 = 1;\n  var b1 = 1;\n  var m9 = 0;\n  var a2 = 0;\n  var c9;\n\n  while (Math.abs((a1 - a2) / a1) > eps) {\n    a2 = a1;\n    c9 = -(a + m9) * (a + b + m9) * x / (a + 2 * m9) / (a + 2 * m9 + 1);\n    a0 = a1 + c9 * a0;\n    b0 = b1 + c9 * b0;\n    m9 = m9 + 1;\n    c9 = m9 * (b - m9) * x / (a + 2 * m9 - 1) / (a + 2 * m9);\n    a1 = a0 + c9 * a1;\n    b1 = b0 + c9 * b1;\n    a0 = a0 / b1;\n    b0 = b0 / b1;\n    a1 = a1 / b1;\n    b1 = 1;\n  }\n\n  return a1 / a;\n}\n\n\n// extend uniform function with static methods\njStat.extend(jStat.binomial, {\n  pdf: function pdf(k, n, p) {\n    return (p === 0 || p === 1) ?\n      ((n * p) === k ? 1 : 0) :\n      jStat.combination(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n  },\n\n  cdf: function cdf(x, n, p) {\n    var betacdf;\n    var eps = 1e-10;\n\n    if (x < 0)\n      return 0;\n    if (x >= n)\n      return 1;\n    if (p < 0 || p > 1 || n <= 0)\n      return NaN;\n\n    x = Math.floor(x);\n    var z = p;\n    var a = x + 1;\n    var b = n - x;\n    var s = a + b;\n    var bt = Math.exp(jStat.gammaln(s) - jStat.gammaln(b) -\n                      jStat.gammaln(a) + a * Math.log(z) + b * Math.log(1 - z));\n\n    if (z < (a + 1) / (s + 2))\n      betacdf = bt * betinc(z, a, b, eps);\n    else\n      betacdf = 1 - bt * betinc(1 - z, b, a, eps);\n\n    return Math.round((1 - betacdf) * (1 / eps)) / (1 / eps);\n  }\n});\n\n\n\n// extend uniform function with static methods\njStat.extend(jStat.negbin, {\n  pdf: function pdf(k, r, p) {\n    if (k !== k >>> 0)\n      return false;\n    if (k < 0)\n      return 0;\n    return jStat.combination(k + r - 1, r - 1) *\n        Math.pow(1 - p, k) * Math.pow(p, r);\n  },\n\n  cdf: function cdf(x, r, p) {\n    var sum = 0,\n    k = 0;\n    if (x < 0) return 0;\n    for (; k <= x; k++) {\n      sum += jStat.negbin.pdf(k, r, p);\n    }\n    return sum;\n  }\n});\n\n\n\n// extend uniform function with static methods\njStat.extend(jStat.hypgeom, {\n  pdf: function pdf(k, N, m, n) {\n    // Hypergeometric PDF.\n\n    // A simplification of the CDF algorithm below.\n\n    // k = number of successes drawn\n    // N = population size\n    // m = number of successes in population\n    // n = number of items drawn from population\n\n    if(k !== k | 0) {\n      return false;\n    } else if(k < 0 || k < m - (N - n)) {\n      // It's impossible to have this few successes drawn.\n      return 0;\n    } else if(k > n || k > m) {\n      // It's impossible to have this many successes drawn.\n      return 0;\n    } else if (m * 2 > N) {\n      // More than half the population is successes.\n\n      if(n * 2 > N) {\n        // More than half the population is sampled.\n\n        return jStat.hypgeom.pdf(N - m - n + k, N, N - m, N - n)\n      } else {\n        // Half or less of the population is sampled.\n\n        return jStat.hypgeom.pdf(n - k, N, N - m, n);\n      }\n\n    } else if(n * 2 > N) {\n      // Half or less is successes.\n\n      return jStat.hypgeom.pdf(m - k, N, m, N - n);\n\n    } else if(m < n) {\n      // We want to have the number of things sampled to be less than the\n      // successes available. So swap the definitions of successful and sampled.\n      return jStat.hypgeom.pdf(k, N, n, m);\n    } else {\n      // If we get here, half or less of the population was sampled, half or\n      // less of it was successes, and we had fewer sampled things than\n      // successes. Now we can do this complicated iterative algorithm in an\n      // efficient way.\n\n      // The basic premise of the algorithm is that we partially normalize our\n      // intermediate product to keep it in a numerically good region, and then\n      // finish the normalization at the end.\n\n      // This variable holds the scaled probability of the current number of\n      // successes.\n      var scaledPDF = 1;\n\n      // This keeps track of how much we have normalized.\n      var samplesDone = 0;\n\n      for(var i = 0; i < k; i++) {\n        // For every possible number of successes up to that observed...\n\n        while(scaledPDF > 1 && samplesDone < n) {\n          // Intermediate result is growing too big. Apply some of the\n          // normalization to shrink everything.\n\n          scaledPDF *= 1 - (m / (N - samplesDone));\n\n          // Say we've normalized by this sample already.\n          samplesDone++;\n        }\n\n        // Work out the partially-normalized hypergeometric PDF for the next\n        // number of successes\n        scaledPDF *= (n - i) * (m - i) / ((i + 1) * (N - m - n + i + 1));\n      }\n\n      for(; samplesDone < n; samplesDone++) {\n        // Apply all the rest of the normalization\n        scaledPDF *= 1 - (m / (N - samplesDone));\n      }\n\n      // Bound answer sanely before returning.\n      return Math.min(1, Math.max(0, scaledPDF));\n    }\n  },\n\n  cdf: function cdf(x, N, m, n) {\n    // Hypergeometric CDF.\n\n    // This algorithm is due to Prof. Thomas S. Ferguson, <tom@math.ucla.edu>,\n    // and comes from his hypergeometric test calculator at\n    // <http://www.math.ucla.edu/~tom/distributions/Hypergeometric.html>.\n\n    // x = number of successes drawn\n    // N = population size\n    // m = number of successes in population\n    // n = number of items drawn from population\n\n    if(x < 0 || x < m - (N - n)) {\n      // It's impossible to have this few successes drawn or fewer.\n      return 0;\n    } else if(x >= n || x >= m) {\n      // We will always have this many successes or fewer.\n      return 1;\n    } else if (m * 2 > N) {\n      // More than half the population is successes.\n\n      if(n * 2 > N) {\n        // More than half the population is sampled.\n\n        return jStat.hypgeom.cdf(N - m - n + x, N, N - m, N - n)\n      } else {\n        // Half or less of the population is sampled.\n\n        return 1 - jStat.hypgeom.cdf(n - x - 1, N, N - m, n);\n      }\n\n    } else if(n * 2 > N) {\n      // Half or less is successes.\n\n      return 1 - jStat.hypgeom.cdf(m - x - 1, N, m, N - n);\n\n    } else if(m < n) {\n      // We want to have the number of things sampled to be less than the\n      // successes available. So swap the definitions of successful and sampled.\n      return jStat.hypgeom.cdf(x, N, n, m);\n    } else {\n      // If we get here, half or less of the population was sampled, half or\n      // less of it was successes, and we had fewer sampled things than\n      // successes. Now we can do this complicated iterative algorithm in an\n      // efficient way.\n\n      // The basic premise of the algorithm is that we partially normalize our\n      // intermediate sum to keep it in a numerically good region, and then\n      // finish the normalization at the end.\n\n      // Holds the intermediate, scaled total CDF.\n      var scaledCDF = 1;\n\n      // This variable holds the scaled probability of the current number of\n      // successes.\n      var scaledPDF = 1;\n\n      // This keeps track of how much we have normalized.\n      var samplesDone = 0;\n\n      for(var i = 0; i < x; i++) {\n        // For every possible number of successes up to that observed...\n\n        while(scaledCDF > 1 && samplesDone < n) {\n          // Intermediate result is growing too big. Apply some of the\n          // normalization to shrink everything.\n\n          var factor = 1 - (m / (N - samplesDone));\n\n          scaledPDF *= factor;\n          scaledCDF *= factor;\n\n          // Say we've normalized by this sample already.\n          samplesDone++;\n        }\n\n        // Work out the partially-normalized hypergeometric PDF for the next\n        // number of successes\n        scaledPDF *= (n - i) * (m - i) / ((i + 1) * (N - m - n + i + 1));\n\n        // Add to the CDF answer.\n        scaledCDF += scaledPDF;\n      }\n\n      for(; samplesDone < n; samplesDone++) {\n        // Apply all the rest of the normalization\n        scaledCDF *= 1 - (m / (N - samplesDone));\n      }\n\n      // Bound answer sanely before returning.\n      return Math.min(1, Math.max(0, scaledCDF));\n    }\n  }\n});\n\n\n\n// extend uniform function with static methods\njStat.extend(jStat.poisson, {\n  pdf: function pdf(k, l) {\n    if (l < 0 || (k % 1) !== 0 || k < 0) {\n      return 0;\n    }\n\n    return Math.pow(l, k) * Math.exp(-l) / jStat.factorial(k);\n  },\n\n  cdf: function cdf(x, l) {\n    var sumarr = [],\n    k = 0;\n    if (x < 0) return 0;\n    for (; k <= x; k++) {\n      sumarr.push(jStat.poisson.pdf(k, l));\n    }\n    return jStat.sum(sumarr);\n  },\n\n  mean : function(l) {\n    return l;\n  },\n\n  variance : function(l) {\n    return l;\n  },\n\n  sampleSmall: function sampleSmall(l) {\n    var p = 1, k = 0, L = Math.exp(-l);\n    do {\n      k++;\n      p *= jStat._random_fn();\n    } while (p > L);\n    return k - 1;\n  },\n\n  sampleLarge: function sampleLarge(l) {\n    var lam = l;\n    var k;\n    var U, V, slam, loglam, a, b, invalpha, vr, us;\n\n    slam = Math.sqrt(lam);\n    loglam = Math.log(lam);\n    b = 0.931 + 2.53 * slam;\n    a = -0.059 + 0.02483 * b;\n    invalpha = 1.1239 + 1.1328 / (b - 3.4);\n    vr = 0.9277 - 3.6224 / (b - 2);\n\n    while (1) {\n      U = Math.random() - 0.5;\n      V = Math.random();\n      us = 0.5 - Math.abs(U);\n      k = Math.floor((2 * a / us + b) * U + lam + 0.43);\n      if ((us >= 0.07) && (V <= vr)) {\n          return k;\n      }\n      if ((k < 0) || ((us < 0.013) && (V > us))) {\n          continue;\n      }\n      /* log(V) == log(0.0) ok here */\n      /* if U==0.0 so that us==0.0, log is ok since always returns */\n      if ((Math.log(V) + Math.log(invalpha) - Math.log(a / (us * us) + b)) <= (-lam + k * loglam - jStat.loggam(k + 1))) {\n          return k;\n      }\n    }\n  },\n\n  sample: function sample(l) {\n    if (l < 10)\n      return this.sampleSmall(l);\n    else\n      return this.sampleLarge(l);\n  }\n});\n\n// extend triangular function with static methods\njStat.extend(jStat.triangular, {\n  pdf: function pdf(x, a, b, c) {\n    if (b <= a || c < a || c > b) {\n      return NaN;\n    } else {\n      if (x < a || x > b) {\n        return 0;\n      } else if (x < c) {\n          return (2 * (x - a)) / ((b - a) * (c - a));\n      } else if (x === c) {\n          return (2 / (b - a));\n      } else { // x > c\n          return (2 * (b - x)) / ((b - a) * (b - c));\n      }\n    }\n  },\n\n  cdf: function cdf(x, a, b, c) {\n    if (b <= a || c < a || c > b)\n      return NaN;\n    if (x <= a)\n      return 0;\n    else if (x >= b)\n      return 1;\n    if (x <= c)\n      return Math.pow(x - a, 2) / ((b - a) * (c - a));\n    else // x > c\n      return 1 - Math.pow(b - x, 2) / ((b - a) * (b - c));\n  },\n\n  inv: function inv(p, a, b, c) {\n    if (b <= a || c < a || c > b) {\n      return NaN;\n    } else {\n      if (p <= ((c - a) / (b - a))) {\n        return a + (b - a) * Math.sqrt(p * ((c - a) / (b - a)));\n      } else { // p > ((c - a) / (b - a))\n        return a + (b - a) * (1 - Math.sqrt((1 - p) * (1 - ((c - a) / (b - a)))));\n      }\n    }\n  },\n\n  mean: function mean(a, b, c) {\n    return (a + b + c) / 3;\n  },\n\n  median: function median(a, b, c) {\n    if (c <= (a + b) / 2) {\n      return b - Math.sqrt((b - a) * (b - c)) / Math.sqrt(2);\n    } else if (c > (a + b) / 2) {\n      return a + Math.sqrt((b - a) * (c - a)) / Math.sqrt(2);\n    }\n  },\n\n  mode: function mode(a, b, c) {\n    return c;\n  },\n\n  sample: function sample(a, b, c) {\n    var u = jStat._random_fn();\n    if (u < ((c - a) / (b - a)))\n      return a + Math.sqrt(u * (b - a) * (c - a))\n    return b - Math.sqrt((1 - u) * (b - a) * (b - c));\n  },\n\n  variance: function variance(a, b, c) {\n    return (a * a + b * b + c * c - a * b - a * c - b * c) / 18;\n  }\n});\n\n\n// extend arcsine function with static methods\njStat.extend(jStat.arcsine, {\n  pdf: function pdf(x, a, b) {\n    if (b <= a) return NaN;\n\n    return (x <= a || x >= b) ? 0 :\n      (2 / Math.PI) *\n        Math.pow(Math.pow(b - a, 2) -\n                  Math.pow(2 * x - a - b, 2), -0.5);\n  },\n\n  cdf: function cdf(x, a, b) {\n    if (x < a)\n      return 0;\n    else if (x < b)\n      return (2 / Math.PI) * Math.asin(Math.sqrt((x - a)/(b - a)));\n    return 1;\n  },\n\n  inv: function(p, a, b) {\n    return a + (0.5 - 0.5 * Math.cos(Math.PI * p)) * (b - a);\n  },\n\n  mean: function mean(a, b) {\n    if (b <= a) return NaN;\n    return (a + b) / 2;\n  },\n\n  median: function median(a, b) {\n    if (b <= a) return NaN;\n    return (a + b) / 2;\n  },\n\n  mode: function mode(/*a, b*/) {\n    throw new Error('mode is not yet implemented');\n  },\n\n  sample: function sample(a, b) {\n    return ((a + b) / 2) + ((b - a) / 2) *\n      Math.sin(2 * Math.PI * jStat.uniform.sample(0, 1));\n  },\n\n  variance: function variance(a, b) {\n    if (b <= a) return NaN;\n    return Math.pow(b - a, 2) / 8;\n  }\n});\n\n\nfunction laplaceSign(x) { return x / Math.abs(x); }\n\njStat.extend(jStat.laplace, {\n  pdf: function pdf(x, mu, b) {\n    return (b <= 0) ? 0 : (Math.exp(-Math.abs(x - mu) / b)) / (2 * b);\n  },\n\n  cdf: function cdf(x, mu, b) {\n    if (b <= 0) { return 0; }\n\n    if(x < mu) {\n      return 0.5 * Math.exp((x - mu) / b);\n    } else {\n      return 1 - 0.5 * Math.exp(- (x - mu) / b);\n    }\n  },\n\n  mean: function(mu/*, b*/) {\n    return mu;\n  },\n\n  median: function(mu/*, b*/) {\n    return mu;\n  },\n\n  mode: function(mu/*, b*/) {\n    return mu;\n  },\n\n  variance: function(mu, b) {\n    return 2 * b * b;\n  },\n\n  sample: function sample(mu, b) {\n    var u = jStat._random_fn() - 0.5;\n\n    return mu - (b * laplaceSign(u) * Math.log(1 - (2 * Math.abs(u))));\n  }\n});\n\nfunction tukeyWprob(w, rr, cc) {\n  var nleg = 12;\n  var ihalf = 6;\n\n  var C1 = -30;\n  var C2 = -50;\n  var C3 = 60;\n  var bb   = 8;\n  var wlar = 3;\n  var wincr1 = 2;\n  var wincr2 = 3;\n  var xleg = [\n    0.981560634246719250690549090149,\n    0.904117256370474856678465866119,\n    0.769902674194304687036893833213,\n    0.587317954286617447296702418941,\n    0.367831498998180193752691536644,\n    0.125233408511468915472441369464\n  ];\n  var aleg = [\n    0.047175336386511827194615961485,\n    0.106939325995318430960254718194,\n    0.160078328543346226334652529543,\n    0.203167426723065921749064455810,\n    0.233492536538354808760849898925,\n    0.249147045813402785000562436043\n  ];\n\n  var qsqz = w * 0.5;\n\n  // if w >= 16 then the integral lower bound (occurs for c=20)\n  // is 0.99999999999995 so return a value of 1.\n\n  if (qsqz >= bb)\n    return 1.0;\n\n  // find (f(w/2) - 1) ^ cc\n  // (first term in integral of hartley's form).\n\n  var pr_w = 2 * jStat.normal.cdf(qsqz, 0, 1, 1, 0) - 1; // erf(qsqz / M_SQRT2)\n  // if pr_w ^ cc < 2e-22 then set pr_w = 0\n  if (pr_w >= Math.exp(C2 / cc))\n    pr_w = Math.pow(pr_w, cc);\n  else\n    pr_w = 0.0;\n\n  // if w is large then the second component of the\n  // integral is small, so fewer intervals are needed.\n\n  var wincr;\n  if (w > wlar)\n    wincr = wincr1;\n  else\n    wincr = wincr2;\n\n  // find the integral of second term of hartley's form\n  // for the integral of the range for equal-length\n  // intervals using legendre quadrature.  limits of\n  // integration are from (w/2, 8).  two or three\n  // equal-length intervals are used.\n\n  // blb and bub are lower and upper limits of integration.\n\n  var blb = qsqz;\n  var binc = (bb - qsqz) / wincr;\n  var bub = blb + binc;\n  var einsum = 0.0;\n\n  // integrate over each interval\n\n  var cc1 = cc - 1.0;\n  for (var wi = 1; wi <= wincr; wi++) {\n    var elsum = 0.0;\n    var a = 0.5 * (bub + blb);\n\n    // legendre quadrature with order = nleg\n\n    var b = 0.5 * (bub - blb);\n\n    for (var jj = 1; jj <= nleg; jj++) {\n      var j, xx;\n      if (ihalf < jj) {\n        j = (nleg - jj) + 1;\n        xx = xleg[j-1];\n      } else {\n        j = jj;\n        xx = -xleg[j-1];\n      }\n      var c = b * xx;\n      var ac = a + c;\n\n      // if exp(-qexpo/2) < 9e-14,\n      // then doesn't contribute to integral\n\n      var qexpo = ac * ac;\n      if (qexpo > C3)\n        break;\n\n      var pplus = 2 * jStat.normal.cdf(ac, 0, 1, 1, 0);\n      var pminus= 2 * jStat.normal.cdf(ac, w, 1, 1, 0);\n\n      // if rinsum ^ (cc-1) < 9e-14,\n      // then doesn't contribute to integral\n\n      var rinsum = (pplus * 0.5) - (pminus * 0.5);\n      if (rinsum >= Math.exp(C1 / cc1)) {\n        rinsum = (aleg[j-1] * Math.exp(-(0.5 * qexpo))) * Math.pow(rinsum, cc1);\n        elsum += rinsum;\n      }\n    }\n    elsum *= (((2.0 * b) * cc) / Math.sqrt(2 * Math.PI));\n    einsum += elsum;\n    blb = bub;\n    bub += binc;\n  }\n\n  // if pr_w ^ rr < 9e-14, then return 0\n  pr_w += einsum;\n  if (pr_w <= Math.exp(C1 / rr))\n    return 0;\n\n  pr_w = Math.pow(pr_w, rr);\n  if (pr_w >= 1) // 1 was iMax was eps\n    return 1;\n  return pr_w;\n}\n\nfunction tukeyQinv(p, c, v) {\n  var p0 = 0.322232421088;\n  var q0 = 0.993484626060e-01;\n  var p1 = -1.0;\n  var q1 = 0.588581570495;\n  var p2 = -0.342242088547;\n  var q2 = 0.531103462366;\n  var p3 = -0.204231210125;\n  var q3 = 0.103537752850;\n  var p4 = -0.453642210148e-04;\n  var q4 = 0.38560700634e-02;\n  var c1 = 0.8832;\n  var c2 = 0.2368;\n  var c3 = 1.214;\n  var c4 = 1.208;\n  var c5 = 1.4142;\n  var vmax = 120.0;\n\n  var ps = 0.5 - 0.5 * p;\n  var yi = Math.sqrt(Math.log(1.0 / (ps * ps)));\n  var t = yi + (((( yi * p4 + p3) * yi + p2) * yi + p1) * yi + p0)\n     / (((( yi * q4 + q3) * yi + q2) * yi + q1) * yi + q0);\n  if (v < vmax) t += (t * t * t + t) / v / 4.0;\n  var q = c1 - c2 * t;\n  if (v < vmax) q += -c3 / v + c4 * t / v;\n  return t * (q * Math.log(c - 1.0) + c5);\n}\n\njStat.extend(jStat.tukey, {\n  cdf: function cdf(q, nmeans, df) {\n    // Identical implementation as the R ptukey() function as of commit 68947\n    var rr = 1;\n    var cc = nmeans;\n\n    var nlegq = 16;\n    var ihalfq = 8;\n\n    var eps1 = -30.0;\n    var eps2 = 1.0e-14;\n    var dhaf  = 100.0;\n    var dquar = 800.0;\n    var deigh = 5000.0;\n    var dlarg = 25000.0;\n    var ulen1 = 1.0;\n    var ulen2 = 0.5;\n    var ulen3 = 0.25;\n    var ulen4 = 0.125;\n    var xlegq = [\n      0.989400934991649932596154173450,\n      0.944575023073232576077988415535,\n      0.865631202387831743880467897712,\n      0.755404408355003033895101194847,\n      0.617876244402643748446671764049,\n      0.458016777657227386342419442984,\n      0.281603550779258913230460501460,\n      0.950125098376374401853193354250e-1\n    ];\n    var alegq = [\n      0.271524594117540948517805724560e-1,\n      0.622535239386478928628438369944e-1,\n      0.951585116824927848099251076022e-1,\n      0.124628971255533872052476282192,\n      0.149595988816576732081501730547,\n      0.169156519395002538189312079030,\n      0.182603415044923588866763667969,\n      0.189450610455068496285396723208\n    ];\n\n    if (q <= 0)\n      return 0;\n\n    // df must be > 1\n    // there must be at least two values\n\n    if (df < 2 || rr < 1 || cc < 2) return NaN;\n\n    if (!Number.isFinite(q))\n      return 1;\n\n    if (df > dlarg)\n      return tukeyWprob(q, rr, cc);\n\n    // calculate leading constant\n\n    var f2 = df * 0.5;\n    var f2lf = ((f2 * Math.log(df)) - (df * Math.log(2))) - jStat.gammaln(f2);\n    var f21 = f2 - 1.0;\n\n    // integral is divided into unit, half-unit, quarter-unit, or\n    // eighth-unit length intervals depending on the value of the\n    // degrees of freedom.\n\n    var ff4 = df * 0.25;\n    var ulen;\n    if      (df <= dhaf)  ulen = ulen1;\n    else if (df <= dquar) ulen = ulen2;\n    else if (df <= deigh) ulen = ulen3;\n    else                  ulen = ulen4;\n\n    f2lf += Math.log(ulen);\n\n    // integrate over each subinterval\n\n    var ans = 0.0;\n\n    for (var i = 1; i <= 50; i++) {\n      var otsum = 0.0;\n\n      // legendre quadrature with order = nlegq\n      // nodes (stored in xlegq) are symmetric around zero.\n\n      var twa1 = (2 * i - 1) * ulen;\n\n      for (var jj = 1; jj <= nlegq; jj++) {\n        var j, t1;\n        if (ihalfq < jj) {\n          j = jj - ihalfq - 1;\n          t1 = (f2lf + (f21 * Math.log(twa1 + (xlegq[j] * ulen))))\n              - (((xlegq[j] * ulen) + twa1) * ff4);\n        } else {\n          j = jj - 1;\n          t1 = (f2lf + (f21 * Math.log(twa1 - (xlegq[j] * ulen))))\n              + (((xlegq[j] * ulen) - twa1) * ff4);\n        }\n\n        // if exp(t1) < 9e-14, then doesn't contribute to integral\n        var qsqz;\n        if (t1 >= eps1) {\n          if (ihalfq < jj) {\n            qsqz = q * Math.sqrt(((xlegq[j] * ulen) + twa1) * 0.5);\n          } else {\n            qsqz = q * Math.sqrt(((-(xlegq[j] * ulen)) + twa1) * 0.5);\n          }\n\n          // call wprob to find integral of range portion\n\n          var wprb = tukeyWprob(qsqz, rr, cc);\n          var rotsum = (wprb * alegq[j]) * Math.exp(t1);\n          otsum += rotsum;\n        }\n        // end legendre integral for interval i\n        // L200:\n      }\n\n      // if integral for interval i < 1e-14, then stop.\n      // However, in order to avoid small area under left tail,\n      // at least  1 / ulen  intervals are calculated.\n      if (i * ulen >= 1.0 && otsum <= eps2)\n        break;\n\n      // end of interval i\n      // L330:\n\n      ans += otsum;\n    }\n\n    if (otsum > eps2) { // not converged\n      throw new Error('tukey.cdf failed to converge');\n    }\n    if (ans > 1)\n      ans = 1;\n    return ans;\n  },\n\n  inv: function(p, nmeans, df) {\n    // Identical implementation as the R qtukey() function as of commit 68947\n    var rr = 1;\n    var cc = nmeans;\n\n    var eps = 0.0001;\n    var maxiter = 50;\n\n    // df must be > 1 ; there must be at least two values\n    if (df < 2 || rr < 1 || cc < 2) return NaN;\n\n    if (p < 0 || p > 1) return NaN;\n    if (p === 0) return 0;\n    if (p === 1) return Infinity;\n\n    // Initial value\n\n    var x0 = tukeyQinv(p, cc, df);\n\n    // Find prob(value < x0)\n\n    var valx0 = jStat.tukey.cdf(x0, nmeans, df) - p;\n\n    // Find the second iterate and prob(value < x1).\n    // If the first iterate has probability value\n    // exceeding p then second iterate is 1 less than\n    // first iterate; otherwise it is 1 greater.\n\n    var x1;\n    if (valx0 > 0.0)\n      x1 = Math.max(0.0, x0 - 1.0);\n    else\n      x1 = x0 + 1.0;\n    var valx1 = jStat.tukey.cdf(x1, nmeans, df) - p;\n\n    // Find new iterate\n\n    var ans;\n    for(var iter = 1; iter < maxiter; iter++) {\n      ans = x1 - ((valx1 * (x1 - x0)) / (valx1 - valx0));\n      valx0 = valx1;\n\n      // New iterate must be >= 0\n\n      x0 = x1;\n      if (ans < 0.0) {\n        ans = 0.0;\n        valx1 = -p;\n      }\n      // Find prob(value < new iterate)\n\n      valx1 = jStat.tukey.cdf(ans, nmeans, df) - p;\n      x1 = ans;\n\n      // If the difference between two successive\n      // iterates is less than eps, stop\n\n      var xabs = Math.abs(x1 - x0);\n      if (xabs < eps)\n        return ans;\n    }\n\n    throw new Error('tukey.inv failed to converge');\n  }\n});\n\n}(jStat, Math));\n/* Provides functions for the solution of linear system of equations, integration, extrapolation,\n * interpolation, eigenvalue problems, differential equations and PCA analysis. */\n\n(function(jStat, Math) {\n\nvar push = Array.prototype.push;\nvar isArray = jStat.utils.isArray;\n\nfunction isUsable(arg) {\n  return isArray(arg) || arg instanceof jStat;\n}\n\njStat.extend({\n\n  // add a vector/matrix to a vector/matrix or scalar\n  add: function add(arr, arg) {\n    // check if arg is a vector or scalar\n    if (isUsable(arg)) {\n      if (!isUsable(arg[0])) arg = [ arg ];\n      return jStat.map(arr, function(value, row, col) {\n        return value + arg[row][col];\n      });\n    }\n    return jStat.map(arr, function(value) { return value + arg; });\n  },\n\n  // subtract a vector or scalar from the vector\n  subtract: function subtract(arr, arg) {\n    // check if arg is a vector or scalar\n    if (isUsable(arg)) {\n      if (!isUsable(arg[0])) arg = [ arg ];\n      return jStat.map(arr, function(value, row, col) {\n        return value - arg[row][col] || 0;\n      });\n    }\n    return jStat.map(arr, function(value) { return value - arg; });\n  },\n\n  // matrix division\n  divide: function divide(arr, arg) {\n    if (isUsable(arg)) {\n      if (!isUsable(arg[0])) arg = [ arg ];\n      return jStat.multiply(arr, jStat.inv(arg));\n    }\n    return jStat.map(arr, function(value) { return value / arg; });\n  },\n\n  // matrix multiplication\n  multiply: function multiply(arr, arg) {\n    var row, col, nrescols, sum, nrow, ncol, res, rescols;\n    // eg: arr = 2 arg = 3 -> 6 for res[0][0] statement closure\n    if (arr.length === undefined && arg.length === undefined) {\n      return arr * arg;\n    }\n    nrow = arr.length,\n    ncol = arr[0].length,\n    res = jStat.zeros(nrow, nrescols = (isUsable(arg)) ? arg[0].length : ncol),\n    rescols = 0;\n    if (isUsable(arg)) {\n      for (; rescols < nrescols; rescols++) {\n        for (row = 0; row < nrow; row++) {\n          sum = 0;\n          for (col = 0; col < ncol; col++)\n          sum += arr[row][col] * arg[col][rescols];\n          res[row][rescols] = sum;\n        }\n      }\n      return (nrow === 1 && rescols === 1) ? res[0][0] : res;\n    }\n    return jStat.map(arr, function(value) { return value * arg; });\n  },\n\n  // outer([1,2,3],[4,5,6])\n  // ===\n  // [[1],[2],[3]] times [[4,5,6]]\n  // ->\n  // [[4,5,6],[8,10,12],[12,15,18]]\n  outer:function outer(A, B) {\n    return jStat.multiply(A.map(function(t){ return [t] }), [B]);\n  },\n\n\n  // Returns the dot product of two matricies\n  dot: function dot(arr, arg) {\n    if (!isUsable(arr[0])) arr = [ arr ];\n    if (!isUsable(arg[0])) arg = [ arg ];\n    // convert column to row vector\n    var left = (arr[0].length === 1 && arr.length !== 1) ? jStat.transpose(arr) : arr,\n    right = (arg[0].length === 1 && arg.length !== 1) ? jStat.transpose(arg) : arg,\n    res = [],\n    row = 0,\n    nrow = left.length,\n    ncol = left[0].length,\n    sum, col;\n    for (; row < nrow; row++) {\n      res[row] = [];\n      sum = 0;\n      for (col = 0; col < ncol; col++)\n      sum += left[row][col] * right[row][col];\n      res[row] = sum;\n    }\n    return (res.length === 1) ? res[0] : res;\n  },\n\n  // raise every element by a scalar\n  pow: function pow(arr, arg) {\n    return jStat.map(arr, function(value) { return Math.pow(value, arg); });\n  },\n\n  // exponentiate every element\n  exp: function exp(arr) {\n    return jStat.map(arr, function(value) { return Math.exp(value); });\n  },\n\n  // generate the natural log of every element\n  log: function exp(arr) {\n    return jStat.map(arr, function(value) { return Math.log(value); });\n  },\n\n  // generate the absolute values of the vector\n  abs: function abs(arr) {\n    return jStat.map(arr, function(value) { return Math.abs(value); });\n  },\n\n  // computes the p-norm of the vector\n  // In the case that a matrix is passed, uses the first row as the vector\n  norm: function norm(arr, p) {\n    var nnorm = 0,\n    i = 0;\n    // check the p-value of the norm, and set for most common case\n    if (isNaN(p)) p = 2;\n    // check if multi-dimensional array, and make vector correction\n    if (isUsable(arr[0])) arr = arr[0];\n    // vector norm\n    for (; i < arr.length; i++) {\n      nnorm += Math.pow(Math.abs(arr[i]), p);\n    }\n    return Math.pow(nnorm, 1 / p);\n  },\n\n  // computes the angle between two vectors in rads\n  // In case a matrix is passed, this uses the first row as the vector\n  angle: function angle(arr, arg) {\n    return Math.acos(jStat.dot(arr, arg) / (jStat.norm(arr) * jStat.norm(arg)));\n  },\n\n  // augment one matrix by another\n  // Note: this function returns a matrix, not a jStat object\n  aug: function aug(a, b) {\n    var newarr = [];\n    var i;\n    for (i = 0; i < a.length; i++) {\n      newarr.push(a[i].slice());\n    }\n    for (i = 0; i < newarr.length; i++) {\n      push.apply(newarr[i], b[i]);\n    }\n    return newarr;\n  },\n\n  // The inv() function calculates the inverse of a matrix\n  // Create the inverse by augmenting the matrix by the identity matrix of the\n  // appropriate size, and then use G-J elimination on the augmented matrix.\n  inv: function inv(a) {\n    var rows = a.length;\n    var cols = a[0].length;\n    var b = jStat.identity(rows, cols);\n    var c = jStat.gauss_jordan(a, b);\n    var result = [];\n    var i = 0;\n    var j;\n\n    //We need to copy the inverse portion to a new matrix to rid G-J artifacts\n    for (; i < rows; i++) {\n      result[i] = [];\n      for (j = cols; j < c[0].length; j++)\n        result[i][j - cols] = c[i][j];\n    }\n    return result;\n  },\n\n  // calculate the determinant of a matrix\n  det: function det(a) {\n    var alen = a.length,\n    alend = alen * 2,\n    vals = new Array(alend),\n    rowshift = alen - 1,\n    colshift = alend - 1,\n    mrow = rowshift - alen + 1,\n    mcol = colshift,\n    i = 0,\n    result = 0,\n    j;\n    // check for special 2x2 case\n    if (alen === 2) {\n      return a[0][0] * a[1][1] - a[0][1] * a[1][0];\n    }\n    for (; i < alend; i++) {\n      vals[i] = 1;\n    }\n    for (i = 0; i < alen; i++) {\n      for (j = 0; j < alen; j++) {\n        vals[(mrow < 0) ? mrow + alen : mrow ] *= a[i][j];\n        vals[(mcol < alen) ? mcol + alen : mcol ] *= a[i][j];\n        mrow++;\n        mcol--;\n      }\n      mrow = --rowshift - alen + 1;\n      mcol = --colshift;\n    }\n    for (i = 0; i < alen; i++) {\n      result += vals[i];\n    }\n    for (; i < alend; i++) {\n      result -= vals[i];\n    }\n    return result;\n  },\n\n  gauss_elimination: function gauss_elimination(a, b) {\n    var i = 0,\n    j = 0,\n    n = a.length,\n    m = a[0].length,\n    factor = 1,\n    sum = 0,\n    x = [],\n    maug, pivot, temp, k;\n    a = jStat.aug(a, b);\n    maug = a[0].length;\n    for(i = 0; i < n; i++) {\n      pivot = a[i][i];\n      j = i;\n      for (k = i + 1; k < m; k++) {\n        if (pivot < Math.abs(a[k][i])) {\n          pivot = a[k][i];\n          j = k;\n        }\n      }\n      if (j != i) {\n        for(k = 0; k < maug; k++) {\n          temp = a[i][k];\n          a[i][k] = a[j][k];\n          a[j][k] = temp;\n        }\n      }\n      for (j = i + 1; j < n; j++) {\n        factor = a[j][i] / a[i][i];\n        for(k = i; k < maug; k++) {\n          a[j][k] = a[j][k] - factor * a[i][k];\n        }\n      }\n    }\n    for (i = n - 1; i >= 0; i--) {\n      sum = 0;\n      for (j = i + 1; j<= n - 1; j++) {\n        sum = sum + x[j] * a[i][j];\n      }\n      x[i] =(a[i][maug - 1] - sum) / a[i][i];\n    }\n    return x;\n  },\n\n  gauss_jordan: function gauss_jordan(a, b) {\n    var m = jStat.aug(a, b);\n    var h = m.length;\n    var w = m[0].length;\n    var c = 0;\n    var x, y, y2;\n    // find max pivot\n    for (y = 0; y < h; y++) {\n      var maxrow = y;\n      for (y2 = y+1; y2 < h; y2++) {\n        if (Math.abs(m[y2][y]) > Math.abs(m[maxrow][y]))\n          maxrow = y2;\n      }\n      var tmp = m[y];\n      m[y] = m[maxrow];\n      m[maxrow] = tmp\n      for (y2 = y+1; y2 < h; y2++) {\n        c = m[y2][y] / m[y][y];\n        for (x = y; x < w; x++) {\n          m[y2][x] -= m[y][x] * c;\n        }\n      }\n    }\n    // backsubstitute\n    for (y = h-1; y >= 0; y--) {\n      c = m[y][y];\n      for (y2 = 0; y2 < y; y2++) {\n        for (x = w-1; x > y-1; x--) {\n          m[y2][x] -= m[y][x] * m[y2][y] / c;\n        }\n      }\n      m[y][y] /= c;\n      for (x = h; x < w; x++) {\n        m[y][x] /= c;\n      }\n    }\n    return m;\n  },\n\n  // solve equation\n  // Ax=b\n  // A is upper triangular matrix\n  // A=[[1,2,3],[0,4,5],[0,6,7]]\n  // b=[1,2,3]\n  // triaUpSolve(A,b) // -> [2.666,0.1666,1.666]\n  // if you use matrix style\n  // A=[[1,2,3],[0,4,5],[0,6,7]]\n  // b=[[1],[2],[3]]\n  // will return [[2.666],[0.1666],[1.666]]\n  triaUpSolve: function triaUpSolve(A, b) {\n    var size = A[0].length;\n    var x = jStat.zeros(1, size)[0];\n    var parts;\n    var matrix_mode = false;\n\n    if (b[0].length != undefined) {\n      b = b.map(function(i){ return i[0] });\n      matrix_mode = true;\n    }\n\n    jStat.arange(size - 1, -1, -1).forEach(function(i) {\n      parts = jStat.arange(i + 1, size).map(function(j) {\n        return x[j] * A[i][j];\n      });\n      x[i] = (b[i] - jStat.sum(parts)) / A[i][i];\n    });\n\n    if (matrix_mode)\n      return x.map(function(i){ return [i] });\n    return x;\n  },\n\n  triaLowSolve: function triaLowSolve(A, b) {\n    // like to triaUpSolve but A is lower triangular matrix\n    var size = A[0].length;\n    var x = jStat.zeros(1, size)[0];\n    var parts;\n\n    var matrix_mode=false;\n    if (b[0].length != undefined) {\n      b = b.map(function(i){ return i[0] });\n      matrix_mode = true;\n    }\n\n    jStat.arange(size).forEach(function(i) {\n      parts = jStat.arange(i).map(function(j) {\n        return A[i][j] * x[j];\n      });\n      x[i] = (b[i] - jStat.sum(parts)) / A[i][i];\n    })\n\n    if (matrix_mode)\n      return x.map(function(i){ return [i] });\n    return x;\n  },\n\n\n  // A -> [L,U]\n  // A=LU\n  // L is lower triangular matrix\n  // U is upper triangular matrix\n  lu: function lu(A) {\n    var size = A.length;\n    //var L=jStat.diagonal(jStat.ones(1,size)[0]);\n    var L = jStat.identity(size);\n    var R = jStat.zeros(A.length, A[0].length);\n    var parts;\n    jStat.arange(size).forEach(function(t) {\n      R[0][t] = A[0][t];\n    });\n    jStat.arange(1, size).forEach(function(l) {\n      jStat.arange(l).forEach(function(i) {\n        parts = jStat.arange(i).map(function(jj) {\n          return L[l][jj] * R[jj][i];\n        });\n        L[l][i] = (A[l][i] - jStat.sum(parts)) / R[i][i];\n      });\n      jStat.arange(l, size).forEach(function(j) {\n        parts = jStat.arange(l).map(function(jj) {\n          return L[l][jj] * R[jj][j];\n        });\n        R[l][j] = A[parts.length][j] - jStat.sum(parts);\n      });\n    });\n    return [L, R];\n  },\n\n  // A -> T\n  // A=TT'\n  // T is lower triangular matrix\n  cholesky: function cholesky(A) {\n    var size = A.length;\n    var T = jStat.zeros(A.length, A[0].length);\n    var parts;\n    jStat.arange(size).forEach(function(i) {\n      parts = jStat.arange(i).map(function(t) {\n        return Math.pow(T[i][t],2);\n      });\n      T[i][i] = Math.sqrt(A[i][i] - jStat.sum(parts));\n      jStat.arange(i + 1, size).forEach(function(j) {\n        parts = jStat.arange(i).map(function(t) {\n          return T[i][t] * T[j][t];\n        });\n        T[j][i] = (A[i][j] - jStat.sum(parts)) / T[i][i];\n      });\n    });\n    return T;\n  },\n\n\n  gauss_jacobi: function gauss_jacobi(a, b, x, r) {\n    var i = 0;\n    var j = 0;\n    var n = a.length;\n    var l = [];\n    var u = [];\n    var d = [];\n    var xv, c, h, xk;\n    for (; i < n; i++) {\n      l[i] = [];\n      u[i] = [];\n      d[i] = [];\n      for (j = 0; j < n; j++) {\n        if (i > j) {\n          l[i][j] = a[i][j];\n          u[i][j] = d[i][j] = 0;\n        } else if (i < j) {\n          u[i][j] = a[i][j];\n          l[i][j] = d[i][j] = 0;\n        } else {\n          d[i][j] = a[i][j];\n          l[i][j] = u[i][j] = 0;\n        }\n      }\n    }\n    h = jStat.multiply(jStat.multiply(jStat.inv(d), jStat.add(l, u)), -1);\n    c = jStat.multiply(jStat.inv(d), b);\n    xv = x;\n    xk = jStat.add(jStat.multiply(h, x), c);\n    i = 2;\n    while (Math.abs(jStat.norm(jStat.subtract(xk,xv))) > r) {\n      xv = xk;\n      xk = jStat.add(jStat.multiply(h, xv), c);\n      i++;\n    }\n    return xk;\n  },\n\n  gauss_seidel: function gauss_seidel(a, b, x, r) {\n    var i = 0;\n    var n = a.length;\n    var l = [];\n    var u = [];\n    var d = [];\n    var j, xv, c, h, xk;\n    for (; i < n; i++) {\n      l[i] = [];\n      u[i] = [];\n      d[i] = [];\n      for (j = 0; j < n; j++) {\n        if (i > j) {\n          l[i][j] = a[i][j];\n          u[i][j] = d[i][j] = 0;\n        } else if (i < j) {\n          u[i][j] = a[i][j];\n          l[i][j] = d[i][j] = 0;\n        } else {\n          d[i][j] = a[i][j];\n          l[i][j] = u[i][j] = 0;\n        }\n      }\n    }\n    h = jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d, l)), u), -1);\n    c = jStat.multiply(jStat.inv(jStat.add(d, l)), b);\n    xv = x;\n    xk = jStat.add(jStat.multiply(h, x), c);\n    i = 2;\n    while (Math.abs(jStat.norm(jStat.subtract(xk, xv))) > r) {\n      xv = xk;\n      xk = jStat.add(jStat.multiply(h, xv), c);\n      i = i + 1;\n    }\n    return xk;\n  },\n\n  SOR: function SOR(a, b, x, r, w) {\n    var i = 0;\n    var n = a.length;\n    var l = [];\n    var u = [];\n    var d = [];\n    var j, xv, c, h, xk;\n    for (; i < n; i++) {\n      l[i] = [];\n      u[i] = [];\n      d[i] = [];\n      for (j = 0; j < n; j++) {\n        if (i > j) {\n          l[i][j] = a[i][j];\n          u[i][j] = d[i][j] = 0;\n        } else if (i < j) {\n          u[i][j] = a[i][j];\n          l[i][j] = d[i][j] = 0;\n        } else {\n          d[i][j] = a[i][j];\n          l[i][j] = u[i][j] = 0;\n        }\n      }\n    }\n    h = jStat.multiply(jStat.inv(jStat.add(d, jStat.multiply(l, w))),\n                       jStat.subtract(jStat.multiply(d, 1 - w),\n                                      jStat.multiply(u, w)));\n    c = jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d,\n        jStat.multiply(l, w))), b), w);\n    xv = x;\n    xk = jStat.add(jStat.multiply(h, x), c);\n    i = 2;\n    while (Math.abs(jStat.norm(jStat.subtract(xk, xv))) > r) {\n      xv = xk;\n      xk = jStat.add(jStat.multiply(h, xv), c);\n      i++;\n    }\n    return xk;\n  },\n\n  householder: function householder(a) {\n    var m = a.length;\n    var n = a[0].length;\n    var i = 0;\n    var w = [];\n    var p = [];\n    var alpha, r, k, j, factor;\n    for (; i < m - 1; i++) {\n      alpha = 0;\n      for (j = i + 1; j < n; j++)\n      alpha += (a[j][i] * a[j][i]);\n      factor = (a[i + 1][i] > 0) ? -1 : 1;\n      alpha = factor * Math.sqrt(alpha);\n      r = Math.sqrt((((alpha * alpha) - a[i + 1][i] * alpha) / 2));\n      w = jStat.zeros(m, 1);\n      w[i + 1][0] = (a[i + 1][i] - alpha) / (2 * r);\n      for (k = i + 2; k < m; k++) w[k][0] = a[k][i] / (2 * r);\n      p = jStat.subtract(jStat.identity(m, n),\n          jStat.multiply(jStat.multiply(w, jStat.transpose(w)), 2));\n      a = jStat.multiply(p, jStat.multiply(a, p));\n    }\n    return a;\n  },\n\n  // A -> [Q,R]\n  // Q is orthogonal matrix\n  // R is upper triangular\n  QR: (function() {\n    // x -> Q\n    // find a orthogonal matrix Q st.\n    // Qx=y\n    // y is [||x||,0,0,...]\n\n    // quick ref\n    var sum   = jStat.sum;\n    var range = jStat.arange;\n\n    function qr2(x) {\n      // quick impletation\n      // https://www.stat.wisc.edu/~larget/math496/qr.html\n\n      var n = x.length;\n      var p = x[0].length;\n\n      var r = jStat.zeros(p, p);\n      x = jStat.copy(x);\n\n      var i,j,k;\n      for(j = 0; j < p; j++){\n        r[j][j] = Math.sqrt(sum(range(n).map(function(i){\n          return x[i][j] * x[i][j];\n        })));\n        for(i = 0; i < n; i++){\n          x[i][j] = x[i][j] / r[j][j];\n        }\n        for(k = j+1; k < p; k++){\n          r[j][k] = sum(range(n).map(function(i){\n            return x[i][j] * x[i][k];\n          }));\n          for(i = 0; i < n; i++){\n            x[i][k] = x[i][k] - x[i][j]*r[j][k];\n          }\n        }\n      }\n      return [x, r];\n    }\n\n    return qr2;\n  }()),\n\n  lstsq: (function() {\n    // solve least squard problem for Ax=b as QR decomposition way if b is\n    // [[b1],[b2],[b3]] form will return [[x1],[x2],[x3]] array form solution\n    // else b is [b1,b2,b3] form will return [x1,x2,x3] array form solution\n    function R_I(A) {\n      A = jStat.copy(A);\n      var size = A.length;\n      var I = jStat.identity(size);\n      jStat.arange(size - 1, -1, -1).forEach(function(i) {\n        jStat.sliceAssign(\n            I, { row: i }, jStat.divide(jStat.slice(I, { row: i }), A[i][i]));\n        jStat.sliceAssign(\n            A, { row: i }, jStat.divide(jStat.slice(A, { row: i }), A[i][i]));\n        jStat.arange(i).forEach(function(j) {\n          var c = jStat.multiply(A[j][i], -1);\n          var Aj = jStat.slice(A, { row: j });\n          var cAi = jStat.multiply(jStat.slice(A, { row: i }), c);\n          jStat.sliceAssign(A, { row: j }, jStat.add(Aj, cAi));\n          var Ij = jStat.slice(I, { row: j });\n          var cIi = jStat.multiply(jStat.slice(I, { row: i }), c);\n          jStat.sliceAssign(I, { row: j }, jStat.add(Ij, cIi));\n        })\n      });\n      return I;\n    }\n\n    function qr_solve(A, b){\n      var array_mode = false;\n      if (b[0].length === undefined) {\n        // [c1,c2,c3] mode\n        b = b.map(function(x){ return [x] });\n        array_mode = true;\n      }\n      var QR = jStat.QR(A);\n      var Q = QR[0];\n      var R = QR[1];\n      var attrs = A[0].length;\n      var Q1 = jStat.slice(Q,{col:{end:attrs}});\n      var R1 = jStat.slice(R,{row:{end:attrs}});\n      var RI = R_I(R1);\n      var Q2 = jStat.transpose(Q1);\n\n      if(Q2[0].length === undefined){\n        Q2 = [Q2]; // The confusing jStat.multifly implementation threat nature process again.\n      }\n\n      var x = jStat.multiply(jStat.multiply(RI, Q2), b);\n\n      if(x.length === undefined){\n        x = [[x]]; // The confusing jStat.multifly implementation threat nature process again.\n      }\n\n\n      if (array_mode)\n        return x.map(function(i){ return i[0] });\n      return x;\n    }\n\n    return qr_solve;\n  }()),\n\n  jacobi: function jacobi(a) {\n    var condition = 1;\n    var n = a.length;\n    var e = jStat.identity(n, n);\n    var ev = [];\n    var b, i, j, p, q, maxim, theta, s;\n    // condition === 1 only if tolerance is not reached\n    while (condition === 1) {\n      maxim = a[0][1];\n      p = 0;\n      q = 1;\n      for (i = 0; i < n; i++) {\n        for (j = 0; j < n; j++) {\n          if (i != j) {\n            if (maxim < Math.abs(a[i][j])) {\n              maxim = Math.abs(a[i][j]);\n              p = i;\n              q = j;\n            }\n          }\n        }\n      }\n      if (a[p][p] === a[q][q])\n        theta = (a[p][q] > 0) ? Math.PI / 4 : -Math.PI / 4;\n      else\n        theta = Math.atan(2 * a[p][q] / (a[p][p] - a[q][q])) / 2;\n      s = jStat.identity(n, n);\n      s[p][p] = Math.cos(theta);\n      s[p][q] = -Math.sin(theta);\n      s[q][p] = Math.sin(theta);\n      s[q][q] = Math.cos(theta);\n      // eigen vector matrix\n      e = jStat.multiply(e, s);\n      b = jStat.multiply(jStat.multiply(jStat.inv(s), a), s);\n      a = b;\n      condition = 0;\n      for (i = 1; i < n; i++) {\n        for (j = 1; j < n; j++) {\n          if (i != j && Math.abs(a[i][j]) > 0.001) {\n            condition = 1;\n          }\n        }\n      }\n    }\n    for (i = 0; i < n; i++) ev.push(a[i][i]);\n    //returns both the eigenvalue and eigenmatrix\n    return [e, ev];\n  },\n\n  rungekutta: function rungekutta(f, h, p, t_j, u_j, order) {\n    var k1, k2, u_j1, k3, k4;\n    if (order === 2) {\n      while (t_j <= p) {\n        k1 = h * f(t_j, u_j);\n        k2 = h * f(t_j + h, u_j + k1);\n        u_j1 = u_j + (k1 + k2) / 2;\n        u_j = u_j1;\n        t_j = t_j + h;\n      }\n    }\n    if (order === 4) {\n      while (t_j <= p) {\n        k1 = h * f(t_j, u_j);\n        k2 = h * f(t_j + h / 2, u_j + k1 / 2);\n        k3 = h * f(t_j + h / 2, u_j + k2 / 2);\n        k4 = h * f(t_j +h, u_j + k3);\n        u_j1 = u_j + (k1 + 2 * k2 + 2 * k3 + k4) / 6;\n        u_j = u_j1;\n        t_j = t_j + h;\n      }\n    }\n    return u_j;\n  },\n\n  romberg: function romberg(f, a, b, order) {\n    var i = 0;\n    var h = (b - a) / 2;\n    var x = [];\n    var h1 = [];\n    var g = [];\n    var m, a1, j, k, I;\n    while (i < order / 2) {\n      I = f(a);\n      for (j = a, k = 0; j <= b; j = j + h, k++) x[k] = j;\n      m = x.length;\n      for (j = 1; j < m - 1; j++) {\n        I += (((j % 2) !== 0) ? 4 : 2) * f(x[j]);\n      }\n      I = (h / 3) * (I + f(b));\n      g[i] = I;\n      h /= 2;\n      i++;\n    }\n    a1 = g.length;\n    m = 1;\n    while (a1 !== 1) {\n      for (j = 0; j < a1 - 1; j++)\n      h1[j] = ((Math.pow(4, m)) * g[j + 1] - g[j]) / (Math.pow(4, m) - 1);\n      a1 = h1.length;\n      g = h1;\n      h1 = [];\n      m++;\n    }\n    return g;\n  },\n\n  richardson: function richardson(X, f, x, h) {\n    function pos(X, x) {\n      var i = 0;\n      var n = X.length;\n      var p;\n      for (; i < n; i++)\n        if (X[i] === x) p = i;\n      return p;\n    }\n    var h_min = Math.abs(x - X[pos(X, x) + 1]);\n    var i = 0;\n    var g = [];\n    var h1 = [];\n    var y1, y2, m, a, j;\n    while (h >= h_min) {\n      y1 = pos(X, x + h);\n      y2 = pos(X, x);\n      g[i] = (f[y1] - 2 * f[y2] + f[2 * y2 - y1]) / (h * h);\n      h /= 2;\n      i++;\n    }\n    a = g.length;\n    m = 1;\n    while (a != 1) {\n      for (j = 0; j < a - 1; j++)\n        h1[j] = ((Math.pow(4, m)) * g[j + 1] - g[j]) / (Math.pow(4, m) - 1);\n      a = h1.length;\n      g = h1;\n      h1 = [];\n      m++;\n    }\n    return g;\n  },\n\n  simpson: function simpson(f, a, b, n) {\n    var h = (b - a) / n;\n    var I = f(a);\n    var x = [];\n    var j = a;\n    var k = 0;\n    var i = 1;\n    var m;\n    for (; j <= b; j = j + h, k++)\n      x[k] = j;\n    m = x.length;\n    for (; i < m - 1; i++) {\n      I += ((i % 2 !== 0) ? 4 : 2) * f(x[i]);\n    }\n    return (h / 3) * (I + f(b));\n  },\n\n  hermite: function hermite(X, F, dF, value) {\n    var n = X.length;\n    var p = 0;\n    var i = 0;\n    var l = [];\n    var dl = [];\n    var A = [];\n    var B = [];\n    var j;\n    for (; i < n; i++) {\n      l[i] = 1;\n      for (j = 0; j < n; j++) {\n        if (i != j) l[i] *= (value - X[j]) / (X[i] - X[j]);\n      }\n      dl[i] = 0;\n      for (j = 0; j < n; j++) {\n        if (i != j) dl[i] += 1 / (X [i] - X[j]);\n      }\n      A[i] = (1 - 2 * (value - X[i]) * dl[i]) * (l[i] * l[i]);\n      B[i] = (value - X[i]) * (l[i] * l[i]);\n      p += (A[i] * F[i] + B[i] * dF[i]);\n    }\n    return p;\n  },\n\n  lagrange: function lagrange(X, F, value) {\n    var p = 0;\n    var i = 0;\n    var j, l;\n    var n = X.length;\n    for (; i < n; i++) {\n      l = F[i];\n      for (j = 0; j < n; j++) {\n        // calculating the lagrange polynomial L_i\n        if (i != j) l *= (value - X[j]) / (X[i] - X[j]);\n      }\n      // adding the lagrange polynomials found above\n      p += l;\n    }\n    return p;\n  },\n\n  cubic_spline: function cubic_spline(X, F, value) {\n    var n = X.length;\n    var i = 0, j;\n    var A = [];\n    var B = [];\n    var alpha = [];\n    var c = [];\n    var h = [];\n    var b = [];\n    var d = [];\n    for (; i < n - 1; i++)\n      h[i] = X[i + 1] - X[i];\n    alpha[0] = 0;\n    for (i = 1; i < n - 1; i++) {\n      alpha[i] = (3 / h[i]) * (F[i + 1] - F[i]) -\n          (3 / h[i-1]) * (F[i] - F[i-1]);\n    }\n    for (i = 1; i < n - 1; i++) {\n      A[i] = [];\n      B[i] = [];\n      A[i][i-1] = h[i-1];\n      A[i][i] = 2 * (h[i - 1] + h[i]);\n      A[i][i+1] = h[i];\n      B[i][0] = alpha[i];\n    }\n    c = jStat.multiply(jStat.inv(A), B);\n    for (j = 0; j < n - 1; j++) {\n      b[j] = (F[j + 1] - F[j]) / h[j] - h[j] * (c[j + 1][0] + 2 * c[j][0]) / 3;\n      d[j] = (c[j + 1][0] - c[j][0]) / (3 * h[j]);\n    }\n    for (j = 0; j < n; j++) {\n      if (X[j] > value) break;\n    }\n    j -= 1;\n    return F[j] + (value - X[j]) * b[j] + jStat.sq(value-X[j]) *\n        c[j] + (value - X[j]) * jStat.sq(value - X[j]) * d[j];\n  },\n\n  gauss_quadrature: function gauss_quadrature() {\n    throw new Error('gauss_quadrature not yet implemented');\n  },\n\n  PCA: function PCA(X) {\n    var m = X.length;\n    var n = X[0].length;\n    var i = 0;\n    var j, temp1;\n    var u = [];\n    var D = [];\n    var result = [];\n    var temp2 = [];\n    var Y = [];\n    var Bt = [];\n    var B = [];\n    var C = [];\n    var V = [];\n    var Vt = [];\n    for (i = 0; i < m; i++) {\n      u[i] = jStat.sum(X[i]) / n;\n    }\n    for (i = 0; i < n; i++) {\n      B[i] = [];\n      for(j = 0; j < m; j++) {\n        B[i][j] = X[j][i] - u[j];\n      }\n    }\n    B = jStat.transpose(B);\n    for (i = 0; i < m; i++) {\n      C[i] = [];\n      for (j = 0; j < m; j++) {\n        C[i][j] = (jStat.dot([B[i]], [B[j]])) / (n - 1);\n      }\n    }\n    result = jStat.jacobi(C);\n    V = result[0];\n    D = result[1];\n    Vt = jStat.transpose(V);\n    for (i = 0; i < D.length; i++) {\n      for (j = i; j < D.length; j++) {\n        if(D[i] < D[j])  {\n          temp1 = D[i];\n          D[i] = D[j];\n          D[j] = temp1;\n          temp2 = Vt[i];\n          Vt[i] = Vt[j];\n          Vt[j] = temp2;\n        }\n      }\n    }\n    Bt = jStat.transpose(B);\n    for (i = 0; i < m; i++) {\n      Y[i] = [];\n      for (j = 0; j < Bt.length; j++) {\n        Y[i][j] = jStat.dot([Vt[i]], [Bt[j]]);\n      }\n    }\n    return [X, D, Vt, Y];\n  }\n});\n\n// extend jStat.fn with methods that require one argument\n(function(funcs) {\n  for (var i = 0; i < funcs.length; i++) (function(passfunc) {\n    jStat.fn[passfunc] = function(arg, func) {\n      var tmpthis = this;\n      // check for callback\n      if (func) {\n        setTimeout(function() {\n          func.call(tmpthis, jStat.fn[passfunc].call(tmpthis, arg));\n        }, 15);\n        return this;\n      }\n      if (typeof jStat[passfunc](this, arg) === 'number')\n        return jStat[passfunc](this, arg);\n      else\n        return jStat(jStat[passfunc](this, arg));\n    };\n  }(funcs[i]));\n}('add divide multiply subtract dot pow exp log abs norm angle'.split(' ')));\n\n}(jStat, Math));\n(function(jStat, Math) {\n\nvar slice = [].slice;\nvar isNumber = jStat.utils.isNumber;\nvar isArray = jStat.utils.isArray;\n\n// flag==true denotes use of sample standard deviation\n// Z Statistics\njStat.extend({\n  // 2 different parameter lists:\n  // (value, mean, sd)\n  // (value, array, flag)\n  zscore: function zscore() {\n    var args = slice.call(arguments);\n    if (isNumber(args[1])) {\n      return (args[0] - args[1]) / args[2];\n    }\n    return (args[0] - jStat.mean(args[1])) / jStat.stdev(args[1], args[2]);\n  },\n\n  // 3 different paramter lists:\n  // (value, mean, sd, sides)\n  // (zscore, sides)\n  // (value, array, sides, flag)\n  ztest: function ztest() {\n    var args = slice.call(arguments);\n    var z;\n    if (isArray(args[1])) {\n      // (value, array, sides, flag)\n      z = jStat.zscore(args[0],args[1],args[3]);\n      return (args[2] === 1) ?\n        (jStat.normal.cdf(-Math.abs(z), 0, 1)) :\n        (jStat.normal.cdf(-Math.abs(z), 0, 1)*2);\n    } else {\n      if (args.length > 2) {\n        // (value, mean, sd, sides)\n        z = jStat.zscore(args[0],args[1],args[2]);\n        return (args[3] === 1) ?\n          (jStat.normal.cdf(-Math.abs(z),0,1)) :\n          (jStat.normal.cdf(-Math.abs(z),0,1)* 2);\n      } else {\n        // (zscore, sides)\n        z = args[0];\n        return (args[1] === 1) ?\n          (jStat.normal.cdf(-Math.abs(z),0,1)) :\n          (jStat.normal.cdf(-Math.abs(z),0,1)*2);\n      }\n    }\n  }\n});\n\njStat.extend(jStat.fn, {\n  zscore: function zscore(value, flag) {\n    return (value - this.mean()) / this.stdev(flag);\n  },\n\n  ztest: function ztest(value, sides, flag) {\n    var zscore = Math.abs(this.zscore(value, flag));\n    return (sides === 1) ?\n      (jStat.normal.cdf(-zscore, 0, 1)) :\n      (jStat.normal.cdf(-zscore, 0, 1) * 2);\n  }\n});\n\n// T Statistics\njStat.extend({\n  // 2 parameter lists\n  // (value, mean, sd, n)\n  // (value, array)\n  tscore: function tscore() {\n    var args = slice.call(arguments);\n    return (args.length === 4) ?\n      ((args[0] - args[1]) / (args[2] / Math.sqrt(args[3]))) :\n      ((args[0] - jStat.mean(args[1])) /\n       (jStat.stdev(args[1], true) / Math.sqrt(args[1].length)));\n  },\n\n  // 3 different paramter lists:\n  // (value, mean, sd, n, sides)\n  // (tscore, n, sides)\n  // (value, array, sides)\n  ttest: function ttest() {\n    var args = slice.call(arguments);\n    var tscore;\n    if (args.length === 5) {\n      tscore = Math.abs(jStat.tscore(args[0], args[1], args[2], args[3]));\n      return (args[4] === 1) ?\n        (jStat.studentt.cdf(-tscore, args[3]-1)) :\n        (jStat.studentt.cdf(-tscore, args[3]-1)*2);\n    }\n    if (isNumber(args[1])) {\n      tscore = Math.abs(args[0])\n      return (args[2] == 1) ?\n        (jStat.studentt.cdf(-tscore, args[1]-1)) :\n        (jStat.studentt.cdf(-tscore, args[1]-1) * 2);\n    }\n    tscore = Math.abs(jStat.tscore(args[0], args[1]))\n    return (args[2] == 1) ?\n      (jStat.studentt.cdf(-tscore, args[1].length-1)) :\n      (jStat.studentt.cdf(-tscore, args[1].length-1) * 2);\n  }\n});\n\njStat.extend(jStat.fn, {\n  tscore: function tscore(value) {\n    return (value - this.mean()) / (this.stdev(true) / Math.sqrt(this.cols()));\n  },\n\n  ttest: function ttest(value, sides) {\n    return (sides === 1) ?\n      (1 - jStat.studentt.cdf(Math.abs(this.tscore(value)), this.cols()-1)) :\n      (jStat.studentt.cdf(-Math.abs(this.tscore(value)), this.cols()-1)*2);\n  }\n});\n\n// F Statistics\njStat.extend({\n  // Paramter list is as follows:\n  // (array1, array2, array3, ...)\n  // or it is an array of arrays\n  // array of arrays conversion\n  anovafscore: function anovafscore() {\n    var args = slice.call(arguments),\n    expVar, sample, sampMean, sampSampMean, tmpargs, unexpVar, i, j;\n    if (args.length === 1) {\n      tmpargs = new Array(args[0].length);\n      for (i = 0; i < args[0].length; i++) {\n        tmpargs[i] = args[0][i];\n      }\n      args = tmpargs;\n    }\n    // Builds sample array\n    sample = new Array();\n    for (i = 0; i < args.length; i++) {\n      sample = sample.concat(args[i]);\n    }\n    sampMean = jStat.mean(sample);\n    // Computes the explained variance\n    expVar = 0;\n    for (i = 0; i < args.length; i++) {\n      expVar = expVar + args[i].length * Math.pow(jStat.mean(args[i]) - sampMean, 2);\n    }\n    expVar /= (args.length - 1);\n    // Computes unexplained variance\n    unexpVar = 0;\n    for (i = 0; i < args.length; i++) {\n      sampSampMean = jStat.mean(args[i]);\n      for (j = 0; j < args[i].length; j++) {\n        unexpVar += Math.pow(args[i][j] - sampSampMean, 2);\n      }\n    }\n    unexpVar /= (sample.length - args.length);\n    return expVar / unexpVar;\n  },\n\n  // 2 different paramter setups\n  // (array1, array2, array3, ...)\n  // (anovafscore, df1, df2)\n  anovaftest: function anovaftest() {\n    var args = slice.call(arguments),\n    df1, df2, n, i;\n    if (isNumber(args[0])) {\n      return 1 - jStat.centralF.cdf(args[0], args[1], args[2]);\n    }\n    var anovafscore = jStat.anovafscore(args);\n    df1 = args.length - 1;\n    n = 0;\n    for (i = 0; i < args.length; i++) {\n      n = n + args[i].length;\n    }\n    df2 = n - df1 - 1;\n    return 1 - jStat.centralF.cdf(anovafscore, df1, df2);\n  },\n\n  ftest: function ftest(fscore, df1, df2) {\n    return 1 - jStat.centralF.cdf(fscore, df1, df2);\n  }\n});\n\njStat.extend(jStat.fn, {\n  anovafscore: function anovafscore() {\n    return jStat.anovafscore(this.toArray());\n  },\n\n  anovaftes: function anovaftes() {\n    var n = 0;\n    var i;\n    for (i = 0; i < this.length; i++) {\n      n = n + this[i].length;\n    }\n    return jStat.ftest(this.anovafscore(), this.length - 1, n - this.length);\n  }\n});\n\n// Tukey's range test\njStat.extend({\n  // 2 parameter lists\n  // (mean1, mean2, n1, n2, sd)\n  // (array1, array2, sd)\n  qscore: function qscore() {\n    var args = slice.call(arguments);\n    var mean1, mean2, n1, n2, sd;\n    if (isNumber(args[0])) {\n        mean1 = args[0];\n        mean2 = args[1];\n        n1 = args[2];\n        n2 = args[3];\n        sd = args[4];\n    } else {\n        mean1 = jStat.mean(args[0]);\n        mean2 = jStat.mean(args[1]);\n        n1 = args[0].length;\n        n2 = args[1].length;\n        sd = args[2];\n    }\n    return Math.abs(mean1 - mean2) / (sd * Math.sqrt((1 / n1 + 1 / n2) / 2));\n  },\n\n  // 3 different parameter lists:\n  // (qscore, n, k)\n  // (mean1, mean2, n1, n2, sd, n, k)\n  // (array1, array2, sd, n, k)\n  qtest: function qtest() {\n    var args = slice.call(arguments);\n\n    var qscore;\n    if (args.length === 3) {\n      qscore = args[0];\n      args = args.slice(1);\n    } else if (args.length === 7) {\n      qscore = jStat.qscore(args[0], args[1], args[2], args[3], args[4]);\n      args = args.slice(5);\n    } else {\n      qscore = jStat.qscore(args[0], args[1], args[2]);\n      args = args.slice(3);\n    }\n\n    var n = args[0];\n    var k = args[1];\n\n    return 1 - jStat.tukey.cdf(qscore, k, n - k);\n  },\n\n  tukeyhsd: function tukeyhsd(arrays) {\n    var sd = jStat.pooledstdev(arrays);\n    var means = arrays.map(function (arr) {return jStat.mean(arr);});\n    var n = arrays.reduce(function (n, arr) {return n + arr.length;}, 0);\n\n    var results = [];\n    for (var i = 0; i < arrays.length; ++i) {\n        for (var j = i + 1; j < arrays.length; ++j) {\n            var p = jStat.qtest(means[i], means[j], arrays[i].length, arrays[j].length, sd, n, arrays.length);\n            results.push([[i, j], p]);\n        }\n    }\n\n    return results;\n  }\n});\n\n// Error Bounds\njStat.extend({\n  // 2 different parameter setups\n  // (value, alpha, sd, n)\n  // (value, alpha, array)\n  normalci: function normalci() {\n    var args = slice.call(arguments),\n    ans = new Array(2),\n    change;\n    if (args.length === 4) {\n      change = Math.abs(jStat.normal.inv(args[1] / 2, 0, 1) *\n                        args[2] / Math.sqrt(args[3]));\n    } else {\n      change = Math.abs(jStat.normal.inv(args[1] / 2, 0, 1) *\n                        jStat.stdev(args[2]) / Math.sqrt(args[2].length));\n    }\n    ans[0] = args[0] - change;\n    ans[1] = args[0] + change;\n    return ans;\n  },\n\n  // 2 different parameter setups\n  // (value, alpha, sd, n)\n  // (value, alpha, array)\n  tci: function tci() {\n    var args = slice.call(arguments),\n    ans = new Array(2),\n    change;\n    if (args.length === 4) {\n      change = Math.abs(jStat.studentt.inv(args[1] / 2, args[3] - 1) *\n                        args[2] / Math.sqrt(args[3]));\n    } else {\n      change = Math.abs(jStat.studentt.inv(args[1] / 2, args[2].length - 1) *\n                        jStat.stdev(args[2], true) / Math.sqrt(args[2].length));\n    }\n    ans[0] = args[0] - change;\n    ans[1] = args[0] + change;\n    return ans;\n  },\n\n  significant: function significant(pvalue, alpha) {\n    return pvalue < alpha;\n  }\n});\n\njStat.extend(jStat.fn, {\n  normalci: function normalci(value, alpha) {\n    return jStat.normalci(value, alpha, this.toArray());\n  },\n\n  tci: function tci(value, alpha) {\n    return jStat.tci(value, alpha, this.toArray());\n  }\n});\n\n// internal method for calculating the z-score for a difference of proportions test\nfunction differenceOfProportions(p1, n1, p2, n2) {\n  if (p1 > 1 || p2 > 1 || p1 <= 0 || p2 <= 0) {\n    throw new Error(\"Proportions should be greater than 0 and less than 1\")\n  }\n  var pooled = (p1 * n1 + p2 * n2) / (n1 + n2);\n  var se = Math.sqrt(pooled * (1 - pooled) * ((1/n1) + (1/n2)));\n  return (p1 - p2) / se;\n}\n\n// Difference of Proportions\njStat.extend(jStat.fn, {\n  oneSidedDifferenceOfProportions: function oneSidedDifferenceOfProportions(p1, n1, p2, n2) {\n    var z = differenceOfProportions(p1, n1, p2, n2);\n    return jStat.ztest(z, 1);\n  },\n\n  twoSidedDifferenceOfProportions: function twoSidedDifferenceOfProportions(p1, n1, p2, n2) {\n    var z = differenceOfProportions(p1, n1, p2, n2);\n    return jStat.ztest(z, 2);\n  }\n});\n\n}(jStat, Math));\njStat.models = (function(){\n  function sub_regress(exog) {\n    var var_count = exog[0].length;\n    var modelList = jStat.arange(var_count).map(function(endog_index) {\n      var exog_index =\n          jStat.arange(var_count).filter(function(i){return i!==endog_index});\n      return ols(jStat.col(exog, endog_index).map(function(x){ return x[0] }),\n                 jStat.col(exog, exog_index))\n    });\n    return modelList;\n  }\n\n  // do OLS model regress\n  // exog have include const columns ,it will not generate it .In fact, exog is\n  // \"design matrix\" look at\n  //https://en.wikipedia.org/wiki/Design_matrix\n  function ols(endog, exog) {\n    var nobs = endog.length;\n    var df_model = exog[0].length - 1;\n    var df_resid = nobs-df_model - 1;\n    var coef = jStat.lstsq(exog, endog);\n    var predict =\n        jStat.multiply(exog, coef.map(function(x) { return [x] }))\n            .map(function(p) { return p[0] });\n    var resid = jStat.subtract(endog, predict);\n    var ybar = jStat.mean(endog);\n    // constant cause problem\n    // var SST = jStat.sum(endog.map(function(y) {\n    //   return Math.pow(y-ybar,2);\n    // }));\n    var SSE = jStat.sum(predict.map(function(f) {\n      return Math.pow(f - ybar, 2);\n    }));\n    var SSR = jStat.sum(endog.map(function(y, i) {\n      return Math.pow(y - predict[i], 2);\n    }));\n    var SST = SSE + SSR;\n    var R2 = (SSE / SST);\n    return {\n        exog:exog,\n        endog:endog,\n        nobs:nobs,\n        df_model:df_model,\n        df_resid:df_resid,\n        coef:coef,\n        predict:predict,\n        resid:resid,\n        ybar:ybar,\n        SST:SST,\n        SSE:SSE,\n        SSR:SSR,\n        R2:R2\n    };\n  }\n\n  // H0: b_I=0\n  // H1: b_I!=0\n  function t_test(model) {\n    var subModelList = sub_regress(model.exog);\n    //var sigmaHat=jStat.stdev(model.resid);\n    var sigmaHat = Math.sqrt(model.SSR / (model.df_resid));\n    var seBetaHat = subModelList.map(function(mod) {\n      var SST = mod.SST;\n      var R2 = mod.R2;\n      return sigmaHat / Math.sqrt(SST * (1 - R2));\n    });\n    var tStatistic = model.coef.map(function(coef, i) {\n      return (coef - 0) / seBetaHat[i];\n    });\n    var pValue = tStatistic.map(function(t) {\n      var leftppf = jStat.studentt.cdf(t, model.df_resid);\n      return (leftppf > 0.5 ? 1 - leftppf : leftppf) * 2;\n    });\n    var c = jStat.studentt.inv(0.975, model.df_resid);\n    var interval95 = model.coef.map(function(coef, i) {\n      var d = c * seBetaHat[i];\n      return [coef - d, coef + d];\n    })\n    return {\n        se: seBetaHat,\n        t: tStatistic,\n        p: pValue,\n        sigmaHat: sigmaHat,\n        interval95: interval95\n    };\n  }\n\n  function F_test(model) {\n    var F_statistic =\n        (model.R2 / model.df_model) / ((1 - model.R2) / model.df_resid);\n    var fcdf = function(x, n1, n2) {\n      return jStat.beta.cdf(x / (n2 / n1 + x), n1 / 2, n2 / 2)\n    }\n    var pvalue = 1 - fcdf(F_statistic, model.df_model, model.df_resid);\n    return { F_statistic: F_statistic, pvalue: pvalue };\n  }\n\n  function ols_wrap(endog, exog) {\n    var model = ols(endog,exog);\n    var ttest = t_test(model);\n    var ftest = F_test(model);\n    // Provide the Wherry / Ezekiel / McNemar / Cohen Adjusted R^2\n    // Which matches the 'adjusted R^2' provided by R's lm package\n    var adjust_R2 =\n        1 - (1 - model.R2) * ((model.nobs - 1) / (model.df_resid));\n    model.t = ttest;\n    model.f = ftest;\n    model.adjust_R2 = adjust_R2;\n    return model;\n  }\n\n  return { ols: ols_wrap };\n})();\n//To regress, simply build X matrix\n//(append column of 1's) using\n//buildxmatrix and build the Y\n//matrix using buildymatrix\n//(simply the transpose)\n//and run regress.\n\n\n\n//Regressions\n\njStat.extend({\n  buildxmatrix: function buildxmatrix(){\n    //Parameters will be passed in as such\n    //(array1,array2,array3,...)\n    //as (x1,x2,x3,...)\n    //needs to be (1,x1,x2,x3,...)\n    var matrixRows = new Array(arguments.length);\n    for(var i=0;i<arguments.length;i++){\n      var array = [1];\n      matrixRows[i]= array.concat(arguments[i]);\n    }\n    return jStat(matrixRows);\n\n  },\n\n  builddxmatrix: function builddxmatrix() {\n    //Paramters will be passed in as such\n    //([array1,array2,...]\n    var matrixRows = new Array(arguments[0].length);\n    for(var i=0;i<arguments[0].length;i++){\n      var array = [1]\n      matrixRows[i]= array.concat(arguments[0][i]);\n    }\n    return jStat(matrixRows);\n\n  },\n\n  buildjxmatrix: function buildjxmatrix(jMat) {\n    //Builds from jStat Matrix\n    var pass = new Array(jMat.length)\n    for(var i=0;i<jMat.length;i++){\n      pass[i] = jMat[i];\n    }\n    return jStat.builddxmatrix(pass);\n\n  },\n\n  buildymatrix: function buildymatrix(array){\n    return jStat(array).transpose();\n  },\n\n  buildjymatrix: function buildjymatrix(jMat){\n    return jMat.transpose();\n  },\n\n  matrixmult: function matrixmult(A,B){\n    var i, j, k, result, sum;\n    if (A.cols() == B.rows()) {\n      if(B.rows()>1){\n        result = [];\n        for (i = 0; i < A.rows(); i++) {\n          result[i] = [];\n          for (j = 0; j < B.cols(); j++) {\n            sum = 0;\n            for (k = 0; k < A.cols(); k++) {\n              sum += A.toArray()[i][k] * B.toArray()[k][j];\n            }\n            result[i][j] = sum;\n          }\n        }\n        return jStat(result);\n      }\n      result = [];\n      for (i = 0; i < A.rows(); i++) {\n        result[i] = [];\n        for (j = 0; j < B.cols(); j++) {\n          sum = 0;\n          for (k = 0; k < A.cols(); k++) {\n            sum += A.toArray()[i][k] * B.toArray()[j];\n          }\n          result[i][j] = sum;\n        }\n      }\n      return jStat(result);\n    }\n  },\n\n  //regress and regresst to be fixed\n\n  regress: function regress(jMatX,jMatY){\n    //print(\"regressin!\");\n    //print(jMatX.toArray());\n    var innerinv = jStat.xtranspxinv(jMatX);\n    //print(innerinv);\n    var xtransp = jMatX.transpose();\n    var next = jStat.matrixmult(jStat(innerinv),xtransp);\n    return jStat.matrixmult(next,jMatY);\n\n  },\n\n  regresst: function regresst(jMatX,jMatY,sides){\n    var beta = jStat.regress(jMatX,jMatY);\n\n    var compile = {};\n    compile.anova = {};\n    var jMatYBar = jStat.jMatYBar(jMatX, beta);\n    compile.yBar = jMatYBar;\n    var yAverage = jMatY.mean();\n    compile.anova.residuals = jStat.residuals(jMatY, jMatYBar);\n\n    compile.anova.ssr = jStat.ssr(jMatYBar, yAverage);\n    compile.anova.msr = compile.anova.ssr / (jMatX[0].length - 1);\n\n    compile.anova.sse = jStat.sse(jMatY, jMatYBar);\n    compile.anova.mse =\n        compile.anova.sse / (jMatY.length - (jMatX[0].length - 1) - 1);\n\n    compile.anova.sst = jStat.sst(jMatY, yAverage);\n    compile.anova.mst = compile.anova.sst / (jMatY.length - 1);\n\n    compile.anova.r2 = 1 - (compile.anova.sse / compile.anova.sst);\n    if (compile.anova.r2 < 0) compile.anova.r2 = 0;\n\n    compile.anova.fratio = compile.anova.msr / compile.anova.mse;\n    compile.anova.pvalue =\n        jStat.anovaftest(compile.anova.fratio,\n                         jMatX[0].length - 1,\n                         jMatY.length - (jMatX[0].length - 1) - 1);\n\n    compile.anova.rmse = Math.sqrt(compile.anova.mse);\n\n    compile.anova.r2adj = 1 - (compile.anova.mse / compile.anova.mst);\n    if (compile.anova.r2adj < 0) compile.anova.r2adj = 0;\n\n    compile.stats = new Array(jMatX[0].length);\n    var covar = jStat.xtranspxinv(jMatX);\n    var sds, ts, ps;\n\n    for(var i=0; i<beta.length;i++){\n      sds=Math.sqrt(compile.anova.mse * Math.abs(covar[i][i]));\n      ts= Math.abs(beta[i] / sds);\n      ps= jStat.ttest(ts, jMatY.length - jMatX[0].length - 1, sides);\n\n      compile.stats[i]=[beta[i], sds, ts, ps];\n    }\n\n    compile.regress = beta;\n    return compile;\n  },\n\n  xtranspx: function xtranspx(jMatX){\n    return jStat.matrixmult(jMatX.transpose(),jMatX);\n  },\n\n\n  xtranspxinv: function xtranspxinv(jMatX){\n    var inner = jStat.matrixmult(jMatX.transpose(),jMatX);\n    var innerinv = jStat.inv(inner);\n    return innerinv;\n  },\n\n  jMatYBar: function jMatYBar(jMatX, beta) {\n    var yBar = jStat.matrixmult(jMatX, beta);\n    return new jStat(yBar);\n  },\n\n  residuals: function residuals(jMatY, jMatYBar) {\n    return jStat.matrixsubtract(jMatY, jMatYBar);\n  },\n\n  ssr: function ssr(jMatYBar, yAverage) {\n    var ssr = 0;\n    for(var i = 0; i < jMatYBar.length; i++) {\n      ssr += Math.pow(jMatYBar[i] - yAverage, 2);\n    }\n    return ssr;\n  },\n\n  sse: function sse(jMatY, jMatYBar) {\n    var sse = 0;\n    for(var i = 0; i < jMatY.length; i++) {\n      sse += Math.pow(jMatY[i] - jMatYBar[i], 2);\n    }\n    return sse;\n  },\n\n  sst: function sst(jMatY, yAverage) {\n    var sst = 0;\n    for(var i = 0; i < jMatY.length; i++) {\n      sst += Math.pow(jMatY[i] - yAverage, 2);\n    }\n    return sst;\n  },\n\n  matrixsubtract: function matrixsubtract(A,B){\n    var ans = new Array(A.length);\n    for(var i=0;i<A.length;i++){\n      ans[i] = new Array(A[i].length);\n      for(var j=0;j<A[i].length;j++){\n        ans[i][j]=A[i][j]-B[i][j];\n      }\n    }\n    return jStat(ans);\n  }\n});\n  // Make it compatible with previous version.\n  jStat.jStat = jStat;\n\n  return jStat;\n});\n","import * as error from './utils/error.js'\nimport * as utils from './utils/common.js'\n\n// TODO\nexport function ASC() {\n  throw new Error('ASC is not implemented')\n}\n\n// TODO\nexport function BAHTTEXT() {\n  throw new Error('BAHTTEXT is not implemented')\n}\n\nexport function CHAR(number) {\n  number = utils.parseNumber(number)\n\n  if (number === 0) {\n    return error.value\n  }\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return String.fromCharCode(number)\n}\n\nexport function CLEAN(text) {\n  if (utils.anyIsError(text)) {\n    return text\n  }\n\n  text = text || ''\n  const re = /[\\0-\\x1F]/g\n\n  return text.replace(re, '')\n}\n\nexport function CODE(text) {\n  if (utils.anyIsError(text)) {\n    return text\n  }\n\n  text = text || ''\n  let result = text.charCodeAt(0)\n\n  if (isNaN(result)) {\n    result = error.value\n  }\n\n  return result\n}\n\nexport function CONCATENATE() {\n  const args = utils.flatten(arguments)\n  const someError = utils.anyError.apply(undefined, args)\n\n  if (someError) {\n    return someError\n  }\n\n  let trueFound = 0\n\n  while ((trueFound = args.indexOf(true)) > -1) {\n    args[trueFound] = 'TRUE'\n  }\n\n  let falseFound = 0\n\n  while ((falseFound = args.indexOf(false)) > -1) {\n    args[falseFound] = 'FALSE'\n  }\n\n  return args.join('')\n}\n\nexport const CONCAT = CONCATENATE\n\n// TODO\nexport function DBCS() {\n  throw new Error('DBCS is not implemented')\n}\n\n// TODO\nexport function DOLLAR() {\n  throw new Error('DOLLAR is not implemented')\n}\n\nexport function EXACT(text1, text2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  const someError = utils.anyError(text1, text2)\n\n  if (someError) {\n    return someError\n  }\n\n  text1 = utils.parseString(text1)\n  text2 = utils.parseString(text2)\n\n  return text1 === text2\n}\n\nexport function FIND(find_text, within_text, position) {\n  if (arguments.length < 2) {\n    return error.na\n  }\n\n  find_text = utils.parseString(find_text)\n  within_text = utils.parseString(within_text)\n  position = position === undefined ? 0 : position\n  const found_index = within_text.indexOf(find_text, position - 1)\n\n  if (found_index === -1) {\n    return error.value\n  }\n\n  return found_index + 1\n}\n\n// TODO\nexport function FIXED() {\n  throw new Error('FIXED is not implemented')\n}\n\nexport function HTML2TEXT(value) {\n  if (utils.anyIsError(value)) {\n    return value\n  }\n\n  let result = ''\n\n  if (value) {\n    if (value instanceof Array) {\n      value.forEach((line) => {\n        if (result !== '') {\n          result += '\\n'\n        }\n\n        result += line.replace(/<(?:.|\\n)*?>/gm, '')\n      })\n    } else {\n      result = value.replace(/<(?:.|\\n)*?>/gm, '')\n    }\n  }\n\n  return result\n}\n\nexport function LEFT(text, number) {\n  const someError = utils.anyError(text, number)\n\n  if (someError) {\n    return someError\n  }\n\n  text = utils.parseString(text)\n  number = number === undefined ? 1 : number\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error || typeof text !== 'string') {\n    return error.value\n  }\n\n  return text.substring(0, number)\n}\n\nexport function LEN(text) {\n  if (arguments.length === 0) {\n    return error.error\n  }\n\n  if (text instanceof Error) {\n    return text\n  }\n\n  if (Array.isArray(text)) {\n    return error.value\n  }\n\n  const textAsString = utils.parseString(text)\n\n  return textAsString.length\n}\n\nexport function LOWER(text) {\n  if (arguments.length !== 1) {\n    return error.value\n  }\n\n  text = utils.parseString(text)\n\n  if (utils.anyIsError(text)) {\n    return text\n  }\n\n  return text.toLowerCase()\n}\n\nexport function MID(text, start, number) {\n  if (start === undefined || start === null) {\n    return error.value\n  }\n\n  start = utils.parseNumber(start)\n  number = utils.parseNumber(number)\n\n  if (utils.anyIsError(start, number) || typeof text !== 'string') {\n    return number\n  }\n\n  const begin = start - 1\n  const end = begin + number\n\n  return text.substring(begin, end)\n}\n\n// TODO\nexport function NUMBERVALUE(text, decimal_separator, group_separator) {\n  decimal_separator = typeof decimal_separator === 'undefined' ? '.' : decimal_separator\n  group_separator = typeof group_separator === 'undefined' ? ',' : group_separator\n\n  return Number(text.replace(decimal_separator, '.').replace(group_separator, ''))\n}\n\n// TODO\nexport function PRONETIC() {\n  throw new Error('PRONETIC is not implemented')\n}\n\nexport function PROPER(text) {\n  if (utils.anyIsError(text)) {\n    return text\n  }\n\n  if (isNaN(text) && typeof text === 'number') {\n    return error.value\n  }\n\n  text = utils.parseString(text)\n\n  return text.replace(/\\w\\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase())\n}\n\nexport function REGEXEXTRACT(text, regular_expression) {\n  if (arguments.length < 2) {\n    return error.na\n  }\n\n  const match = text.match(new RegExp(regular_expression))\n\n  return match ? match[match.length > 1 ? match.length - 1 : 0] : null\n}\n\nexport function REGEXMATCH(text, regular_expression, full) {\n  if (arguments.length < 2) {\n    return error.na\n  }\n\n  const match = text.match(new RegExp(regular_expression))\n\n  return full ? match : !!match\n}\n\nexport function REGEXREPLACE(text, regular_expression, replacement) {\n  if (arguments.length < 3) {\n    return error.na\n  }\n\n  return text.replace(new RegExp(regular_expression), replacement)\n}\n\nexport function REPLACE(text, position, length, new_text) {\n  position = utils.parseNumber(position)\n  length = utils.parseNumber(length)\n\n  if (utils.anyIsError(position, length) || typeof text !== 'string' || typeof new_text !== 'string') {\n    return error.value\n  }\n\n  return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length)\n}\n\nexport function REPT(text, number) {\n  const someError = utils.anyError(text, number)\n\n  if (someError) {\n    return someError\n  }\n\n  text = utils.parseString(text)\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return new Array(number + 1).join(text)\n}\n\nexport function RIGHT(text, number) {\n  const someError = utils.anyError(text, number)\n\n  if (someError) {\n    return someError\n  }\n\n  text = utils.parseString(text)\n  number = number === undefined ? 1 : number\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return text.substring(text.length - number)\n}\n\nexport function SEARCH(find_text, within_text, position) {\n  let foundAt\n\n  if (typeof find_text !== 'string' || typeof within_text !== 'string') {\n    return error.value\n  }\n\n  position = position === undefined ? 0 : position\n  foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1) + 1\n\n  return foundAt === 0 ? error.value : foundAt\n}\n\nexport function SPLIT(text, separator) {\n  return text.split(separator)\n}\n\nexport function SUBSTITUTE(text, old_text, new_text, occurrence) {\n  if (arguments.length < 3) {\n    return error.na\n  }\n\n  if (!text || !old_text) {\n    return text\n  } else if (occurrence === undefined) {\n    return text.split(old_text).join(new_text)\n  } else {\n    occurrence = Math.floor(Number(occurrence))\n\n    if (Number.isNaN(occurrence) || occurrence <= 0) {\n      return error.value\n    }\n\n    let index = 0\n    let i = 0\n\n    while (index > -1 && text.indexOf(old_text, index) > -1) {\n      index = text.indexOf(old_text, index + 1)\n      i++\n\n      if (index > -1 && i === occurrence) {\n        return text.substring(0, index) + new_text + text.substring(index + old_text.length)\n      }\n    }\n\n    return text\n  }\n}\n\nexport function T(value) {\n  if (value instanceof Error) {\n    return value\n  }\n\n  return typeof value === 'string' ? value : ''\n}\n\n// TODO incomplete implementation\nexport function TEXT() {\n  throw new Error('TEXT is not implemented')\n}\n\nexport function TEXTJOIN(delimiter, ignore_empty, ...args) {\n  if (typeof ignore_empty !== 'boolean') {\n    ignore_empty = utils.parseBool(ignore_empty)\n  }\n\n  if (arguments.length < 3) {\n    return error.na\n  }\n\n  delimiter = delimiter !== null && delimiter !== undefined ? delimiter : ''\n\n  let flatArgs = utils.flatten(args)\n  let textToJoin = ignore_empty ? flatArgs.filter((text) => text) : flatArgs\n\n  if (Array.isArray(delimiter)) {\n    delimiter = utils.flatten(delimiter)\n\n    let chunks = textToJoin.map((item) => [item])\n    let index = 0\n\n    for (let i = 0; i < chunks.length - 1; i++) {\n      chunks[i].push(delimiter[index])\n      index++\n\n      if (index === delimiter.length) {\n        index = 0\n      }\n    }\n\n    textToJoin = utils.flatten(chunks)\n\n    return textToJoin.join('')\n  }\n\n  return textToJoin.join(delimiter)\n}\n\nexport function TRIM(text) {\n  text = utils.parseString(text)\n\n  if (text instanceof Error) {\n    return text\n  }\n\n  return text.replace(/\\s+/g, ' ').trim()\n}\n\nexport const UNICHAR = CHAR\n\nexport const UNICODE = CODE\n\nexport function UPPER(text) {\n  text = utils.parseString(text)\n\n  if (text instanceof Error) {\n    return text\n  }\n\n  return text.toUpperCase()\n}\n\nexport function VALUE(num) {\n  const anyError = utils.anyError(num)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (typeof num === 'number') {\n    return num\n  }\n\n  if (typeof num !== 'string') {\n    return error.value\n  }\n\n  const isPercent = /(%)$/.test(num) || /^(%)/.test(num)\n  num = num.replace(/^[^0-9-]{0,3}/, '')\n  num = num.replace(/[^0-9]{0,3}$/, '')\n  num = num.replace(/[ ,]/g, '')\n\n  if (num === '') {\n    return error.value\n  }\n\n  let output = Number(num)\n\n  if (isNaN(output)) {\n    return error.value\n  }\n\n  output = output || 0\n\n  if (isPercent) {\n    output = output * 0.01\n  }\n\n  return output\n}\n","import bessel from 'bessel'\nimport jStat from 'jstat'\n\nimport * as error from './utils/error.js'\nimport * as text from './text.js'\nimport * as utils from './utils/common.js'\n\nfunction isValidBinaryNumber(number) {\n  return /^[01]{1,10}$/.test(number)\n}\n\nexport function BESSELI(x, n) {\n  x = utils.parseNumber(x)\n  n = utils.parseNumber(n)\n\n  if (utils.anyIsError(x, n)) {\n    return error.value\n  }\n\n  return bessel.besseli(x, n)\n}\n\nexport function BESSELJ(x, n) {\n  x = utils.parseNumber(x)\n  n = utils.parseNumber(n)\n\n  if (utils.anyIsError(x, n)) {\n    return error.value\n  }\n\n  return bessel.besselj(x, n)\n}\n\nexport function BESSELK(x, n) {\n  x = utils.parseNumber(x)\n  n = utils.parseNumber(n)\n\n  if (utils.anyIsError(x, n)) {\n    return error.value\n  }\n\n  return bessel.besselk(x, n)\n}\n\nexport function BESSELY(x, n) {\n  x = utils.parseNumber(x)\n  n = utils.parseNumber(n)\n\n  if (utils.anyIsError(x, n)) {\n    return error.value\n  }\n\n  return bessel.bessely(x, n)\n}\n\nexport function BIN2DEC(number) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num\n  }\n\n  // Convert binary number to decimal\n  const result = parseInt(number, 2)\n\n  // Handle negative numbers\n  const stringified = number.toString()\n\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return parseInt(stringified.substring(1), 2) - 512\n  } else {\n    return result\n  }\n}\n\nexport function BIN2HEX(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  const stringified = number.toString()\n\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16)\n  }\n\n  // Convert binary number to hexadecimal\n  const result = parseInt(number, 2).toString(16)\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function BIN2OCT(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  const stringified = number.toString()\n\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8)\n  }\n\n  // Convert binary number to octal\n  const result = parseInt(number, 2).toString(8)\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function BITAND(number1, number2) {\n  // Return error if either number is a non-numeric value\n  number1 = utils.parseNumber(number1)\n  number2 = utils.parseNumber(number2)\n\n  if (utils.anyIsError(number1, number2)) {\n    return error.value\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num\n  }\n\n  // Return bitwise AND of two numbers\n  return number1 & number2\n}\n\nexport function BITLSHIFT(number, shift) {\n  number = utils.parseNumber(number)\n  shift = utils.parseNumber(shift)\n\n  if (utils.anyIsError(number, shift)) {\n    return error.value\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num\n  }\n\n  // Return number shifted by shift bits to the left or to the right if shift is negative\n  return shift >= 0 ? number << shift : number >> -shift\n}\n\nexport function BITOR(number1, number2) {\n  number1 = utils.parseNumber(number1)\n  number2 = utils.parseNumber(number2)\n\n  if (utils.anyIsError(number1, number2)) {\n    return error.value\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num\n  }\n\n  // Return bitwise OR of two numbers\n  return number1 | number2\n}\n\nexport function BITRSHIFT(number, shift) {\n  number = utils.parseNumber(number)\n  shift = utils.parseNumber(shift)\n\n  if (utils.anyIsError(number, shift)) {\n    return error.value\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num\n  }\n\n  // Return number shifted by shift bits to the right or to the left if shift is negative\n  return shift >= 0 ? number >> shift : number << -shift\n}\n\nexport function BITXOR(number1, number2) {\n  number1 = utils.parseNumber(number1)\n  number2 = utils.parseNumber(number2)\n\n  if (utils.anyIsError(number1, number2)) {\n    return error.value\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num\n  }\n\n  // Return bitwise XOR of two numbers\n  return number1 ^ number2\n}\n\nexport function COMPLEX(real, imaginary, suffix) {\n  real = utils.parseNumber(real)\n  imaginary = utils.parseNumber(imaginary)\n\n  if (utils.anyIsError(real, imaginary)) {\n    return real\n  }\n\n  // Set suffix\n  suffix = suffix === undefined ? 'i' : suffix\n\n  // Return error if suffix is neither \"i\" nor \"j\"\n  if (suffix !== 'i' && suffix !== 'j') {\n    return error.value\n  }\n\n  // Return complex number\n  if (real === 0 && imaginary === 0) {\n    return 0\n  } else if (real === 0) {\n    return imaginary === 1 ? suffix : imaginary.toString() + suffix\n  } else if (imaginary === 0) {\n    return real.toString()\n  } else {\n    const sign = imaginary > 0 ? '+' : ''\n    return real.toString() + sign + (imaginary === 1 ? suffix : imaginary.toString() + suffix)\n  }\n}\n\nexport function CONVERT(number, from_unit, to_unit) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  // List of units supported by CONVERT and units defined by the International System of Units\n  // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion ratio]\n  const units = [\n    ['a.u. of action', '?', null, 'action', false, false, 1.05457168181818e-34],\n    ['a.u. of charge', 'e', null, 'electric_charge', false, false, 1.60217653141414e-19],\n    ['a.u. of energy', 'Eh', null, 'energy', false, false, 4.35974417757576e-18],\n    ['a.u. of length', 'a?', null, 'length', false, false, 5.29177210818182e-11],\n    ['a.u. of mass', 'm?', null, 'mass', false, false, 9.10938261616162e-31],\n    ['a.u. of time', '?/Eh', null, 'time', false, false, 2.41888432650516e-17],\n    ['admiralty knot', 'admkn', null, 'speed', false, true, 0.514773333],\n    ['ampere', 'A', null, 'electric_current', true, false, 1],\n    ['ampere per meter', 'A/m', null, 'magnetic_field_intensity', true, false, 1],\n    ['ångström', 'Å', ['ang'], 'length', false, true, 1e-10],\n    ['are', 'ar', null, 'area', false, true, 100],\n    ['astronomical unit', 'ua', null, 'length', false, false, 1.49597870691667e-11],\n    ['bar', 'bar', null, 'pressure', false, false, 100000],\n    ['barn', 'b', null, 'area', false, false, 1e-28],\n    ['becquerel', 'Bq', null, 'radioactivity', true, false, 1],\n    ['bit', 'bit', ['b'], 'information', false, true, 1],\n    ['btu', 'BTU', ['btu'], 'energy', false, true, 1055.05585262],\n    ['byte', 'byte', null, 'information', false, true, 8],\n    ['candela', 'cd', null, 'luminous_intensity', true, false, 1],\n    ['candela per square metre', 'cd/m?', null, 'luminance', true, false, 1],\n    ['coulomb', 'C', null, 'electric_charge', true, false, 1],\n    ['cubic ångström', 'ang3', ['ang^3'], 'volume', false, true, 1e-30],\n    ['cubic foot', 'ft3', ['ft^3'], 'volume', false, true, 0.028316846592],\n    ['cubic inch', 'in3', ['in^3'], 'volume', false, true, 0.000016387064],\n    ['cubic light-year', 'ly3', ['ly^3'], 'volume', false, true, 8.46786664623715e-47],\n    ['cubic metre', 'm?', null, 'volume', true, true, 1],\n    ['cubic mile', 'mi3', ['mi^3'], 'volume', false, true, 4168181825.44058],\n    ['cubic nautical mile', 'Nmi3', ['Nmi^3'], 'volume', false, true, 6352182208],\n    ['cubic Pica', 'Pica3', ['Picapt3', 'Pica^3', 'Picapt^3'], 'volume', false, true, 7.58660370370369e-8],\n    ['cubic yard', 'yd3', ['yd^3'], 'volume', false, true, 0.764554857984],\n    ['cup', 'cup', null, 'volume', false, true, 0.0002365882365],\n    ['dalton', 'Da', ['u'], 'mass', false, false, 1.66053886282828e-27],\n    ['day', 'd', ['day'], 'time', false, true, 86400],\n    ['degree', '°', null, 'angle', false, false, 0.0174532925199433],\n    ['degrees Rankine', 'Rank', null, 'temperature', false, true, 0.555555555555556],\n    ['dyne', 'dyn', ['dy'], 'force', false, true, 0.00001],\n    ['electronvolt', 'eV', ['ev'], 'energy', false, true, 1.60217656514141],\n    ['ell', 'ell', null, 'length', false, true, 1.143],\n    ['erg', 'erg', ['e'], 'energy', false, true, 1e-7],\n    ['farad', 'F', null, 'electric_capacitance', true, false, 1],\n    ['fluid ounce', 'oz', null, 'volume', false, true, 0.0000295735295625],\n    ['foot', 'ft', null, 'length', false, true, 0.3048],\n    ['foot-pound', 'flb', null, 'energy', false, true, 1.3558179483314],\n    ['gal', 'Gal', null, 'acceleration', false, false, 0.01],\n    ['gallon', 'gal', null, 'volume', false, true, 0.003785411784],\n    ['gauss', 'G', ['ga'], 'magnetic_flux_density', false, true, 1],\n    ['grain', 'grain', null, 'mass', false, true, 0.0000647989],\n    ['gram', 'g', null, 'mass', false, true, 0.001],\n    ['gray', 'Gy', null, 'absorbed_dose', true, false, 1],\n    ['gross registered ton', 'GRT', ['regton'], 'volume', false, true, 2.8316846592],\n    ['hectare', 'ha', null, 'area', false, true, 10000],\n    ['henry', 'H', null, 'inductance', true, false, 1],\n    ['hertz', 'Hz', null, 'frequency', true, false, 1],\n    ['horsepower', 'HP', ['h'], 'power', false, true, 745.69987158227],\n    ['horsepower-hour', 'HPh', ['hh', 'hph'], 'energy', false, true, 2684519.538],\n    ['hour', 'h', ['hr'], 'time', false, true, 3600],\n    ['imperial gallon (U.K.)', 'uk_gal', null, 'volume', false, true, 0.00454609],\n    ['imperial hundredweight', 'lcwt', ['uk_cwt', 'hweight'], 'mass', false, true, 50.802345],\n    ['imperial quart (U.K)', 'uk_qt', null, 'volume', false, true, 0.0011365225],\n    ['imperial ton', 'brton', ['uk_ton', 'LTON'], 'mass', false, true, 1016.046909],\n    ['inch', 'in', null, 'length', false, true, 0.0254],\n    ['international acre', 'uk_acre', null, 'area', false, true, 4046.8564224],\n    ['IT calorie', 'cal', null, 'energy', false, true, 4.1868],\n    ['joule', 'J', null, 'energy', true, true, 1],\n    ['katal', 'kat', null, 'catalytic_activity', true, false, 1],\n    ['kelvin', 'K', ['kel'], 'temperature', true, true, 1],\n    ['kilogram', 'kg', null, 'mass', true, true, 1],\n    ['knot', 'kn', null, 'speed', false, true, 0.514444444444444],\n    ['light-year', 'ly', null, 'length', false, true, 9460730472580800],\n    ['litre', 'L', ['l', 'lt'], 'volume', false, true, 0.001],\n    ['lumen', 'lm', null, 'luminous_flux', true, false, 1],\n    ['lux', 'lx', null, 'illuminance', true, false, 1],\n    ['maxwell', 'Mx', null, 'magnetic_flux', false, false, 1e-18],\n    ['measurement ton', 'MTON', null, 'volume', false, true, 1.13267386368],\n    ['meter per hour', 'm/h', ['m/hr'], 'speed', false, true, 0.00027777777777778],\n    ['meter per second', 'm/s', ['m/sec'], 'speed', true, true, 1],\n    ['meter per second squared', 'm?s??', null, 'acceleration', true, false, 1],\n    ['parsec', 'pc', ['parsec'], 'length', false, true, 30856775814671900],\n    ['meter squared per second', 'm?/s', null, 'kinematic_viscosity', true, false, 1],\n    ['metre', 'm', null, 'length', true, true, 1],\n    ['miles per hour', 'mph', null, 'speed', false, true, 0.44704],\n    ['millimetre of mercury', 'mmHg', null, 'pressure', false, false, 133.322],\n    ['minute', '?', null, 'angle', false, false, 0.000290888208665722],\n    ['minute', 'min', ['mn'], 'time', false, true, 60],\n    ['modern teaspoon', 'tspm', null, 'volume', false, true, 0.000005],\n    ['mole', 'mol', null, 'amount_of_substance', true, false, 1],\n    ['morgen', 'Morgen', null, 'area', false, true, 2500],\n    ['n.u. of action', '?', null, 'action', false, false, 1.05457168181818e-34],\n    ['n.u. of mass', 'm?', null, 'mass', false, false, 9.10938261616162e-31],\n    ['n.u. of speed', 'c?', null, 'speed', false, false, 299792458],\n    ['n.u. of time', '?/(me?c??)', null, 'time', false, false, 1.28808866778687e-21],\n    ['nautical mile', 'M', ['Nmi'], 'length', false, true, 1852],\n    ['newton', 'N', null, 'force', true, true, 1],\n    ['œrsted', 'Oe ', null, 'magnetic_field_intensity', false, false, 79.5774715459477],\n    ['ohm', 'Ω', null, 'electric_resistance', true, false, 1],\n    ['ounce mass', 'ozm', null, 'mass', false, true, 0.028349523125],\n    ['pascal', 'Pa', null, 'pressure', true, false, 1],\n    ['pascal second', 'Pa?s', null, 'dynamic_viscosity', true, false, 1],\n    ['pferdestärke', 'PS', null, 'power', false, true, 735.49875],\n    ['phot', 'ph', null, 'illuminance', false, false, 0.0001],\n    ['pica (1/6 inch)', 'pica', null, 'length', false, true, 0.00035277777777778],\n    ['pica (1/72 inch)', 'Pica', ['Picapt'], 'length', false, true, 0.00423333333333333],\n    ['poise', 'P', null, 'dynamic_viscosity', false, false, 0.1],\n    ['pond', 'pond', null, 'force', false, true, 0.00980665],\n    ['pound force', 'lbf', null, 'force', false, true, 4.4482216152605],\n    ['pound mass', 'lbm', null, 'mass', false, true, 0.45359237],\n    ['quart', 'qt', null, 'volume', false, true, 0.000946352946],\n    ['radian', 'rad', null, 'angle', true, false, 1],\n    ['second', '?', null, 'angle', false, false, 0.00000484813681109536],\n    ['second', 's', ['sec'], 'time', true, true, 1],\n    ['short hundredweight', 'cwt', ['shweight'], 'mass', false, true, 45.359237],\n    ['siemens', 'S', null, 'electrical_conductance', true, false, 1],\n    ['sievert', 'Sv', null, 'equivalent_dose', true, false, 1],\n    ['slug', 'sg', null, 'mass', false, true, 14.59390294],\n    ['square ångström', 'ang2', ['ang^2'], 'area', false, true, 1e-20],\n    ['square foot', 'ft2', ['ft^2'], 'area', false, true, 0.09290304],\n    ['square inch', 'in2', ['in^2'], 'area', false, true, 0.00064516],\n    ['square light-year', 'ly2', ['ly^2'], 'area', false, true, 8.95054210748189e31],\n    ['square meter', 'm?', null, 'area', true, true, 1],\n    ['square mile', 'mi2', ['mi^2'], 'area', false, true, 2589988.110336],\n    ['square nautical mile', 'Nmi2', ['Nmi^2'], 'area', false, true, 3429904],\n    ['square Pica', 'Pica2', ['Picapt2', 'Pica^2', 'Picapt^2'], 'area', false, true, 0.00001792111111111],\n    ['square yard', 'yd2', ['yd^2'], 'area', false, true, 0.83612736],\n    ['statute mile', 'mi', null, 'length', false, true, 1609.344],\n    ['steradian', 'sr', null, 'solid_angle', true, false, 1],\n    ['stilb', 'sb', null, 'luminance', false, false, 0.0001],\n    ['stokes', 'St', null, 'kinematic_viscosity', false, false, 0.0001],\n    ['stone', 'stone', null, 'mass', false, true, 6.35029318],\n    ['tablespoon', 'tbs', null, 'volume', false, true, 0.0000147868],\n    ['teaspoon', 'tsp', null, 'volume', false, true, 0.00000492892],\n    ['tesla', 'T', null, 'magnetic_flux_density', true, true, 1],\n    ['thermodynamic calorie', 'c', null, 'energy', false, true, 4.184],\n    ['ton', 'ton', null, 'mass', false, true, 907.18474],\n    ['tonne', 't', null, 'mass', false, false, 1000],\n    ['U.K. pint', 'uk_pt', null, 'volume', false, true, 0.00056826125],\n    ['U.S. bushel', 'bushel', null, 'volume', false, true, 0.03523907],\n    ['U.S. oil barrel', 'barrel', null, 'volume', false, true, 0.158987295],\n    ['U.S. pint', 'pt', ['us_pt'], 'volume', false, true, 0.000473176473],\n    ['U.S. survey mile', 'survey_mi', null, 'length', false, true, 1609.347219],\n    ['U.S. survey/statute acre', 'us_acre', null, 'area', false, true, 4046.87261],\n    ['volt', 'V', null, 'voltage', true, false, 1],\n    ['watt', 'W', null, 'power', true, true, 1],\n    ['watt-hour', 'Wh', ['wh'], 'energy', false, true, 3600],\n    ['weber', 'Wb', null, 'magnetic_flux', true, false, 1],\n    ['yard', 'yd', null, 'length', false, true, 0.9144],\n    ['year', 'yr', null, 'time', false, true, 31557600]\n  ]\n\n  // Binary prefixes\n  // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived from]\n  const binary_prefixes = {\n    Yi: ['yobi', 80, 1208925819614629174706176, 'Yi', 'yotta'],\n    Zi: ['zebi', 70, 1180591620717411303424, 'Zi', 'zetta'],\n    Ei: ['exbi', 60, 1152921504606846976, 'Ei', 'exa'],\n    Pi: ['pebi', 50, 1125899906842624, 'Pi', 'peta'],\n    Ti: ['tebi', 40, 1099511627776, 'Ti', 'tera'],\n    Gi: ['gibi', 30, 1073741824, 'Gi', 'giga'],\n    Mi: ['mebi', 20, 1048576, 'Mi', 'mega'],\n    ki: ['kibi', 10, 1024, 'ki', 'kilo']\n  }\n\n  // Unit prefixes\n  // [Name, Multiplier, Abbreviation]\n  const unit_prefixes = {\n    Y: ['yotta', 1e24, 'Y'],\n    Z: ['zetta', 1e21, 'Z'],\n    E: ['exa', 1e18, 'E'],\n    P: ['peta', 1e15, 'P'],\n    T: ['tera', 1e12, 'T'],\n    G: ['giga', 1e9, 'G'],\n    M: ['mega', 1e6, 'M'],\n    k: ['kilo', 1e3, 'k'],\n    h: ['hecto', 1e2, 'h'],\n    e: ['dekao', 1e1, 'e'],\n    d: ['deci', 1e-1, 'd'],\n    c: ['centi', 1e-2, 'c'],\n    m: ['milli', 1e-3, 'm'],\n    u: ['micro', 1e-6, 'u'],\n    n: ['nano', 1e-9, 'n'],\n    p: ['pico', 1e-12, 'p'],\n    f: ['femto', 1e-15, 'f'],\n    a: ['atto', 1e-18, 'a'],\n    z: ['zepto', 1e-21, 'z'],\n    y: ['yocto', 1e-24, 'y']\n  }\n\n  // Initialize units and multipliers\n  let from = null\n  let to = null\n  let base_from_unit = from_unit\n  let base_to_unit = to_unit\n  let from_multiplier = 1\n  let to_multiplier = 1\n  let alt\n\n  // Lookup from and to units\n  for (let i = 0; i < units.length; i++) {\n    alt = units[i][2] === null ? [] : units[i][2]\n\n    if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n      from = units[i]\n    }\n\n    if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n      to = units[i]\n    }\n  }\n\n  // Lookup from prefix\n  if (from === null) {\n    const from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)]\n    let from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)]\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (from_unit.substring(0, 2) === 'da') {\n      from_unit_prefix = ['dekao', 1e1, 'da']\n    }\n\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (from_binary_prefix) {\n      from_multiplier = from_binary_prefix[2]\n      base_from_unit = from_unit.substring(2)\n    } else if (from_unit_prefix) {\n      from_multiplier = from_unit_prefix[1]\n      base_from_unit = from_unit.substring(from_unit_prefix[2].length)\n    }\n\n    // Lookup from unit\n    for (let j = 0; j < units.length; j++) {\n      alt = units[j][2] === null ? [] : units[j][2]\n\n      if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n        from = units[j]\n      }\n    }\n  }\n\n  // Lookup to prefix\n  if (to === null) {\n    const to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)]\n    let to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)]\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (to_unit.substring(0, 2) === 'da') {\n      to_unit_prefix = ['dekao', 1e1, 'da']\n    }\n\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (to_binary_prefix) {\n      to_multiplier = to_binary_prefix[2]\n      base_to_unit = to_unit.substring(2)\n    } else if (to_unit_prefix) {\n      to_multiplier = to_unit_prefix[1]\n      base_to_unit = to_unit.substring(to_unit_prefix[2].length)\n    }\n\n    // Lookup to unit\n    for (let k = 0; k < units.length; k++) {\n      alt = units[k][2] === null ? [] : units[k][2]\n\n      if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n        to = units[k]\n      }\n    }\n  }\n\n  // Return error if a unit does not exist\n  if (from === null || to === null) {\n    return error.na\n  }\n\n  // Return error if units represent different quantities\n  if (from[3] !== to[3]) {\n    return error.na\n  }\n\n  // Return converted number\n  return (number * from[6] * from_multiplier) / (to[6] * to_multiplier)\n}\n\nexport function DEC2BIN(number, places) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  // Return error if number is not decimal, is lower than -512, or is greater than 511\n  if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (number < 0) {\n    return '1' + text.REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2)\n  }\n\n  // Convert decimal number to binary\n  const result = parseInt(number, 10).toString(2)\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function DEC2HEX(number, places) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  if (number < 0) {\n    return (1099511627776 + number).toString(16)\n  }\n\n  // Convert decimal number to hexadecimal\n  const result = parseInt(number, 10).toString(16)\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function DEC2OCT(number, places) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (number < 0) {\n    return (1073741824 + number).toString(8)\n  }\n\n  // Convert decimal number to octal\n  const result = parseInt(number, 10).toString(8)\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function DELTA(number1, number2) {\n  // Set number2 to zero if undefined\n  number2 = number2 === undefined ? 0 : number2\n  number1 = utils.parseNumber(number1)\n  number2 = utils.parseNumber(number2)\n\n  if (utils.anyIsError(number1, number2)) {\n    return error.value\n  }\n\n  // Return delta\n  return number1 === number2 ? 1 : 0\n}\n\n// TODO: why is upper_bound not used ? The excel documentation has no examples with upper_bound\nexport function ERF(lower_bound, upper_bound) {\n  // Set number2 to zero if undefined\n  upper_bound = upper_bound === undefined ? 0 : upper_bound\n\n  lower_bound = utils.parseNumber(lower_bound)\n  upper_bound = utils.parseNumber(upper_bound)\n\n  if (utils.anyIsError(lower_bound, upper_bound)) {\n    return error.value\n  }\n\n  return jStat.erf(lower_bound)\n}\n\n// TODO\nERF.PRECISE = () => {\n  throw new Error('ERF.PRECISE is not implemented')\n}\n\nexport function ERFC(x) {\n  // Return error if x is not a number\n  if (isNaN(x)) {\n    return error.value\n  }\n\n  return jStat.erfc(x)\n}\n\n// TODO\nERFC.PRECISE = () => {\n  throw new Error('ERFC.PRECISE is not implemented')\n}\n\nexport function GESTEP(number, step) {\n  step = step || 0\n  number = utils.parseNumber(number)\n\n  if (utils.anyIsError(step, number)) {\n    return number\n  }\n\n  // Return delta\n  return number >= step ? 1 : 0\n}\n\nexport function HEX2BIN(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num\n  }\n\n  // Check if number is negative\n  const negative = !!(number.length === 10 && number.substring(0, 1).toLowerCase() === 'f')\n\n  // Convert hexadecimal number to decimal\n  const decimal = negative ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16)\n\n  // Return error if number is lower than -512 or greater than 511\n  if (decimal < -512 || decimal > 511) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2)\n  }\n\n  // Convert decimal number to binary\n  const result = decimal.toString(2)\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function HEX2DEC(number) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num\n  }\n\n  // Convert hexadecimal number to decimal\n  const decimal = parseInt(number, 16)\n\n  // Return decimal number\n  return decimal >= 549755813888 ? decimal - 1099511627776 : decimal\n}\n\nexport function HEX2OCT(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num\n  }\n\n  // Convert hexadecimal number to decimal\n  const decimal = parseInt(number, 16)\n\n  // Return error if number is positive and greater than 0x1fffffff (536870911)\n  if (decimal > 536870911 && decimal < 1098974756864) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 1098974756864) {\n    return (decimal - 1098437885952).toString(8)\n  }\n\n  // Convert decimal number to octal\n  const result = decimal.toString(8)\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function IMABS(inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Return absolute value of complex number\n  return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2))\n}\n\nexport function IMAGINARY(inumber) {\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0\n  }\n\n  // Handle special cases\n  if (['i', 'j'].indexOf(inumber) >= 0) {\n    return 1\n  }\n\n  // Force string type\n  inumber = inumber + ''\n\n  // Normalize imaginary coefficient\n  inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j')\n\n  // Lookup sign\n  let plus = inumber.indexOf('+')\n  let minus = inumber.indexOf('-')\n\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1)\n  }\n\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1)\n  }\n\n  // Lookup imaginary unit\n  const last = inumber.substring(inumber.length - 1, inumber.length)\n  const unit = last === 'i' || last === 'j'\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num\n    }\n\n    // Return imaginary coefficient of complex number\n    if (plus >= 0) {\n      return isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))\n        ? error.num\n        : Number(inumber.substring(plus + 1, inumber.length - 1))\n    } else {\n      return isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))\n        ? error.num\n        : -Number(inumber.substring(minus + 1, inumber.length - 1))\n    }\n  } else {\n    if (unit) {\n      return isNaN(inumber.substring(0, inumber.length - 1)) ? error.num : inumber.substring(0, inumber.length - 1)\n    } else {\n      return isNaN(inumber) ? error.num : 0\n    }\n  }\n}\n\nexport function IMARGUMENT(inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Return error if inumber is equal to zero\n  if (x === 0 && y === 0) {\n    return error.div0\n  }\n\n  // Return PI/2 if x is equal to zero and y is positive\n  if (x === 0 && y > 0) {\n    return Math.PI / 2\n  }\n\n  // Return -PI/2 if x is equal to zero and y is negative\n  if (x === 0 && y < 0) {\n    return -Math.PI / 2\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x > 0) {\n    return 0\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x < 0) {\n    return -Math.PI\n  }\n\n  // Return argument of complex number\n  if (x > 0) {\n    return Math.atan(y / x)\n  } else if (x < 0 && y >= 0) {\n    return Math.atan(y / x) + Math.PI\n  } else {\n    return Math.atan(y / x) - Math.PI\n  }\n}\n\nexport function IMCONJUGATE(inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return conjugate of complex number\n  return y !== 0 ? COMPLEX(x, -y, unit) : inumber\n}\n\nexport function IMCOS(inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return cosine of complex number\n  return COMPLEX(\n    (Math.cos(x) * (Math.exp(y) + Math.exp(-y))) / 2,\n    (-Math.sin(x) * (Math.exp(y) - Math.exp(-y))) / 2,\n    unit\n  )\n}\n\nexport function IMCOSH(inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return hyperbolic cosine of complex number\n  return COMPLEX(\n    (Math.cos(y) * (Math.exp(x) + Math.exp(-x))) / 2,\n    (Math.sin(y) * (Math.exp(x) - Math.exp(-x))) / 2,\n    unit\n  )\n}\n\nexport function IMCOT(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Return cotangent of complex number\n  return IMDIV(IMCOS(inumber), IMSIN(inumber))\n}\n\nexport function IMDIV(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const a = IMREAL(inumber1)\n  const b = IMAGINARY(inumber1)\n  const c = IMREAL(inumber2)\n  const d = IMAGINARY(inumber2)\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  const unit1 = inumber1.substring(inumber1.length - 1)\n  const unit2 = inumber2.substring(inumber2.length - 1)\n  let unit = 'i'\n\n  if (unit1 === 'j') {\n    unit = 'j'\n  } else if (unit2 === 'j') {\n    unit = 'j'\n  }\n\n  // Return error if inumber2 is null\n  if (c === 0 && d === 0) {\n    return error.num\n  }\n\n  // Return exponential of complex number\n  const den = c * c + d * d\n  return COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit)\n}\n\nexport function IMEXP(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return exponential of complex number\n  const e = Math.exp(x)\n  return COMPLEX(e * Math.cos(y), e * Math.sin(y), unit)\n}\n\nexport function IMLN(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return exponential of complex number\n  return COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit)\n}\n\nexport function IMLOG10(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return exponential of complex number\n  return COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit)\n}\n\nexport function IMLOG2(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return exponential of complex number\n  return COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit)\n}\n\nexport function IMPOWER(inumber, number) {\n  number = utils.parseNumber(number)\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(number, x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Calculate power of modulus\n  const p = Math.pow(IMABS(inumber), number)\n\n  // Calculate argument\n  const t = IMARGUMENT(inumber)\n\n  // Return exponential of complex number\n  return COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit)\n}\n\nexport function IMPRODUCT() {\n  // Initialize result\n  let result = arguments[0]\n\n  if (!arguments.length) {\n    return error.value\n  }\n\n  // Loop on all numbers\n  for (let i = 1; i < arguments.length; i++) {\n    // Lookup coefficients of two complex numbers\n    const a = IMREAL(result)\n    const b = IMAGINARY(result)\n    const c = IMREAL(arguments[i])\n    const d = IMAGINARY(arguments[i])\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value\n    }\n\n    // Complute product of two complex numbers\n    result = COMPLEX(a * c - b * d, a * d + b * c)\n  }\n\n  // Return product of complex numbers\n  return result\n}\n\nexport function IMREAL(inumber) {\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0\n  }\n\n  // Handle special cases\n  if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\n    return 0\n  }\n\n  // Force String type\n  inumber = inumber + ''\n\n  // Lookup sign\n  let plus = inumber.indexOf('+')\n  let minus = inumber.indexOf('-')\n\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1)\n  }\n\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1)\n  }\n\n  // Lookup imaginary unit\n  const last = inumber.substring(inumber.length - 1, inumber.length)\n  const unit = last === 'i' || last === 'j'\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num\n    }\n\n    // Return real coefficient of complex number\n    if (plus >= 0) {\n      return isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))\n        ? error.num\n        : Number(inumber.substring(0, plus))\n    } else {\n      return isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))\n        ? error.num\n        : Number(inumber.substring(0, minus))\n    }\n  } else {\n    if (unit) {\n      return isNaN(inumber.substring(0, inumber.length - 1)) ? error.num : 0\n    } else {\n      return isNaN(inumber) ? error.num : inumber\n    }\n  }\n}\n\nexport function IMSEC(inumber) {\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Return secant of complex number\n  return IMDIV('1', IMCOS(inumber))\n}\n\nexport function IMSECH(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Return hyperbolic secant of complex number\n  return IMDIV('1', IMCOSH(inumber))\n}\n\nexport function IMSIN(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return sine of complex number\n  return COMPLEX(\n    (Math.sin(x) * (Math.exp(y) + Math.exp(-y))) / 2,\n    (Math.cos(x) * (Math.exp(y) - Math.exp(-y))) / 2,\n    unit\n  )\n}\n\nexport function IMSINH(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Return hyperbolic sine of complex number\n  return COMPLEX(\n    (Math.cos(y) * (Math.exp(x) - Math.exp(-x))) / 2,\n    (Math.sin(y) * (Math.exp(x) + Math.exp(-x))) / 2,\n    unit\n  )\n}\n\nexport function IMSQRT(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  let unit = inumber.substring(inumber.length - 1)\n  unit = unit === 'i' || unit === 'j' ? unit : 'i'\n\n  // Calculate power of modulus\n  const s = Math.sqrt(IMABS(inumber))\n\n  // Calculate argument\n  const t = IMARGUMENT(inumber)\n\n  // Return exponential of complex number\n  return COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit)\n}\n\nexport function IMCSC(inumber) {\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num\n  }\n\n  // Return cosecant of complex number\n  return IMDIV('1', IMSIN(inumber))\n}\n\nexport function IMCSCH(inumber) {\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num\n  }\n\n  // Return hyperbolic cosecant of complex number\n  return IMDIV('1', IMSINH(inumber))\n}\n\nexport function IMSUB(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const a = IMREAL(inumber1)\n  const b = IMAGINARY(inumber1)\n  const c = IMREAL(inumber2)\n  const d = IMAGINARY(inumber2)\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value\n  }\n\n  // Lookup imaginary unit\n  const unit1 = inumber1.substring(inumber1.length - 1)\n  const unit2 = inumber2.substring(inumber2.length - 1)\n  let unit = 'i'\n\n  if (unit1 === 'j') {\n    unit = 'j'\n  } else if (unit2 === 'j') {\n    unit = 'j'\n  }\n\n  // Return _ of two complex numbers\n  return COMPLEX(a - c, b - d, unit)\n}\n\nexport function IMSUM() {\n  if (!arguments.length) {\n    return error.value\n  }\n\n  const args = utils.flatten(arguments)\n\n  // Initialize result\n  let result = args[0]\n\n  // Loop on all numbers\n  for (let i = 1; i < args.length; i++) {\n    // Lookup coefficients of two complex numbers\n    const a = IMREAL(result)\n    const b = IMAGINARY(result)\n    const c = IMREAL(args[i])\n    const d = IMAGINARY(args[i])\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value\n    }\n\n    // Complute product of two complex numbers\n    result = COMPLEX(a + c, b + d)\n  }\n\n  // Return sum of complex numbers\n  return result\n}\n\nexport function IMTAN(inumber) {\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  const x = IMREAL(inumber)\n  const y = IMAGINARY(inumber)\n\n  if (utils.anyIsError(x, y)) {\n    return error.value\n  }\n\n  // Return tangent of complex number\n  return IMDIV(IMSIN(inumber), IMCOS(inumber))\n}\n\nexport function OCT2BIN(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num\n  }\n\n  // Check if number is negative\n  const negative = !!(number.length === 10 && number.substring(0, 1) === '7')\n\n  // Convert octal number to decimal\n  const decimal = negative ? parseInt(number, 8) - 1073741824 : parseInt(number, 8)\n\n  // Return error if number is lower than -512 or greater than 511\n  if (decimal < -512 || decimal > 511) {\n    return error.num\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2)\n  }\n\n  // Convert decimal number to binary\n  const result = decimal.toString(2)\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n\nexport function OCT2DEC(number) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num\n  }\n\n  // Convert octal number to decimal\n  const decimal = parseInt(number, 8)\n\n  // Return decimal number\n  return decimal >= 536870912 ? decimal - 1073741824 : decimal\n}\n\nexport function OCT2HEX(number, places) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num\n  }\n\n  // Convert octal number to decimal\n  const decimal = parseInt(number, 8)\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 536870912) {\n    return 'ff' + (decimal + 3221225472).toString(16)\n  }\n\n  // Convert decimal number to hexadecimal\n  const result = decimal.toString(16)\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places)\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return places >= result.length ? text.REPT('0', places - result.length) + result : error.num\n  }\n}\n","const defaultOperator = '='\nconst validSymbols = ['>', '>=', '<', '<=', '=', '<>']\nconst _TOKEN_TYPE_OPERATOR = 'operator'\nconst _TOKEN_TYPE_LITERAL = 'literal'\nconst SUPPORTED_TOKENS = [_TOKEN_TYPE_OPERATOR, _TOKEN_TYPE_LITERAL]\n\nexport const TOKEN_TYPE_OPERATOR = _TOKEN_TYPE_OPERATOR\nexport const TOKEN_TYPE_LITERAL = _TOKEN_TYPE_LITERAL\n\n/**\n * Create token which describe passed symbol/value.\n *\n * @param {String} value Value/Symbol to describe.\n * @param {String} type Type of the token 'operator' or 'literal'.\n * @\nreturn {Object}\n */\nexport function createToken(value, type) {\n  if (SUPPORTED_TOKENS.indexOf(type) === -1) {\n    throw new Error('Unsupported token type: ' + type)\n  }\n\n  return {\n    value: value,\n    type: type\n  }\n}\n\n/**\n * Tries to cast numeric values to their type passed as a string.\n *\n * @param {*} value\n * @\nreturn {*}\n */\nfunction castValueToCorrectType(value) {\n  if (typeof value !== 'string') {\n    return value\n  }\n\n  if (/^\\d+(\\.\\d+)?$/.test(value)) {\n    value = value.indexOf('.') === -1 ? parseInt(value, 10) : parseFloat(value)\n  }\n\n  return value\n}\n\n/**\n * Generate stream of tokens from passed expression.\n *\n * @param {String} expression\n * @\nreturn {String[]}\n */\nfunction tokenizeExpression(expression) {\n  const expressionLength = expression.length\n  const tokens = []\n  let cursorIndex = 0\n  let processedValue = ''\n  let processedSymbol = ''\n\n  while (cursorIndex < expressionLength) {\n    const char = expression.charAt(cursorIndex)\n\n    switch (char) {\n      case '>':\n      case '<':\n      case '=':\n        processedSymbol = processedSymbol + char\n\n        if (processedValue.length > 0) {\n          tokens.push(processedValue)\n          processedValue = ''\n        }\n\n        break\n      default:\n        if (processedSymbol.length > 0) {\n          tokens.push(processedSymbol)\n          processedSymbol = ''\n        }\n\n        processedValue = processedValue + char\n        break\n    }\n\n    cursorIndex++\n  }\n\n  if (processedValue.length > 0) {\n    tokens.push(processedValue)\n  }\n\n  if (processedSymbol.length > 0) {\n    tokens.push(processedSymbol)\n  }\n\n  return tokens\n}\n\n/**\n * Analyze and convert tokens to an object which describes their meaning.\n *\n * @param {String[]} tokens\n * @\nreturn {Object[]}\n */\nfunction analyzeTokens(tokens) {\n  let literalValue = ''\n  const analyzedTokens = []\n\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i]\n\n    if (i === 0 && validSymbols.indexOf(token) >= 0) {\n      analyzedTokens.push(createToken(token, TOKEN_TYPE_OPERATOR))\n    } else {\n      literalValue += token\n    }\n  }\n\n  if (literalValue.length > 0) {\n    analyzedTokens.push(createToken(castValueToCorrectType(literalValue), TOKEN_TYPE_LITERAL))\n  }\n\n  if (analyzedTokens.length > 0 && analyzedTokens[0].type !== TOKEN_TYPE_OPERATOR) {\n    analyzedTokens.unshift(createToken(defaultOperator, TOKEN_TYPE_OPERATOR))\n  }\n\n  return analyzedTokens\n}\n\n/**\n * Compute/Evaluate an expression passed as an array of tokens.\n *\n * @param {Object[]} tokens\n * @\nreturn {Boolean}\n */\nfunction computeExpression(tokens) {\n  const values = []\n  let operator\n\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i]\n\n    switch (token.type) {\n      case TOKEN_TYPE_OPERATOR:\n        operator = token.value\n        break\n      case TOKEN_TYPE_LITERAL:\n        values.push(token.value)\n        break\n    }\n  }\n\n  return evaluate(values, operator)\n}\n\n/**\n * Evaluate values based on passed math operator.\n *\n * @param {*} values\n * @param {String} operator\n * @\nreturn {Boolean}\n */\nfunction evaluate(values, operator) {\n  let result = false\n\n  switch (operator) {\n    case '>':\n      result = values[0] > values[1]\n      break\n    case '>=':\n      result = values[0] >= values[1]\n      break\n    case '<':\n      result = values[0] < values[1]\n      break\n    case '<=':\n      result = values[0] <= values[1]\n      break\n    case '=':\n      result = values[0] == values[1]\n      break\n    case '<>':\n      result = values[0] != values[1]\n      break\n  }\n\n  return result\n}\n\nexport function parse(expression) {\n  return analyzeTokens(tokenizeExpression(expression))\n}\n\nexport const compute = computeExpression\n","import * as error from './utils/error.js'\n\n// TODO\nexport function CELL() {\n  throw new Error('CELL is not implemented')\n}\n\nexport const ERROR = {}\n\nERROR.TYPE = (error_val) => {\n  switch (error_val) {\n    case error.nil:\n      return 1\n    case error.div0:\n      return 2\n    case error.value:\n      return 3\n    case error.ref:\n      return 4\n    case error.name:\n      return 5\n    case error.num:\n      return 6\n    case error.na:\n      return 7\n    case error.data:\n      return 8\n  }\n\n  return error.na\n}\n\n// TODO\nexport function INFO() {\n  throw new Error('INFO is not implemented')\n}\n\nexport function ISBLANK(value) {\n  return value === null\n}\n\nexport function ISBINARY(number) {\n  return /^[01]{1,10}$/.test(number)\n}\n\nexport function ISERR(value) {\n  return (\n    [error.value, error.ref, error.div0, error.num, error.name, error.nil].indexOf(value) >= 0 ||\n    (typeof value === 'number' && (isNaN(value) || !isFinite(value)))\n  )\n}\n\nexport function ISERROR(value) {\n  return ISERR(value) || value === error.na\n}\n\nexport function ISEVEN(number) {\n  return !(Math.floor(Math.abs(number)) & 1)\n}\n\n// TODO\nexport function ISFORMULA() {\n  throw new Error('ISFORMULA is not implemented')\n}\n\nexport function ISLOGICAL(value) {\n  return value === true || value === false\n}\n\nexport function ISNA(value) {\n  return value === error.na\n}\n\nexport function ISNONTEXT(value) {\n  return typeof value !== 'string'\n}\n\nexport function ISNUMBER(value) {\n  return typeof value === 'number' && !isNaN(value) && isFinite(value)\n}\n\nexport function ISODD(number) {\n  return !!(Math.floor(Math.abs(number)) & 1)\n}\n\n// TODO\nexport function ISREF() {\n  throw new Error('ISREF is not implemented')\n}\n\nexport function ISTEXT(value) {\n  return typeof value === 'string'\n}\n\nexport function N(value) {\n  if (ISNUMBER(value)) {\n    return value\n  }\n\n  if (value instanceof Date) {\n    return value.getTime()\n  }\n\n  if (value === true) {\n    return 1\n  }\n\n  if (value === false) {\n    return 0\n  }\n\n  if (ISERROR(value)) {\n    return value\n  }\n\n  return 0\n}\n\nexport function NA() {\n  return error.na\n}\n\n// TODO\nexport function SHEET() {\n  throw new Error('SHEET is not implemented')\n}\n\n// TODO\nexport function SHEETS() {\n  throw new Error('SHEETS is not implemented')\n}\n\nexport function TYPE(value) {\n  if (ISNUMBER(value)) {\n    return 1\n  }\n\n  if (ISTEXT(value)) {\n    return 2\n  }\n\n  if (ISLOGICAL(value)) {\n    return 4\n  }\n\n  if (ISERROR(value)) {\n    return 16\n  }\n\n  if (Array.isArray(value)) {\n    return 64\n  }\n}\n","import * as error from './utils/error.js'\nimport * as utils from './utils/common.js'\n\nexport function UNIQUE() {\n  const result = []\n\n  for (let i = 0; i < arguments.length; ++i) {\n    let hasElement = false\n    const element = arguments[i]\n\n    // Check if we've already seen this element.\n\n    for (let j = 0; j < result.length; ++j) {\n      hasElement = result[j] === element\n\n      if (hasElement) {\n        break\n      }\n    }\n\n    // If we did not find it, add it to the result.\n    if (!hasElement) {\n      result.push(element)\n    }\n  }\n\n  return result\n}\n\nexport const FLATTEN = utils.flatten\n\nexport function ARGS2ARRAY() {\n  return Array.prototype.slice.call(arguments, 0)\n}\n\nexport function REFERENCE(context, reference) {\n  if (!arguments.length) {\n    return error.error\n  }\n\n  try {\n    const path = reference.split('.')\n    let result = context\n\n    for (let i = 0; i < path.length; ++i) {\n      const step = path[i]\n\n      if (step[step.length - 1] === ']') {\n        const opening = step.indexOf('[')\n        const index = step.substring(opening + 1, step.length - 1)\n        result = result[step.substring(0, opening)][index]\n      } else {\n        result = result[step]\n      }\n    }\n\n    return result\n  } catch (error) {}\n}\n\nexport function JOIN(array, separator) {\n  return array.join(separator)\n}\n\nexport function NUMBERS() {\n  const possibleNumbers = utils.flatten(arguments)\n\n  return possibleNumbers.filter((el) => typeof el === 'number')\n}\n","import jStat from 'jstat'\n\nimport * as error from './utils/error.js'\nimport * as evalExpression from './utils/criteria-eval.js'\nimport * as mathTrig from './math-trig.js'\nimport * as misc from './miscellaneous.js'\nimport * as utils from './utils/common.js'\n\nconst SQRT2PI = 2.5066282746310002\n\nexport function AVEDEV() {\n  const flatArguments = utils.flatten(arguments)\n  const flatArgumentsDefined = flatArguments.filter(utils.isDefined)\n\n  if (flatArgumentsDefined.length === 0) {\n    return error.num\n  }\n\n  const range = utils.parseNumberArray(flatArgumentsDefined)\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  return jStat.sum(jStat(range).subtract(jStat.mean(range)).abs()[0]) / range.length\n}\n\nexport function AVERAGE() {\n  const flatArguments = utils.flatten(arguments)\n  const flatArgumentsDefined = flatArguments.filter(utils.isDefined)\n\n  if (flatArgumentsDefined.length === 0) {\n    return error.div0\n  }\n\n  const someError = utils.anyError.apply(undefined, flatArgumentsDefined)\n\n  if (someError) {\n    return someError\n  }\n\n  const range = utils.numbers(flatArgumentsDefined)\n  const n = range.length\n  let sum = 0\n  let count = 0\n  let result\n\n  for (let i = 0; i < n; i++) {\n    sum += range[i]\n    count += 1\n  }\n\n  result = sum / count\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function AVERAGEA() {\n  const flatArguments = utils.flatten(arguments)\n  const flatArgumentsDefined = flatArguments.filter(utils.isDefined)\n\n  if (flatArgumentsDefined.length === 0) {\n    return error.div0\n  }\n\n  const someError = utils.anyError.apply(undefined, flatArgumentsDefined)\n\n  if (someError) {\n    return someError\n  }\n\n  const range = flatArgumentsDefined\n  const n = range.length\n  let sum = 0\n  let count = 0\n  let result\n\n  for (let i = 0; i < n; i++) {\n    const el = range[i]\n\n    if (typeof el === 'number') {\n      sum += el\n    }\n\n    if (el === true) {\n      sum++\n    }\n\n    if (el !== null) {\n      count++\n    }\n  }\n\n  result = sum / count\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function AVERAGEIF(range, criteria, average_range) {\n  if (arguments.length <= 1) {\n    return error.na\n  }\n\n  average_range = average_range || range\n  const flatAverageRange = utils.flatten(average_range)\n  const flatAverageRangeDefined = flatAverageRange.filter(utils.isDefined)\n  average_range = utils.parseNumberArray(flatAverageRangeDefined)\n\n  range = utils.flatten(range)\n\n  if (average_range instanceof Error) {\n    return average_range\n  }\n\n  let average_count = 0\n  let result = 0\n  const isWildcard = criteria === void 0 || criteria === '*'\n  const tokenizedCriteria = isWildcard ? null : evalExpression.parse(criteria + '')\n\n  for (let i = 0; i < range.length; i++) {\n    const value = range[i]\n\n    if (isWildcard) {\n      result += average_range[i]\n      average_count++\n    } else {\n      const tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria)\n\n      if (evalExpression.compute(tokens)) {\n        result += average_range[i]\n        average_count++\n      }\n    }\n  }\n\n  return result / average_count\n}\n\nexport function AVERAGEIFS() {\n  // Does not work with multi dimensional ranges yet!\n  // http://office.microsoft.com/en-001/excel-help/averageifs-function-HA010047493.aspx\n  const args = utils.argsToArray(arguments)\n  const criteriaLength = (args.length - 1) / 2\n  const range = utils.flatten(args[0])\n  let count = 0\n  let result = 0\n\n  for (let i = 0; i < range.length; i++) {\n    let isMeetCondition = false\n\n    for (let j = 0; j < criteriaLength; j++) {\n      const value = args[2 * j + 1][i]\n      const criteria = args[2 * j + 2]\n      const isWildcard = criteria === void 0 || criteria === '*'\n      let computedResult = false\n\n      if (isWildcard) {\n        computedResult = true\n      } else {\n        const tokenizedCriteria = evalExpression.parse(criteria + '')\n        const tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria)\n\n        computedResult = evalExpression.compute(tokens)\n      }\n\n      // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition\n      if (!computedResult) {\n        isMeetCondition = false\n        break\n      }\n\n      isMeetCondition = true\n    }\n\n    if (isMeetCondition) {\n      result += range[i]\n      count++\n    }\n  }\n\n  const average = result / count\n\n  if (isNaN(average)) {\n    return 0\n  } else {\n    return average\n  }\n}\n\nexport const BETA = {}\n\nBETA.DIST = function (x, alpha, beta, cumulative, A, B) {\n  if (arguments.length < 4) {\n    return error.value\n  }\n\n  A = A === undefined ? 0 : A\n  B = B === undefined ? 1 : B\n\n  x = utils.parseNumber(x)\n  alpha = utils.parseNumber(alpha)\n  beta = utils.parseNumber(beta)\n  A = utils.parseNumber(A)\n  B = utils.parseNumber(B)\n\n  if (utils.anyIsError(x, alpha, beta, A, B)) {\n    return error.value\n  }\n\n  x = (x - A) / (B - A)\n\n  return cumulative ? jStat.beta.cdf(x, alpha, beta) : jStat.beta.pdf(x, alpha, beta)\n}\n\nBETA.INV = (probability, alpha, beta, A, B) => {\n  A = A === undefined ? 0 : A\n  B = B === undefined ? 1 : B\n\n  probability = utils.parseNumber(probability)\n  alpha = utils.parseNumber(alpha)\n  beta = utils.parseNumber(beta)\n  A = utils.parseNumber(A)\n  B = utils.parseNumber(B)\n\n  if (utils.anyIsError(probability, alpha, beta, A, B)) {\n    return error.value\n  }\n\n  return jStat.beta.inv(probability, alpha, beta) * (B - A) + A\n}\n\nexport const BINOM = {}\n\nBINOM.DIST = (successes, trials, probability, cumulative) => {\n  successes = utils.parseNumber(successes)\n  trials = utils.parseNumber(trials)\n  probability = utils.parseNumber(probability)\n  cumulative = utils.parseNumber(cumulative)\n\n  if (utils.anyIsError(successes, trials, probability, cumulative)) {\n    return error.value\n  }\n\n  return cumulative\n    ? jStat.binomial.cdf(successes, trials, probability)\n    : jStat.binomial.pdf(successes, trials, probability)\n}\n\nBINOM.DIST.RANGE = (trials, probability, successes, successes2) => {\n  successes2 = successes2 === undefined ? successes : successes2\n\n  trials = utils.parseNumber(trials)\n  probability = utils.parseNumber(probability)\n  successes = utils.parseNumber(successes)\n  successes2 = utils.parseNumber(successes2)\n\n  if (utils.anyIsError(trials, probability, successes, successes2)) {\n    return error.value\n  }\n\n  let result = 0\n\n  for (let i = successes; i <= successes2; i++) {\n    result += mathTrig.COMBIN(trials, i) * Math.pow(probability, i) * Math.pow(1 - probability, trials - i)\n  }\n\n  return result\n}\n\nBINOM.INV = (trials, probability, alpha) => {\n  trials = utils.parseNumber(trials)\n  probability = utils.parseNumber(probability)\n  alpha = utils.parseNumber(alpha)\n\n  if (utils.anyIsError(trials, probability, alpha)) {\n    return error.value\n  }\n\n  let x = 0\n\n  while (x <= trials) {\n    if (jStat.binomial.cdf(x, trials, probability) >= alpha) {\n      return x\n    }\n\n    x++\n  }\n}\n\nexport const CHISQ = {}\n\nCHISQ.DIST = (x, k, cumulative) => {\n  x = utils.parseNumber(x)\n  k = utils.parseNumber(k)\n\n  if (utils.anyIsError(x, k)) {\n    return error.value\n  }\n\n  return cumulative ? jStat.chisquare.cdf(x, k) : jStat.chisquare.pdf(x, k)\n}\n\nCHISQ.DIST.RT = (x, k) => {\n  if (!x | !k) {\n    return error.na\n  }\n\n  if (x < 1 || k > Math.pow(10, 10)) {\n    return error.num\n  }\n\n  if (typeof x !== 'number' || typeof k !== 'number') {\n    return error.value\n  }\n\n  return 1 - jStat.chisquare.cdf(x, k)\n}\n\nCHISQ.INV = (probability, k) => {\n  probability = utils.parseNumber(probability)\n  k = utils.parseNumber(k)\n\n  if (utils.anyIsError(probability, k)) {\n    return error.value\n  }\n\n  return jStat.chisquare.inv(probability, k)\n}\n\nCHISQ.INV.RT = (p, k) => {\n  if (!p | !k) {\n    return error.na\n  }\n\n  if (p < 0 || p > 1 || k < 1 || k > Math.pow(10, 10)) {\n    return error.num\n  }\n\n  if (typeof p !== 'number' || typeof k !== 'number') {\n    return error.value\n  }\n\n  return jStat.chisquare.inv(1.0 - p, k)\n}\n\nCHISQ.TEST = function (observed, expected) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (!(observed instanceof Array) || !(expected instanceof Array)) {\n    return error.value\n  }\n\n  if (observed.length !== expected.length) {\n    return error.value\n  }\n\n  if (observed[0] && expected[0] && observed[0].length !== expected[0].length) {\n    return error.value\n  }\n\n  const row = observed.length\n  let tmp, i, j\n\n  // Convert single-dimension array into two-dimension array\n\n  for (i = 0; i < row; i++) {\n    if (!(observed[i] instanceof Array)) {\n      tmp = observed[i]\n      observed[i] = []\n      observed[i].push(tmp)\n    }\n\n    if (!(expected[i] instanceof Array)) {\n      tmp = expected[i]\n      expected[i] = []\n      expected[i].push(tmp)\n    }\n  }\n\n  const col = observed[0].length\n  const dof = col === 1 ? row - 1 : (row - 1) * (col - 1)\n  let xsqr = 0\n  const Pi = Math.PI\n\n  for (i = 0; i < row; i++) {\n    for (j = 0; j < col; j++) {\n      xsqr += Math.pow(observed[i][j] - expected[i][j], 2) / expected[i][j]\n    }\n  }\n\n  // Get independency by X square and its degree of freedom\n  function ChiSq(xsqr, dof) {\n    let p = Math.exp(-0.5 * xsqr)\n\n    if (dof % 2 === 1) {\n      p = p * Math.sqrt((2 * xsqr) / Pi)\n    }\n\n    let k = dof\n\n    while (k >= 2) {\n      p = (p * xsqr) / k\n      k = k - 2\n    }\n\n    let t = p\n    let a = dof\n\n    while (t > 0.0000000001 * p) {\n      a = a + 2\n      t = (t * xsqr) / a\n      p = p + t\n    }\n\n    return 1 - p\n  }\n\n  return Math.round(ChiSq(xsqr, dof) * 1000000) / 1000000\n}\n\nexport function COLUMN(matrix, index) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (index < 0) {\n    return error.num\n  }\n\n  if (!(matrix instanceof Array) || typeof index !== 'number') {\n    return error.value\n  }\n\n  if (matrix.length === 0) {\n    return undefined\n  }\n\n  return jStat.col(matrix, index)\n}\n\nexport function COLUMNS(matrix) {\n  if (arguments.length !== 1) {\n    return error.na\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value\n  }\n\n  if (matrix.length === 0) {\n    return 0\n  }\n\n  return jStat.cols(matrix)\n}\n\nexport const CONFIDENCE = {}\n\nCONFIDENCE.NORM = (alpha, sd, n) => {\n  alpha = utils.parseNumber(alpha)\n  sd = utils.parseNumber(sd)\n  n = utils.parseNumber(n)\n\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value\n  }\n\n  return jStat.normalci(1, alpha, sd, n)[1] - 1\n}\n\nCONFIDENCE.T = (alpha, sd, n) => {\n  alpha = utils.parseNumber(alpha)\n  sd = utils.parseNumber(sd)\n  n = utils.parseNumber(n)\n\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value\n  }\n\n  return jStat.tci(1, alpha, sd, n)[1] - 1\n}\n\nexport function CORREL(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1))\n  array2 = utils.parseNumberArray(utils.flatten(array2))\n\n  if (utils.anyIsError(array1, array2)) {\n    return error.value\n  }\n\n  return jStat.corrcoeff(array1, array2)\n}\n\nexport function COUNT() {\n  const flatArguments = utils.flatten(arguments)\n\n  return utils.numbers(flatArguments).length\n}\n\nexport function COUNTA() {\n  const flatArguments = utils.flatten(arguments)\n\n  return flatArguments.length - COUNTBLANK(flatArguments)\n}\n\nexport function COUNTIN(range, value) {\n  let result = 0\n\n  range = utils.flatten(range)\n\n  for (let i = 0; i < range.length; i++) {\n    if (range[i] === value) {\n      result++\n    }\n  }\n\n  return result\n}\n\nexport function COUNTBLANK() {\n  const range = utils.flatten(arguments)\n  let blanks = 0\n  let element\n\n  for (let i = 0; i < range.length; i++) {\n    element = range[i]\n\n    if (element === undefined || element === null || element === '') {\n      blanks++\n    }\n  }\n\n  return blanks\n}\n\nexport function COUNTIF(range, criteria) {\n  range = utils.flatten(range)\n\n  const isWildcard = criteria === void 0 || criteria === '*'\n\n  if (isWildcard) {\n    return range.length\n  }\n\n  let matches = 0\n  const tokenizedCriteria = evalExpression.parse(criteria + '')\n\n  for (let i = 0; i < range.length; i++) {\n    const value = range[i]\n    const tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria)\n\n    if (evalExpression.compute(tokens)) {\n      matches++\n    }\n  }\n\n  return matches\n}\n\nexport function COUNTIFS() {\n  const args = utils.argsToArray(arguments)\n  const results = new Array(utils.flatten(args[0]).length)\n\n  for (let i = 0; i < results.length; i++) {\n    results[i] = true\n  }\n\n  for (let i = 0; i < args.length; i += 2) {\n    const range = utils.flatten(args[i])\n    const criteria = args[i + 1]\n    const isWildcard = criteria === void 0 || criteria === '*'\n\n    if (!isWildcard) {\n      const tokenizedCriteria = evalExpression.parse(criteria + '')\n\n      for (let j = 0; j < range.length; j++) {\n        const value = range[j]\n        const tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria)\n\n        results[j] = results[j] && evalExpression.compute(tokens)\n      }\n    }\n  }\n\n  let result = 0\n\n  for (let i = 0; i < results.length; i++) {\n    if (results[i]) {\n      result++\n    }\n  }\n\n  return result\n}\n\nexport function COUNTUNIQUE() {\n  return misc.UNIQUE.apply(null, utils.flatten(arguments)).length\n}\n\nexport const COVARIANCE = {}\n\nCOVARIANCE.P = (array1, array2) => {\n  array1 = utils.parseNumberArray(utils.flatten(array1))\n  array2 = utils.parseNumberArray(utils.flatten(array2))\n\n  if (utils.anyIsError(array1, array2)) {\n    return error.value\n  }\n\n  const mean1 = jStat.mean(array1)\n  const mean2 = jStat.mean(array2)\n  let result = 0\n  const n = array1.length\n\n  for (let i = 0; i < n; i++) {\n    result += (array1[i] - mean1) * (array2[i] - mean2)\n  }\n\n  return result / n\n}\n\nCOVARIANCE.S = (array1, array2) => {\n  array1 = utils.parseNumberArray(utils.flatten(array1))\n  array2 = utils.parseNumberArray(utils.flatten(array2))\n\n  if (utils.anyIsError(array1, array2)) {\n    return error.value\n  }\n\n  return jStat.covariance(array1, array2)\n}\n\nexport function DEVSQ() {\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const mean = jStat.mean(range)\n  let result = 0\n\n  for (let i = 0; i < range.length; i++) {\n    result += Math.pow(range[i] - mean, 2)\n  }\n\n  return result\n}\n\nexport const EXPON = {}\n\nEXPON.DIST = (x, lambda, cumulative) => {\n  x = utils.parseNumber(x)\n  lambda = utils.parseNumber(lambda)\n\n  if (utils.anyIsError(x, lambda)) {\n    return error.value\n  }\n\n  return cumulative ? jStat.exponential.cdf(x, lambda) : jStat.exponential.pdf(x, lambda)\n}\n\nexport const F = {}\n\nF.DIST = (x, d1, d2, cumulative) => {\n  x = utils.parseNumber(x)\n  d1 = utils.parseNumber(d1)\n  d2 = utils.parseNumber(d2)\n\n  if (utils.anyIsError(x, d1, d2)) {\n    return error.value\n  }\n\n  return cumulative ? jStat.centralF.cdf(x, d1, d2) : jStat.centralF.pdf(x, d1, d2)\n}\n\nF.DIST.RT = function (x, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na\n  }\n\n  if (x < 0 || d1 < 1 || d2 < 1) {\n    return error.num\n  }\n\n  if (typeof x !== 'number' || typeof d1 !== 'number' || typeof d2 !== 'number') {\n    return error.value\n  }\n\n  return 1 - jStat.centralF.cdf(x, d1, d2)\n}\n\nF.INV = (probability, d1, d2) => {\n  probability = utils.parseNumber(probability)\n  d1 = utils.parseNumber(d1)\n  d2 = utils.parseNumber(d2)\n\n  if (utils.anyIsError(probability, d1, d2)) {\n    return error.value\n  }\n\n  if (probability <= 0.0 || probability > 1.0) {\n    return error.num\n  }\n\n  return jStat.centralF.inv(probability, d1, d2)\n}\n\nF.INV.RT = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num\n  }\n\n  if (typeof p !== 'number' || typeof d1 !== 'number' || typeof d2 !== 'number') {\n    return error.value\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2)\n}\n\nF.TEST = (array1, array2) => {\n  if (!array1 || !array2) {\n    return error.na\n  }\n\n  if (!(array1 instanceof Array) || !(array2 instanceof Array)) {\n    return error.na\n  }\n\n  if (array1.length < 2 || array2.length < 2) {\n    return error.div0\n  }\n\n  const sumOfSquares = (values, x1) => {\n    let sum = 0\n\n    for (let i = 0; i < values.length; i++) {\n      sum += Math.pow(values[i] - x1, 2)\n    }\n\n    return sum\n  }\n\n  const x1 = mathTrig.SUM(array1) / array1.length\n  const x2 = mathTrig.SUM(array2) / array2.length\n  const sum1 = sumOfSquares(array1, x1) / (array1.length - 1)\n  const sum2 = sumOfSquares(array2, x2) / (array2.length - 1)\n\n  return sum1 / sum2\n}\n\nexport function FISHER(x) {\n  x = utils.parseNumber(x)\n\n  if (x instanceof Error) {\n    return x\n  }\n\n  return Math.log((1 + x) / (1 - x)) / 2\n}\n\nexport function FISHERINV(y) {\n  y = utils.parseNumber(y)\n\n  if (y instanceof Error) {\n    return y\n  }\n\n  const e2y = Math.exp(2 * y)\n\n  return (e2y - 1) / (e2y + 1)\n}\n\nexport function FORECAST(x, data_y, data_x) {\n  x = utils.parseNumber(x)\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n\n  if (utils.anyIsError(x, data_y, data_x)) {\n    return error.value\n  }\n\n  const xmean = jStat.mean(data_x)\n  const ymean = jStat.mean(data_y)\n  const n = data_x.length\n  let num = 0\n  let den = 0\n\n  for (let i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean)\n    den += Math.pow(data_x[i] - xmean, 2)\n  }\n\n  const b = num / den\n  const a = ymean - b * xmean\n\n  return a + b * x\n}\n\nexport function FREQUENCY(data, bins) {\n  data = utils.parseNumberArray(utils.flatten(data))\n  bins = utils.parseNumberArray(utils.flatten(bins))\n\n  if (utils.anyIsError(data, bins)) {\n    return error.value\n  }\n\n  const n = data.length\n  const b = bins.length\n  const r = []\n\n  for (let i = 0; i <= b; i++) {\n    r[i] = 0\n\n    for (let j = 0; j < n; j++) {\n      if (i === 0) {\n        if (data[j] <= bins[0]) {\n          r[0] += 1\n        }\n      } else if (i < b) {\n        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\n          r[i] += 1\n        }\n      } else if (i === b) {\n        if (data[j] > bins[b - 1]) {\n          r[b] += 1\n        }\n      }\n    }\n  }\n\n  return r\n}\n\nexport function GAMMA(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number === 0) {\n    return error.num\n  }\n\n  if (parseInt(number, 10) === number && number < 0) {\n    return error.num\n  }\n\n  return jStat.gammafn(number)\n}\n\nGAMMA.DIST = function (value, alpha, beta, cumulative) {\n  if (arguments.length !== 4) {\n    return error.na\n  }\n\n  if (value < 0 || alpha <= 0 || beta <= 0) {\n    return error.value\n  }\n\n  if (typeof value !== 'number' || typeof alpha !== 'number' || typeof beta !== 'number') {\n    return error.value\n  }\n\n  return cumulative ? jStat.gamma.cdf(value, alpha, beta, true) : jStat.gamma.pdf(value, alpha, beta, false)\n}\n\nGAMMA.INV = function (probability, alpha, beta) {\n  if (arguments.length !== 3) {\n    return error.na\n  }\n\n  if (probability < 0 || probability > 1 || alpha <= 0 || beta <= 0) {\n    return error.num\n  }\n\n  if (typeof probability !== 'number' || typeof alpha !== 'number' || typeof beta !== 'number') {\n    return error.value\n  }\n\n  return jStat.gamma.inv(probability, alpha, beta)\n}\n\nexport function GAMMALN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return jStat.gammaln(number)\n}\n\nGAMMALN.PRECISE = function (x) {\n  if (arguments.length !== 1) {\n    return error.na\n  }\n\n  if (x <= 0) {\n    return error.num\n  }\n\n  if (typeof x !== 'number') {\n    return error.value\n  }\n\n  return jStat.gammaln(x)\n}\n\nexport function GAUSS(z) {\n  z = utils.parseNumber(z)\n\n  if (z instanceof Error) {\n    return z\n  }\n\n  return jStat.normal.cdf(z, 0, 1) - 0.5\n}\n\nexport function GEOMEAN() {\n  const args = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (args instanceof Error) {\n    return args\n  }\n\n  return jStat.geomean(args)\n}\n\nexport function GROWTH(known_y, known_x, new_x, use_const) {\n  // Credits: Ilmari Karonen (http://stackoverflow.com/questions/14161990/how-to-implement-growth-function-in-javascript)\n  known_y = utils.parseNumberArray(known_y)\n\n  if (known_y instanceof Error) {\n    return known_y\n  }\n\n  // Default values for optional parameters:\n  let i\n\n  if (known_x === undefined) {\n    known_x = []\n\n    for (i = 1; i <= known_y.length; i++) {\n      known_x.push(i)\n    }\n  }\n\n  if (new_x === undefined) {\n    new_x = []\n\n    for (i = 1; i <= known_y.length; i++) {\n      new_x.push(i)\n    }\n  }\n\n  known_x = utils.parseNumberArray(known_x)\n  new_x = utils.parseNumberArray(new_x)\n\n  if (utils.anyIsError(known_x, new_x)) {\n    return error.value\n  }\n\n  if (use_const === undefined) {\n    use_const = true\n  }\n\n  // Calculate sums over the data:\n  const n = known_y.length\n  let avg_x = 0\n  let avg_y = 0\n  let avg_xy = 0\n  let avg_xx = 0\n\n  for (i = 0; i < n; i++) {\n    const x = known_x[i]\n    const y = Math.log(known_y[i])\n    avg_x += x\n    avg_y += y\n    avg_xy += x * y\n    avg_xx += x * x\n  }\n\n  avg_x /= n\n  avg_y /= n\n  avg_xy /= n\n  avg_xx /= n\n\n  // Compute linear regression coefficients:\n  let beta\n  let alpha\n\n  if (use_const) {\n    beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x)\n    alpha = avg_y - beta * avg_x\n  } else {\n    beta = avg_xy / avg_xx\n    alpha = 0\n  }\n\n  // Compute and return result array:\n  const new_y = []\n\n  for (i = 0; i < new_x.length; i++) {\n    new_y.push(Math.exp(alpha + beta * new_x[i]))\n  }\n\n  return new_y\n}\n\nexport function HARMEAN() {\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const n = range.length\n  let den = 0\n\n  for (let i = 0; i < n; i++) {\n    den += 1 / range[i]\n  }\n\n  return n / den\n}\n\nexport const HYPGEOM = {}\n\nHYPGEOM.DIST = (x, n, M, N, cumulative) => {\n  x = utils.parseNumber(x)\n  n = utils.parseNumber(n)\n  M = utils.parseNumber(M)\n  N = utils.parseNumber(N)\n\n  if (utils.anyIsError(x, n, M, N)) {\n    return error.value\n  }\n\n  function pdf(x, n, M, N) {\n    return (mathTrig.COMBIN(M, x) * mathTrig.COMBIN(N - M, n - x)) / mathTrig.COMBIN(N, n)\n  }\n\n  function cdf(x, n, M, N) {\n    let result = 0\n\n    for (let i = 0; i <= x; i++) {\n      result += pdf(i, n, M, N)\n    }\n\n    return result\n  }\n\n  return cumulative ? cdf(x, n, M, N) : pdf(x, n, M, N)\n}\n\nexport function INTERCEPT(known_y, known_x) {\n  known_y = utils.parseNumberArray(known_y)\n  known_x = utils.parseNumberArray(known_x)\n\n  if (utils.anyIsError(known_y, known_x)) {\n    return error.value\n  }\n\n  if (known_y.length !== known_x.length) {\n    return error.na\n  }\n\n  return FORECAST(0, known_y, known_x)\n}\n\nexport function KURT() {\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const mean = jStat.mean(range)\n  const n = range.length\n  let sigma = 0\n\n  for (let i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 4)\n  }\n\n  sigma = sigma / Math.pow(jStat.stdev(range, true), 4)\n\n  return ((n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3))) * sigma - (3 * (n - 1) * (n - 1)) / ((n - 2) * (n - 3))\n}\n\nexport function LARGE(range, k) {\n  range = utils.parseNumberArray(utils.flatten(range))\n  k = utils.parseNumber(k)\n\n  if (utils.anyIsError(range, k)) {\n    return range\n  }\n\n  if (k < 0 || range.length < k) {\n    return error.value\n  }\n\n  return range.sort((a, b) => b - a)[k - 1]\n}\n\nexport function LINEST(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value\n  }\n\n  const ymean = jStat.mean(data_y)\n  const xmean = jStat.mean(data_x)\n  const n = data_x.length\n  let num = 0\n  let den = 0\n\n  for (let i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean)\n    den += Math.pow(data_x[i] - xmean, 2)\n  }\n\n  const m = num / den\n  const b = ymean - m * xmean\n\n  return [m, b]\n}\n\n// According to Microsoft:\n// http://office.microsoft.com/en-us/starter-help/logest-function-HP010342665.aspx\n// LOGEST returns are based on the following linear model:\n// ln y = x1 ln m1 + ... + xn ln mn + ln b\nexport function LOGEST(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value\n  }\n\n  for (let i = 0; i < data_y.length; i++) {\n    data_y[i] = Math.log(data_y[i])\n  }\n\n  const result = LINEST(data_y, data_x)\n  result[0] = Math.round(Math.exp(result[0]) * 1000000) / 1000000\n  result[1] = Math.round(Math.exp(result[1]) * 1000000) / 1000000\n\n  return result\n}\n\nexport const LOGNORM = {}\n\nLOGNORM.DIST = (x, mean, sd, cumulative) => {\n  x = utils.parseNumber(x)\n  mean = utils.parseNumber(mean)\n  sd = utils.parseNumber(sd)\n\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value\n  }\n\n  return cumulative ? jStat.lognormal.cdf(x, mean, sd) : jStat.lognormal.pdf(x, mean, sd)\n}\n\nLOGNORM.INV = (probability, mean, sd) => {\n  probability = utils.parseNumber(probability)\n  mean = utils.parseNumber(mean)\n  sd = utils.parseNumber(sd)\n\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value\n  }\n\n  return jStat.lognormal.inv(probability, mean, sd)\n}\n\nexport function MAX() {\n  const flatArguments = utils.flatten(arguments)\n  const someError = utils.anyError.apply(undefined, flatArguments)\n\n  if (someError) {\n    return someError\n  }\n\n  const range = utils.numbers(flatArguments)\n\n  return range.length === 0 ? 0 : Math.max.apply(Math, range)\n}\n\nexport function MAXA() {\n  const flatArguments = utils.flatten(arguments)\n  const someError = utils.anyError.apply(undefined, flatArguments)\n\n  if (someError) {\n    return someError\n  }\n\n  let range = utils.arrayValuesToNumbers(flatArguments)\n  range = range.map((value) => (value === undefined || value === null ? 0 : value))\n\n  return range.length === 0 ? 0 : Math.max.apply(Math, range)\n}\n\nexport function MEDIAN() {\n  const flatArguments = utils.flatten(arguments)\n  const someError = utils.anyError.apply(undefined, flatArguments)\n\n  if (someError) {\n    return someError\n  }\n\n  const range = utils.arrayValuesToNumbers(flatArguments)\n  let result = jStat.median(range)\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function MIN() {\n  const flatArguments = utils.flatten(arguments)\n  const someError = utils.anyError.apply(undefined, flatArguments)\n\n  if (someError) {\n    return someError\n  }\n\n  const range = utils.numbers(flatArguments)\n\n  return range.length === 0 ? 0 : Math.min.apply(Math, range)\n}\n\nexport function MINA() {\n  const flatArguments = utils.flatten(arguments)\n  const someError = utils.anyError.apply(undefined, flatArguments)\n\n  if (someError) {\n    return someError\n  }\n\n  let range = utils.arrayValuesToNumbers(flatArguments)\n  range = range.map((value) => (value === undefined || value === null ? 0 : value))\n\n  return range.length === 0 ? 0 : Math.min.apply(Math, range)\n}\n\nexport const MODE = {}\n\nMODE.MULT = function () {\n  // Credits: Roönaän\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const n = range.length\n  const count = {}\n  let maxItems = []\n  let max = 0\n  let currentItem\n\n  for (let i = 0; i < n; i++) {\n    currentItem = range[i]\n    count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1\n\n    if (count[currentItem] > max) {\n      max = count[currentItem]\n      maxItems = []\n    }\n\n    if (count[currentItem] === max) {\n      maxItems[maxItems.length] = currentItem\n    }\n  }\n\n  return maxItems\n}\n\nMODE.SNGL = function () {\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  return MODE.MULT(range).sort((a, b) => a - b)[0]\n}\n\nexport const NEGBINOM = {}\n\nNEGBINOM.DIST = (k, r, p, cumulative) => {\n  k = utils.parseNumber(k)\n  r = utils.parseNumber(r)\n  p = utils.parseNumber(p)\n\n  if (utils.anyIsError(k, r, p)) {\n    return error.value\n  }\n\n  return cumulative ? jStat.negbin.cdf(k, r, p) : jStat.negbin.pdf(k, r, p)\n}\n\nexport const NORM = {}\n\nNORM.DIST = (x, mean, sd, cumulative) => {\n  x = utils.parseNumber(x)\n  mean = utils.parseNumber(mean)\n  sd = utils.parseNumber(sd)\n\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value\n  }\n\n  if (sd <= 0) {\n    return error.num\n  }\n\n  // Return normal distribution computed by jStat [http://jstat.org]\n  return cumulative ? jStat.normal.cdf(x, mean, sd) : jStat.normal.pdf(x, mean, sd)\n}\n\nNORM.INV = (probability, mean, sd) => {\n  probability = utils.parseNumber(probability)\n  mean = utils.parseNumber(mean)\n  sd = utils.parseNumber(sd)\n\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value\n  }\n\n  return jStat.normal.inv(probability, mean, sd)\n}\n\nNORM.S = {}\n\nNORM.S.DIST = (z, cumulative) => {\n  z = utils.parseNumber(z)\n\n  if (z instanceof Error) {\n    return error.value\n  }\n\n  return cumulative ? jStat.normal.cdf(z, 0, 1) : jStat.normal.pdf(z, 0, 1)\n}\n\nNORM.S.INV = (probability) => {\n  probability = utils.parseNumber(probability)\n\n  if (probability instanceof Error) {\n    return error.value\n  }\n\n  return jStat.normal.inv(probability, 0, 1)\n}\n\nexport function PEARSON(data_x, data_y) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value\n  }\n\n  const xmean = jStat.mean(data_x)\n  const ymean = jStat.mean(data_y)\n  const n = data_x.length\n  let num = 0\n  let den1 = 0\n  let den2 = 0\n\n  for (let i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean)\n    den1 += Math.pow(data_x[i] - xmean, 2)\n    den2 += Math.pow(data_y[i] - ymean, 2)\n  }\n\n  return num / Math.sqrt(den1 * den2)\n}\n\nexport const PERCENTILE = {}\n\nPERCENTILE.EXC = (array, k) => {\n  array = utils.parseNumberArray(utils.flatten(array))\n  k = utils.parseNumber(k)\n\n  if (utils.anyIsError(array, k)) {\n    return error.value\n  }\n\n  array = array.sort((a, b) => a - b)\n  const n = array.length\n\n  if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\n    return error.num\n  }\n\n  const l = k * (n + 1) - 1\n  const fl = Math.floor(l)\n\n  return utils.cleanFloat(l === fl ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]))\n}\n\nPERCENTILE.INC = (array, k) => {\n  array = utils.parseNumberArray(utils.flatten(array))\n  k = utils.parseNumber(k)\n\n  if (utils.anyIsError(array, k)) {\n    return error.value\n  }\n\n  array = array.sort((a, b) => a - b)\n  const n = array.length\n  const l = k * (n - 1)\n  const fl = Math.floor(l)\n\n  return utils.cleanFloat(l === fl ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]))\n}\n\nexport const PERCENTRANK = {}\n\nPERCENTRANK.EXC = (array, x, significance) => {\n  significance = significance === undefined ? 3 : significance\n  array = utils.parseNumberArray(utils.flatten(array))\n  x = utils.parseNumber(x)\n  significance = utils.parseNumber(significance)\n\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value\n  }\n\n  array = array.sort((a, b) => a - b)\n  const uniques = misc.UNIQUE.apply(null, array)\n  const n = array.length\n  const m = uniques.length\n  const power = Math.pow(10, significance)\n  let result = 0\n  let match = false\n  let i = 0\n\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = (array.indexOf(uniques[i]) + 1) / (n + 1)\n      match = true\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1)\n      match = true\n    }\n\n    i++\n  }\n\n  return Math.floor(result * power) / power\n}\n\nPERCENTRANK.INC = (array, x, significance) => {\n  significance = significance === undefined ? 3 : significance\n  array = utils.parseNumberArray(utils.flatten(array))\n  x = utils.parseNumber(x)\n  significance = utils.parseNumber(significance)\n\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value\n  }\n\n  array = array.sort((a, b) => a - b)\n  const uniques = misc.UNIQUE.apply(null, array)\n  const n = array.length\n  const m = uniques.length\n  const power = Math.pow(10, significance)\n  let result = 0\n  let match = false\n  let i = 0\n\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = array.indexOf(uniques[i]) / (n - 1)\n      match = true\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1)\n      match = true\n    }\n\n    i++\n  }\n\n  return Math.floor(result * power) / power\n}\n\nexport function PERMUT(number, number_chosen) {\n  number = utils.parseNumber(number)\n  number_chosen = utils.parseNumber(number_chosen)\n\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value\n  }\n\n  return mathTrig.FACT(number) / mathTrig.FACT(number - number_chosen)\n}\n\nexport function PERMUTATIONA(number, number_chosen) {\n  number = utils.parseNumber(number)\n  number_chosen = utils.parseNumber(number_chosen)\n\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value\n  }\n\n  return Math.pow(number, number_chosen)\n}\n\nexport function PHI(x) {\n  x = utils.parseNumber(x)\n\n  if (x instanceof Error) {\n    return error.value\n  }\n\n  return Math.exp(-0.5 * x * x) / SQRT2PI\n}\n\nexport const POISSON = {}\n\nPOISSON.DIST = (x, mean, cumulative) => {\n  x = utils.parseNumber(x)\n  mean = utils.parseNumber(mean)\n\n  if (utils.anyIsError(x, mean)) {\n    return error.value\n  }\n\n  return cumulative ? jStat.poisson.cdf(x, mean) : jStat.poisson.pdf(x, mean)\n}\n\nexport function PROB(range, probability, lower, upper) {\n  if (lower === undefined) {\n    return 0\n  }\n\n  upper = upper === undefined ? lower : upper\n\n  range = utils.parseNumberArray(utils.flatten(range))\n  probability = utils.parseNumberArray(utils.flatten(probability))\n  lower = utils.parseNumber(lower)\n  upper = utils.parseNumber(upper)\n\n  if (utils.anyIsError(range, probability, lower, upper)) {\n    return error.value\n  }\n\n  if (lower === upper) {\n    return range.indexOf(lower) >= 0 ? probability[range.indexOf(lower)] : 0\n  }\n\n  const sorted = range.sort((a, b) => a - b)\n  const n = sorted.length\n  let result = 0\n\n  for (let i = 0; i < n; i++) {\n    if (sorted[i] >= lower && sorted[i] <= upper) {\n      result += probability[range.indexOf(sorted[i])]\n    }\n  }\n\n  return result\n}\n\nexport const QUARTILE = {}\n\nQUARTILE.EXC = (range, quart) => {\n  range = utils.parseNumberArray(utils.flatten(range))\n  quart = utils.parseNumber(quart)\n\n  if (utils.anyIsError(range, quart)) {\n    return error.value\n  }\n\n  switch (quart) {\n    case 1:\n      return PERCENTILE.EXC(range, 0.25)\n    case 2:\n      return PERCENTILE.EXC(range, 0.5)\n    case 3:\n      return PERCENTILE.EXC(range, 0.75)\n    default:\n      return error.num\n  }\n}\n\nQUARTILE.INC = (range, quart) => {\n  range = utils.parseNumberArray(utils.flatten(range))\n  quart = utils.parseNumber(quart)\n\n  if (utils.anyIsError(range, quart)) {\n    return error.value\n  }\n\n  switch (quart) {\n    case 1:\n      return PERCENTILE.INC(range, 0.25)\n    case 2:\n      return PERCENTILE.INC(range, 0.5)\n    case 3:\n      return PERCENTILE.INC(range, 0.75)\n    default:\n      return error.num\n  }\n}\n\nexport const RANK = {}\n\nRANK.AVG = (number, range, order) => {\n  number = utils.parseNumber(number)\n  range = utils.parseNumberArray(utils.flatten(range))\n\n  if (utils.anyIsError(number, range)) {\n    return error.value\n  }\n\n  range = utils.flatten(range)\n  order = order || false\n  const sort = order ? (a, b) => a - b : (a, b) => b - a\n  range = range.sort(sort)\n\n  const length = range.length\n  let count = 0\n\n  for (let i = 0; i < length; i++) {\n    if (range[i] === number) {\n      count++\n    }\n  }\n\n  return count > 1 ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1\n}\n\nRANK.EQ = (number, range, order) => {\n  number = utils.parseNumber(number)\n  range = utils.parseNumberArray(utils.flatten(range))\n\n  if (utils.anyIsError(number, range)) {\n    return error.value\n  }\n\n  order = order || false\n  const sort = order ? (a, b) => a - b : (a, b) => b - a\n  range = range.sort(sort)\n\n  return range.indexOf(number) + 1\n}\n\nexport function ROW(matrix, index) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (index < 0) {\n    return error.num\n  }\n\n  if (!(matrix instanceof Array) || typeof index !== 'number') {\n    return error.value\n  }\n\n  if (matrix.length === 0) {\n    return undefined\n  }\n\n  return jStat.row(matrix, index)\n}\n\nexport function ROWS(matrix) {\n  if (arguments.length !== 1) {\n    return error.na\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value\n  }\n\n  if (matrix.length === 0) {\n    return 0\n  }\n\n  return jStat.rows(matrix)\n}\n\nexport function RSQ(data_x, data_y) {\n  // no need to flatten here, PEARSON will take care of that\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value\n  }\n\n  return Math.pow(PEARSON(data_x, data_y), 2)\n}\n\nexport function SKEW() {\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const mean = jStat.mean(range)\n  const n = range.length\n  let sigma = 0\n\n  for (let i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 3)\n  }\n\n  return (n * sigma) / ((n - 1) * (n - 2) * Math.pow(jStat.stdev(range, true), 3))\n}\n\nSKEW.P = function () {\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const mean = jStat.mean(range)\n  const n = range.length\n  let m2 = 0\n  let m3 = 0\n\n  for (let i = 0; i < n; i++) {\n    m3 += Math.pow(range[i] - mean, 3)\n    m2 += Math.pow(range[i] - mean, 2)\n  }\n\n  m3 = m3 / n\n  m2 = m2 / n\n\n  return m3 / Math.pow(m2, 3 / 2)\n}\n\nexport function SLOPE(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value\n  }\n\n  const xmean = jStat.mean(data_x)\n  const ymean = jStat.mean(data_y)\n  const n = data_x.length\n  let num = 0\n  let den = 0\n\n  for (let i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean)\n    den += Math.pow(data_x[i] - xmean, 2)\n  }\n\n  return num / den\n}\n\nexport function SMALL(range, k) {\n  range = utils.parseNumberArray(utils.flatten(range))\n  k = utils.parseNumber(k)\n\n  if (utils.anyIsError(range, k)) {\n    return range\n  }\n\n  return range.sort((a, b) => a - b)[k - 1]\n}\n\nexport function STANDARDIZE(x, mean, sd) {\n  x = utils.parseNumber(x)\n  mean = utils.parseNumber(mean)\n  sd = utils.parseNumber(sd)\n\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value\n  }\n\n  return (x - mean) / sd\n}\n\nexport const STDEV = {}\n\nSTDEV.P = function () {\n  const v = VAR.P.apply(this, arguments)\n  let result = Math.sqrt(v)\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nSTDEV.S = function () {\n  const v = VAR.S.apply(this, arguments)\n  const result = Math.sqrt(v)\n\n  return result\n}\n\nexport function STDEVA() {\n  const v = VARA.apply(this, arguments)\n  const result = Math.sqrt(v)\n\n  return result\n}\n\nexport function STDEVPA() {\n  const v = VARPA.apply(this, arguments)\n  let result = Math.sqrt(v)\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function STEYX(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value\n  }\n\n  const xmean = jStat.mean(data_x)\n  const ymean = jStat.mean(data_y)\n  const n = data_x.length\n  let lft = 0\n  let num = 0\n  let den = 0\n\n  for (let i = 0; i < n; i++) {\n    lft += Math.pow(data_y[i] - ymean, 2)\n    num += (data_x[i] - xmean) * (data_y[i] - ymean)\n    den += Math.pow(data_x[i] - xmean, 2)\n  }\n\n  return Math.sqrt((lft - (num * num) / den) / (n - 2))\n}\n\nexport function TRANSPOSE(matrix) {\n  if (!matrix) {\n    return error.na\n  }\n\n  return jStat.transpose(matrix)\n}\n\nexport const T = {}\n\nT.DIST = (x, df, tails) => {\n  if (tails !== 1 && tails !== 2) {\n    return error.num\n  }\n\n  return tails === 1 ? T.DIST.RT(x, df) : T.DIST['2T'](x, df)\n}\n\nT.DIST['2T'] = function (x, df) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num\n  }\n\n  if (typeof x !== 'number' || typeof df !== 'number') {\n    return error.value\n  }\n\n  return (1 - jStat.studentt.cdf(x, df)) * 2\n}\n\nT.DIST.RT = function (x, df) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num\n  }\n\n  if (typeof x !== 'number' || typeof df !== 'number') {\n    return error.value\n  }\n\n  return 1 - jStat.studentt.cdf(x, df)\n}\n\nT.INV = (probability, df) => {\n  probability = utils.parseNumber(probability)\n  df = utils.parseNumber(df)\n\n  if (utils.anyIsError(probability, df)) {\n    return error.value\n  }\n\n  return jStat.studentt.inv(probability, df)\n}\n\nT.INV['2T'] = (probability, df) => {\n  probability = utils.parseNumber(probability)\n  df = utils.parseNumber(df)\n\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num\n  }\n\n  if (utils.anyIsError(probability, df)) {\n    return error.value\n  }\n\n  return Math.abs(jStat.studentt.inv(probability / 2, df))\n}\n\n// The algorithm can be found here:\n// http://www.chem.uoa.gr/applets/AppletTtest/Appl_Ttest2.html\nT.TEST = (data_x, data_y) => {\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value\n  }\n\n  const mean_x = jStat.mean(data_x)\n  const mean_y = jStat.mean(data_y)\n  let s_x = 0\n  let s_y = 0\n  let i\n\n  for (i = 0; i < data_x.length; i++) {\n    s_x += Math.pow(data_x[i] - mean_x, 2)\n  }\n\n  for (i = 0; i < data_y.length; i++) {\n    s_y += Math.pow(data_y[i] - mean_y, 2)\n  }\n\n  s_x = s_x / (data_x.length - 1)\n  s_y = s_y / (data_y.length - 1)\n\n  const t = Math.abs(mean_x - mean_y) / Math.sqrt(s_x / data_x.length + s_y / data_y.length)\n\n  return T.DIST['2T'](t, data_x.length + data_y.length - 2)\n}\n\nexport function TREND(data_y, data_x, new_data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y))\n  data_x = utils.parseNumberArray(utils.flatten(data_x))\n  new_data_x = utils.parseNumberArray(utils.flatten(new_data_x))\n\n  if (utils.anyIsError(data_y, data_x, new_data_x)) {\n    return error.value\n  }\n\n  const linest = LINEST(data_y, data_x)\n  const m = linest[0]\n  const b = linest[1]\n  const result = []\n\n  new_data_x.forEach((x) => {\n    result.push(m * x + b)\n  })\n\n  return result\n}\n\nexport function TRIMMEAN(range, percent) {\n  range = utils.parseNumberArray(utils.flatten(range))\n  percent = utils.parseNumber(percent)\n\n  if (utils.anyIsError(range, percent)) {\n    return error.value\n  }\n\n  const trim = mathTrig.FLOOR(range.length * percent, 2) / 2\n\n  return jStat.mean(\n    utils.initial(\n      utils.rest(\n        range.sort((a, b) => a - b),\n        trim\n      ),\n      trim\n    )\n  )\n}\n\nexport const VAR = {}\n\nVAR.P = function () {\n  const range = utils.numbers(utils.flatten(arguments))\n  const n = range.length\n  let sigma = 0\n  const mean = AVERAGE(range)\n  let result\n\n  for (let i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2)\n  }\n\n  result = sigma / n\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nVAR.S = function () {\n  const range = utils.numbers(utils.flatten(arguments))\n  const n = range.length\n  let sigma = 0\n  const mean = AVERAGE(range)\n\n  for (let i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2)\n  }\n\n  return sigma / (n - 1)\n}\n\nexport function VARA() {\n  const range = utils.flatten(arguments)\n  const n = range.length\n  let sigma = 0\n  let count = 0\n  const mean = AVERAGEA(range)\n\n  for (let i = 0; i < n; i++) {\n    const el = range[i]\n\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2)\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2)\n    } else {\n      sigma += Math.pow(0 - mean, 2)\n    }\n\n    if (el !== null) {\n      count++\n    }\n  }\n\n  return sigma / (count - 1)\n}\n\nexport function VARPA() {\n  const range = utils.flatten(arguments)\n  const n = range.length\n  let sigma = 0\n  let count = 0\n  const mean = AVERAGEA(range)\n  let result\n\n  for (let i = 0; i < n; i++) {\n    const el = range[i]\n\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2)\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2)\n    } else {\n      sigma += Math.pow(0 - mean, 2)\n    }\n\n    if (el !== null) {\n      count++\n    }\n  }\n\n  result = sigma / count\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport const WEIBULL = {}\n\nWEIBULL.DIST = (x, alpha, beta, cumulative) => {\n  x = utils.parseNumber(x)\n  alpha = utils.parseNumber(alpha)\n  beta = utils.parseNumber(beta)\n\n  if (utils.anyIsError(x, alpha, beta)) {\n    return error.value\n  }\n\n  return cumulative\n    ? 1 - Math.exp(-Math.pow(x / beta, alpha))\n    : (Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha) / Math.pow(beta, alpha)\n}\n\nexport const Z = {}\n\nZ.TEST = (range, x, sd) => {\n  range = utils.parseNumberArray(utils.flatten(range))\n  x = utils.parseNumber(x)\n\n  if (utils.anyIsError(range, x)) {\n    return error.value\n  }\n\n  sd = sd || STDEV.S(range)\n  const n = range.length\n\n  return 1 - NORM.S.DIST((AVERAGE(range) - x) / (sd / Math.sqrt(n)), true)\n}\n","import * as error from './utils/error.js'\nimport * as evalExpression from './utils/criteria-eval.js'\nimport * as information from './information.js'\nimport * as statistical from './statistical.js'\nimport * as utils from './utils/common.js'\n\nexport function ABS(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  const result = Math.abs(number)\n\n  return result\n}\n\nexport function ACOS(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  let result = Math.acos(number)\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function ACOSH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  let result = Math.log(number + Math.sqrt(number * number - 1))\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function ACOT(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  const result = Math.atan(1 / number)\n\n  return result\n}\n\nexport function ACOTH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  let result = 0.5 * Math.log((number + 1) / (number - 1))\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\n// TODO: use options\nexport function AGGREGATE(function_num, options, ref1, ref2) {\n  function_num = utils.parseNumber(function_num)\n  options = utils.parseNumber(function_num)\n\n  if (utils.anyIsError(function_num, options)) {\n    return error.value\n  }\n\n  switch (function_num) {\n    case 1:\n      return statistical.AVERAGE(ref1)\n    case 2:\n      return statistical.COUNT(ref1)\n    case 3:\n      return statistical.COUNTA(ref1)\n    case 4:\n      return statistical.MAX(ref1)\n    case 5:\n      return statistical.MIN(ref1)\n    case 6:\n      return PRODUCT(ref1)\n    case 7:\n      return statistical.STDEV.S(ref1)\n    case 8:\n      return statistical.STDEV.P(ref1)\n    case 9:\n      return SUM(ref1)\n    case 10:\n      return statistical.VAR.S(ref1)\n    case 11:\n      return statistical.VAR.P(ref1)\n    case 12:\n      return statistical.MEDIAN(ref1)\n    case 13:\n      return statistical.MODE.SNGL(ref1)\n    case 14:\n      return statistical.LARGE(ref1, ref2)\n    case 15:\n      return statistical.SMALL(ref1, ref2)\n    case 16:\n      return statistical.PERCENTILE.INC(ref1, ref2)\n    case 17:\n      return statistical.QUARTILE.INC(ref1, ref2)\n    case 18:\n      return statistical.PERCENTILE.EXC(ref1, ref2)\n    case 19:\n      return statistical.QUARTILE.EXC(ref1, ref2)\n  }\n}\n\nexport function ARABIC(text) {\n  if (text === undefined || text === null) {\n    return 0\n  }\n\n  if (text instanceof Error) {\n    return text\n  }\n\n  // Credits: Rafa? Kukawski\n  if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\n    return error.value\n  }\n\n  let r = 0\n  text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, (i) => {\n    r += {\n      M: 1000,\n      CM: 900,\n      D: 500,\n      CD: 400,\n      C: 100,\n      XC: 90,\n      L: 50,\n      XL: 40,\n      X: 10,\n      IX: 9,\n      V: 5,\n      IV: 4,\n      I: 1\n    }[i]\n  })\n\n  return r\n}\n\nexport function ASIN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  let result = Math.asin(number)\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function ASINH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return Math.log(number + Math.sqrt(number * number + 1))\n}\n\nexport function ATAN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return Math.atan(number)\n}\n\nexport function ATAN2(number_x, number_y) {\n  number_x = utils.parseNumber(number_x)\n  number_y = utils.parseNumber(number_y)\n  const anyError = utils.anyError(number_x, number_y)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return Math.atan2(number_x, number_y)\n}\n\nexport function ATANH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  let result = Math.log((1 + number) / (1 - number)) / 2\n\n  if (isNaN(result)) {\n    result = error.num\n  }\n\n  return result\n}\n\nexport function BASE(number, radix, min_length) {\n  number = utils.parseNumber(number)\n  radix = utils.parseNumber(radix)\n  min_length = utils.parseNumber(min_length)\n  const anyError = utils.anyError(number, radix, min_length)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (radix === 0) {\n    return error.num\n  }\n\n  const result = number.toString(radix)\n\n  return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result\n}\n\nexport function CEILING(number, significance, mode) {\n  number = utils.parseNumber(number)\n  significance = utils.parseNumber(significance)\n  mode = utils.parseNumber(mode)\n  const anyError = utils.anyError(number, significance, mode)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (significance === 0) {\n    return 0\n  }\n\n  significance = Math.abs(significance)\n  const precision = -Math.floor(Math.log(significance) / Math.log(10))\n\n  if (number >= 0) {\n    return ROUND(Math.ceil(number / significance) * significance, precision)\n  } else {\n    if (mode === 0) {\n      return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision)\n    } else {\n      return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision)\n    }\n  }\n}\n\nCEILING.MATH = CEILING\n\nCEILING.PRECISE = CEILING\n\nexport function COMBIN(number, number_chosen) {\n  number = utils.parseNumber(number)\n  number_chosen = utils.parseNumber(number_chosen)\n  const anyError = utils.anyError(number, number_chosen)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (number < number_chosen) {\n    return error.num\n  }\n\n  return FACT(number) / (FACT(number_chosen) * FACT(number - number_chosen))\n}\n\nexport function COMBINA(number, number_chosen) {\n  number = utils.parseNumber(number)\n  number_chosen = utils.parseNumber(number_chosen)\n  const anyError = utils.anyError(number, number_chosen)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (number < number_chosen) {\n    return error.num\n  }\n\n  return number === 0 && number_chosen === 0 ? 1 : COMBIN(number + number_chosen - 1, number - 1)\n}\n\nexport function COS(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return Math.cos(number)\n}\n\nexport function COSH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return (Math.exp(number) + Math.exp(-number)) / 2\n}\n\nexport function COT(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number === 0) {\n    return error.div0\n  }\n\n  return 1 / Math.tan(number)\n}\n\nexport function COTH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number === 0) {\n    return error.div0\n  }\n\n  const e2 = Math.exp(2 * number)\n\n  return (e2 + 1) / (e2 - 1)\n}\n\nexport function CSC(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number === 0) {\n    return error.div0\n  }\n\n  return 1 / Math.sin(number)\n}\n\nexport function CSCH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number === 0) {\n    return error.div0\n  }\n\n  return 2 / (Math.exp(number) - Math.exp(-number))\n}\n\nexport function DECIMAL(number, radix) {\n  if (arguments.length < 1) {\n    return error.value\n  }\n\n  number = utils.parseNumber(number)\n  radix = utils.parseNumber(radix)\n  const anyError = utils.anyError(number, radix)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (radix === 0) {\n    return error.num\n  }\n\n  return parseInt(number, radix)\n}\n\nexport function DEGREES(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return (number * 180) / Math.PI\n}\n\nexport function EVEN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return CEILING(number, -2, -1)\n}\n\nexport function EXP(number) {\n  if (arguments.length < 1) {\n    return error.na\n  }\n\n  if (arguments.length > 1) {\n    return error.error\n  }\n\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  number = Math.exp(number)\n\n  return number\n}\n\nconst MEMOIZED_FACT = []\nexport function FACT(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  const n = Math.floor(number)\n\n  if (n === 0 || n === 1) {\n    return 1\n  } else if (MEMOIZED_FACT[n] > 0) {\n    return MEMOIZED_FACT[n]\n  } else {\n    MEMOIZED_FACT[n] = FACT(n - 1) * n\n\n    return MEMOIZED_FACT[n]\n  }\n}\n\nexport function FACTDOUBLE(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  const n = Math.floor(number)\n\n  if (n <= 0) {\n    return 1\n  } else {\n    return n * FACTDOUBLE(n - 2)\n  }\n}\n\nexport function FLOOR(number, significance) {\n  number = utils.parseNumber(number)\n  significance = utils.parseNumber(significance)\n  const anyError = utils.anyError(number, significance)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (significance === 0) {\n    return 0\n  }\n\n  if (!(number >= 0 && significance > 0) && !(number <= 0 && significance < 0)) {\n    return error.num\n  }\n\n  significance = Math.abs(significance)\n  const precision = -Math.floor(Math.log(significance) / Math.log(10))\n\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision)\n  } else {\n    return -ROUND(Math.ceil(Math.abs(number) / significance), precision)\n  }\n}\n\n// TODO: Verify\nFLOOR.MATH = (number, significance, mode) => {\n  if (significance instanceof Error) {\n    return significance\n  }\n\n  significance = significance === undefined ? 0 : significance\n\n  number = utils.parseNumber(number)\n  significance = utils.parseNumber(significance)\n  mode = utils.parseNumber(mode)\n  const anyError = utils.anyError(number, significance, mode)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (significance === 0) {\n    return 0\n  }\n\n  significance = significance ? Math.abs(significance) : 1\n  const precision = -Math.floor(Math.log(significance) / Math.log(10))\n\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision)\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision)\n  }\n\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision)\n}\n\n// Deprecated\nFLOOR.PRECISE = FLOOR.MATH\n\n// adapted http://rosettacode.org/wiki/Greatest_common_divisor#JavaScript\nexport function GCD() {\n  const range = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const n = range.length\n  const r0 = range[0]\n  let x = r0 < 0 ? -r0 : r0\n\n  for (let i = 1; i < n; i++) {\n    const ri = range[i]\n    let y = ri < 0 ? -ri : ri\n\n    while (x && y) {\n      if (x > y) {\n        x %= y\n      } else {\n        y %= x\n      }\n    }\n\n    x += y\n  }\n\n  return x\n}\n\nexport function INT(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return Math.floor(number)\n}\n\n// TODO: verify\nexport const ISO = {\n  CEILING: CEILING\n}\n\nexport function LCM() {\n  // Credits: Jonas Raoni Soares Silva\n  const o = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (o instanceof Error) {\n    return o\n  }\n\n  for (var i, j, n, d, r = 1; (n = o.pop()) !== undefined; ) {\n    if (n === 0) {\n      return 0\n    }\n\n    while (n > 1) {\n      if (n % 2) {\n        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\n          // empty\n        }\n\n        d = i <= j ? i : n\n      } else {\n        d = 2\n      }\n\n      for (n /= d, r *= d, i = o.length; i; o[--i] % d === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\n        // empty\n      }\n    }\n  }\n\n  return r\n}\n\nexport function LN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number === 0) {\n    return error.num\n  }\n\n  return Math.log(number)\n}\n\nexport function LN10() {\n  return Math.log(10)\n}\n\nexport function LN2() {\n  return Math.log(2)\n}\n\nexport function LOG10E() {\n  return Math.LOG10E\n}\n\nexport function LOG2E() {\n  return Math.LOG2E\n}\n\nexport function LOG(number, base) {\n  number = utils.parseNumber(number)\n  base = utils.parseNumber(base)\n  const anyError = utils.anyError(number, base)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (number === 0 || base === 0) {\n    return error.num\n  }\n\n  return Math.log(number) / Math.log(base)\n}\n\nexport function LOG10(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number === 0) {\n    return error.num\n  }\n\n  return Math.log(number) / Math.log(10)\n}\n\nexport function MOD(dividend, divisor) {\n  dividend = utils.parseNumber(dividend)\n  divisor = utils.parseNumber(divisor)\n  const anyError = utils.anyError(dividend, divisor)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (divisor === 0) {\n    return error.div0\n  }\n\n  let modulus = Math.abs(dividend % divisor)\n  modulus = dividend < 0 ? divisor - modulus : modulus\n\n  return divisor > 0 ? modulus : -modulus\n}\n\nexport function MROUND(number, multiple) {\n  number = utils.parseNumber(number)\n  multiple = utils.parseNumber(multiple)\n  const anyError = utils.anyError(number, multiple)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (number * multiple === 0) {\n    return 0\n  }\n\n  if (number * multiple < 0) {\n    return error.num\n  }\n\n  return Math.round(number / multiple) * multiple\n}\n\nexport function MULTINOMIAL() {\n  const args = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (args instanceof Error) {\n    return args\n  }\n\n  let sum = 0\n  let divisor = 1\n\n  for (let i = 0; i < args.length; i++) {\n    sum += args[i]\n    divisor *= FACT(args[i])\n  }\n\n  return FACT(sum) / divisor\n}\n\nexport function ODD(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  let temp = Math.ceil(Math.abs(number))\n  temp = temp & 1 ? temp : temp + 1\n\n  return number >= 0 ? temp : -temp\n}\n\nexport function PI() {\n  return Math.PI\n}\n\nexport function E() {\n  return Math.E\n}\n\nexport function POWER(number, power) {\n  number = utils.parseNumber(number)\n  power = utils.parseNumber(power)\n  const anyError = utils.anyError(number, power)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (number === 0 && power === 0) {\n    return error.num\n  }\n\n  const result = Math.pow(number, power)\n\n  if (isNaN(result)) {\n    return error.num\n  }\n\n  return result\n}\n\nexport function PRODUCT() {\n  const flatArguments = utils.flatten(arguments)\n  const flatArgumentsDefined = flatArguments.filter((arg) => arg !== undefined && arg !== null)\n\n  if (flatArgumentsDefined.length === 0) {\n    return 0\n  }\n\n  const args = utils.parseNumberArray(flatArgumentsDefined)\n\n  if (args instanceof Error) {\n    return args\n  }\n\n  let result = 1\n\n  for (let i = 0; i < args.length; i++) {\n    result *= args[i]\n  }\n\n  return result\n}\n\nexport function QUOTIENT(numerator, denominator) {\n  numerator = utils.parseNumber(numerator)\n  denominator = utils.parseNumber(denominator)\n  const anyError = utils.anyError(numerator, denominator)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return parseInt(numerator / denominator, 10)\n}\n\nexport function RADIANS(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return (number * Math.PI) / 180\n}\n\nexport function RAND() {\n  return Math.random()\n}\n\nexport function RANDBETWEEN(bottom, top) {\n  bottom = utils.parseNumber(bottom)\n  top = utils.parseNumber(top)\n  const anyError = utils.anyError(bottom, top)\n\n  if (anyError) {\n    return anyError\n  }\n  // Creative Commons Attribution 3.0 License\n  // Copyright (c) 2012 eqcode\n\n  return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1\n}\n\n// TODO\nexport function ROMAN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  // The MIT License\n  // Copyright (c) 2008 Steven Levithan\n  const digits = String(number).split('')\n  const key = [\n    '',\n    'C',\n    'CC',\n    'CCC',\n    'CD',\n    'D',\n    'DC',\n    'DCC',\n    'DCCC',\n    'CM',\n    '',\n    'X',\n    'XX',\n    'XXX',\n    'XL',\n    'L',\n    'LX',\n    'LXX',\n    'LXXX',\n    'XC',\n    '',\n    'I',\n    'II',\n    'III',\n    'IV',\n    'V',\n    'VI',\n    'VII',\n    'VIII',\n    'IX'\n  ]\n  let roman = ''\n  let i = 3\n\n  while (i--) {\n    roman = (key[+digits.pop() + i * 10] || '') + roman\n  }\n\n  return new Array(+digits.join('') + 1).join('M') + roman\n}\n\nexport function ROUND(number, digits) {\n  number = utils.parseNumber(number)\n  digits = utils.parseNumber(digits)\n  const anyError = utils.anyError(number, digits)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits)\n}\n\nexport function ROUNDDOWN(number, digits) {\n  number = utils.parseNumber(number)\n  digits = utils.parseNumber(digits)\n  const anyError = utils.anyError(number, digits)\n\n  if (anyError) {\n    return anyError\n  }\n\n  const sign = number > 0 ? 1 : -1\n\n  return (sign * Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits)\n}\n\nexport function ROUNDUP(number, digits) {\n  number = utils.parseNumber(number)\n  digits = utils.parseNumber(digits)\n  const anyError = utils.anyError(number, digits)\n\n  if (anyError) {\n    return anyError\n  }\n\n  const sign = number > 0 ? 1 : -1\n\n  return (sign * Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits)\n}\n\nexport function SEC(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return 1 / Math.cos(number)\n}\n\nexport function SECH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return 2 / (Math.exp(number) + Math.exp(-number))\n}\n\nexport function SERIESSUM(x, n, m, coefficients) {\n  x = utils.parseNumber(x)\n  n = utils.parseNumber(n)\n  m = utils.parseNumber(m)\n  coefficients = utils.parseNumberArray(coefficients)\n\n  if (utils.anyIsError(x, n, m, coefficients)) {\n    return error.value\n  }\n\n  let result = coefficients[0] * Math.pow(x, n)\n\n  for (let i = 1; i < coefficients.length; i++) {\n    result += coefficients[i] * Math.pow(x, n + i * m)\n  }\n\n  return result\n}\n\nexport function SIGN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number < 0) {\n    return -1\n  } else if (number === 0) {\n    return 0\n  } else {\n    return 1\n  }\n}\n\nexport function SIN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return Math.sin(number)\n}\n\nexport function SINH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return (Math.exp(number) - Math.exp(-number)) / 2\n}\n\nexport function SQRT(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  if (number < 0) {\n    return error.num\n  }\n\n  return Math.sqrt(number)\n}\n\nexport function SQRTPI(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return Math.sqrt(number * Math.PI)\n}\n\nexport function SQRT1_2() {\n  return 1 / Math.sqrt(2)\n}\n\nexport function SQRT2() {\n  return Math.sqrt(2)\n}\n\nexport function SUBTOTAL(function_code, ref1) {\n  function_code = utils.parseNumber(function_code)\n\n  if (function_code instanceof Error) {\n    return function_code\n  }\n\n  switch (function_code) {\n    case 1:\n      return statistical.AVERAGE(ref1)\n    case 2:\n      return statistical.COUNT(ref1)\n    case 3:\n      return statistical.COUNTA(ref1)\n    case 4:\n      return statistical.MAX(ref1)\n    case 5:\n      return statistical.MIN(ref1)\n    case 6:\n      return PRODUCT(ref1)\n    case 7:\n      return statistical.STDEV.S(ref1)\n    case 8:\n      return statistical.STDEV.P(ref1)\n    case 9:\n      return SUM(ref1)\n    case 10:\n      return statistical.VAR.S(ref1)\n    case 11:\n      return statistical.VAR.P(ref1)\n    // no hidden values for us\n    case 101:\n      return statistical.AVERAGE(ref1)\n    case 102:\n      return statistical.COUNT(ref1)\n    case 103:\n      return statistical.COUNTA(ref1)\n    case 104:\n      return statistical.MAX(ref1)\n    case 105:\n      return statistical.MIN(ref1)\n    case 106:\n      return PRODUCT(ref1)\n    case 107:\n      return statistical.STDEV.S(ref1)\n    case 108:\n      return statistical.STDEV.P(ref1)\n    case 109:\n      return SUM(ref1)\n    case 110:\n      return statistical.VAR.S(ref1)\n    case 111:\n      return statistical.VAR.P(ref1)\n  }\n}\n\nexport function ADD(num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  num1 = utils.parseNumber(num1)\n  num2 = utils.parseNumber(num2)\n  const anyError = utils.anyError(num1, num2)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return num1 + num2\n}\n\nexport function MINUS(num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  num1 = utils.parseNumber(num1)\n  num2 = utils.parseNumber(num2)\n  const anyError = utils.anyError(num1, num2)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return num1 - num2\n}\n\nexport function DIVIDE(dividend, divisor) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  dividend = utils.parseNumber(dividend)\n  divisor = utils.parseNumber(divisor)\n  const anyError = utils.anyError(dividend, divisor)\n\n  if (anyError) {\n    return anyError\n  }\n\n  if (divisor === 0) {\n    return error.div0\n  }\n\n  return dividend / divisor\n}\n\nexport function MULTIPLY(factor1, factor2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  factor1 = utils.parseNumber(factor1)\n  factor2 = utils.parseNumber(factor2)\n  const anyError = utils.anyError(factor1, factor2)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return factor1 * factor2\n}\n\nexport function GT(num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (num1 instanceof Error) {\n    return num1\n  }\n\n  if (num2 instanceof Error) {\n    return num2\n  }\n\n  if (utils.anyIsString(num1, num2)) {\n    num1 = utils.parseString(num1)\n    num2 = utils.parseString(num2)\n  } else {\n    num1 = utils.parseNumber(num1)\n    num2 = utils.parseNumber(num2)\n  }\n\n  const anyError = utils.anyError(num1, num2)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return num1 > num2\n}\n\nexport function GTE(num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (utils.anyIsString(num1, num2)) {\n    num1 = utils.parseString(num1)\n    num2 = utils.parseString(num2)\n  } else {\n    num1 = utils.parseNumber(num1)\n    num2 = utils.parseNumber(num2)\n  }\n\n  const anyError = utils.anyError(num1, num2)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return num1 >= num2\n}\n\nexport function LT(num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (utils.anyIsString(num1, num2)) {\n    num1 = utils.parseString(num1)\n    num2 = utils.parseString(num2)\n  } else {\n    num1 = utils.parseNumber(num1)\n    num2 = utils.parseNumber(num2)\n  }\n\n  const anyError = utils.anyError(num1, num2)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return num1 < num2\n}\n\nexport function LTE(num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (utils.anyIsString(num1, num2)) {\n    num1 = utils.parseString(num1)\n    num2 = utils.parseString(num2)\n  } else {\n    num1 = utils.parseNumber(num1)\n    num2 = utils.parseNumber(num2)\n  }\n\n  const anyError = utils.anyError(num1, num2)\n\n  if (anyError) {\n    return anyError\n  }\n\n  return num1 <= num2\n}\n\nexport function EQ(value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (value1 instanceof Error) {\n    return value1\n  }\n\n  if (value2 instanceof Error) {\n    return value2\n  }\n\n  if (value1 === null) {\n    value1 = undefined\n  }\n\n  if (value2 === null) {\n    value2 = undefined\n  }\n\n  return value1 === value2\n}\n\nexport function NE(value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  if (value1 instanceof Error) {\n    return value1\n  }\n\n  if (value2 instanceof Error) {\n    return value2\n  }\n\n  if (value1 === null) {\n    value1 = undefined\n  }\n\n  if (value2 === null) {\n    value2 = undefined\n  }\n\n  return value1 !== value2\n}\n\nexport function POW(base, exponent) {\n  if (arguments.length !== 2) {\n    return error.na\n  }\n\n  return POWER(base, exponent)\n}\n\nexport function SUM() {\n  let result = 0\n\n  utils.arrayEach(utils.argsToArray(arguments), (value) => {\n    if (result instanceof Error) {\n      return false\n    } else if (value instanceof Error) {\n      result = value\n    } else if (typeof value === 'number') {\n      result += value\n    } else if (typeof value === 'string') {\n      const parsed = parseFloat(value)\n\n      !isNaN(parsed) && (result += parsed)\n    } else if (Array.isArray(value)) {\n      const inner_result = SUM.apply(null, value)\n\n      if (inner_result instanceof Error) {\n        result = inner_result\n      } else {\n        result += inner_result\n      }\n    }\n  })\n\n  return result\n}\n\nexport function SUMIF(range, criteria, sumRange) {\n  range = utils.flatten(range)\n\n  if (sumRange) {\n    sumRange = utils.flatten(sumRange)\n  } else {\n    sumRange = range\n  }\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  if (criteria === undefined || criteria === null || criteria instanceof Error) {\n    return 0\n  }\n\n  let result = 0\n  const isWildcard = criteria === '*'\n  const tokenizedCriteria = isWildcard ? null : evalExpression.parse(criteria + '')\n\n  for (let i = 0; i < range.length; i++) {\n    const value = range[i]\n    const sumValue = sumRange[i]\n\n    if (isWildcard) {\n      result += value\n    } else {\n      const tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria)\n\n      result += evalExpression.compute(tokens) ? sumValue : 0\n    }\n  }\n\n  return result\n}\n\nexport function SUMIFS() {\n  const args = utils.argsToArray(arguments)\n  const range = utils.parseNumberArray(utils.flatten(args.shift()))\n\n  if (range instanceof Error) {\n    return range\n  }\n\n  const criterias = args\n  const criteriaLength = criterias.length / 2\n\n  for (let i = 0; i < criteriaLength; i++) {\n    criterias[i * 2] = utils.flatten(criterias[i * 2])\n  }\n\n  let result = 0\n\n  for (let i = 0; i < range.length; i++) {\n    let isMeetCondition = false\n\n    for (let j = 0; j < criteriaLength; j++) {\n      const valueToTest = criterias[j * 2][i]\n      const criteria = criterias[j * 2 + 1]\n      const isWildcard = criteria === void 0 || criteria === '*'\n      let computedResult = false\n\n      if (isWildcard) {\n        computedResult = true\n      } else {\n        const tokenizedCriteria = evalExpression.parse(criteria + '')\n        const tokens = [evalExpression.createToken(valueToTest, evalExpression.TOKEN_TYPE_LITERAL)].concat(\n          tokenizedCriteria\n        )\n\n        computedResult = evalExpression.compute(tokens)\n      }\n\n      // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition\n      if (!computedResult) {\n        isMeetCondition = false\n        break\n      }\n\n      isMeetCondition = true\n    }\n\n    if (isMeetCondition) {\n      result += range[i]\n    }\n  }\n\n  return result\n}\n\nexport function SUMPRODUCT() {\n  if (!arguments || arguments.length === 0) {\n    return error.value\n  }\n\n  const arrays = arguments.length + 1\n  let result = 0\n  let product\n  let k\n  let _i\n  let _ij\n\n  for (let i = 0; i < arguments[0].length; i++) {\n    if (!(arguments[0][i] instanceof Array)) {\n      product = 1\n\n      for (k = 1; k < arrays; k++) {\n        const _i_arg = arguments[k - 1][i]\n\n        if (_i_arg instanceof Error) {\n          return _i_arg\n        }\n\n        _i = utils.parseNumber(_i_arg)\n\n        if (_i instanceof Error) {\n          return _i\n        }\n\n        product *= _i\n      }\n\n      result += product\n    } else {\n      for (let j = 0; j < arguments[0][i].length; j++) {\n        product = 1\n\n        for (k = 1; k < arrays; k++) {\n          const _ij_arg = arguments[k - 1][i][j]\n\n          if (_ij_arg instanceof Error) {\n            return _ij_arg\n          }\n\n          _ij = utils.parseNumber(_ij_arg)\n\n          if (_ij instanceof Error) {\n            return _ij\n          }\n\n          product *= _ij\n        }\n\n        result += product\n      }\n    }\n  }\n\n  return result\n}\n\nexport function SUMSQ() {\n  const numbers = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (numbers instanceof Error) {\n    return numbers\n  }\n\n  let result = 0\n  const length = numbers.length\n\n  for (let i = 0; i < length; i++) {\n    result += information.ISNUMBER(numbers[i]) ? numbers[i] * numbers[i] : 0\n  }\n\n  return result\n}\n\nexport function SUMX2MY2(array_x, array_y) {\n  array_x = utils.parseNumberArray(utils.flatten(array_x))\n  array_y = utils.parseNumberArray(utils.flatten(array_y))\n\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value\n  }\n\n  let result = 0\n\n  for (let i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] - array_y[i] * array_y[i]\n  }\n\n  return result\n}\n\nexport function SUMX2PY2(array_x, array_y) {\n  array_x = utils.parseNumberArray(utils.flatten(array_x))\n  array_y = utils.parseNumberArray(utils.flatten(array_y))\n\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value\n  }\n\n  let result = 0\n  array_x = utils.parseNumberArray(utils.flatten(array_x))\n  array_y = utils.parseNumberArray(utils.flatten(array_y))\n\n  for (let i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] + array_y[i] * array_y[i]\n  }\n\n  return result\n}\n\nexport function SUMXMY2(array_x, array_y) {\n  array_x = utils.parseNumberArray(utils.flatten(array_x))\n  array_y = utils.parseNumberArray(utils.flatten(array_y))\n\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value\n  }\n\n  let result = 0\n  array_x = utils.flatten(array_x)\n  array_y = utils.flatten(array_y)\n\n  for (let i = 0; i < array_x.length; i++) {\n    result += Math.pow(array_x[i] - array_y[i], 2)\n  }\n\n  return result\n}\n\nexport function TAN(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  return Math.tan(number)\n}\n\nexport function TANH(number) {\n  number = utils.parseNumber(number)\n\n  if (number instanceof Error) {\n    return number\n  }\n\n  const e2 = Math.exp(2 * number)\n\n  return (e2 - 1) / (e2 + 1)\n}\n\nexport function TRUNC(number, digits) {\n  number = utils.parseNumber(number)\n  digits = utils.parseNumber(digits)\n  const anyError = utils.anyError(number, digits)\n\n  if (anyError) {\n    return anyError\n  }\n\n  const sign = number > 0 ? 1 : -1\n\n  return (sign * Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits)\n}\n","import * as dateTime from './date-time.js'\nimport * as engineering from './engineering.js'\nimport * as mathTrig from './math-trig.js'\nimport * as statistical from './statistical.js'\n\nexport const BETADIST = statistical.BETA.DIST\nexport const BETAINV = statistical.BETA.INV\nexport const BINOMDIST = statistical.BINOM.DIST\nexport const CEILINGMATH = mathTrig.CEILING.MATH\nexport const CEILINGPRECISE = mathTrig.CEILING.PRECISE\nexport const CHIDIST = statistical.CHISQ.DIST\nexport const CHIDISTRT = statistical.CHISQ.DIST.RT\nexport const CHIINV = statistical.CHISQ.INV\nexport const CHIINVRT = statistical.CHISQ.INV.RT\nexport const CHITEST = statistical.CHISQ.TEST\nexport const COVAR = statistical.COVARIANCE.P\nexport const COVARIANCEP = statistical.COVARIANCE.P\nexport const COVARIANCES = statistical.COVARIANCE.S\nexport const CRITBINOM = statistical.BINOM.INV\nexport const ERFCPRECISE = engineering.ERFC.PRECISE\nexport const ERFPRECISE = engineering.ERF.PRECISE\nexport const EXPONDIST = statistical.EXPON.DIST\nexport const FDIST = statistical.F.DIST\nexport const FDISTRT = statistical.F.DIST.RT\nexport const FINV = statistical.F.INV\nexport const FINVRT = statistical.F.INV.RT\nexport const FLOORMATH = mathTrig.FLOOR.MATH\nexport const FLOORPRECISE = mathTrig.FLOOR.PRECISE\nexport const FTEST = statistical.F.TEST\nexport const GAMMADIST = statistical.GAMMA.DIST\nexport const GAMMAINV = statistical.GAMMA.INV\nexport const GAMMALNPRECISE = statistical.GAMMALN.PRECISE\nexport const HYPGEOMDIST = statistical.HYPGEOM.DIST\nexport const LOGINV = statistical.LOGNORM.INV\nexport const LOGNORMDIST = statistical.LOGNORM.DIST\nexport const LOGNORMINV = statistical.LOGNORM.INV\nexport const MODEMULT = statistical.MODE.MULT\nexport const MODESNGL = statistical.MODE.SNGL\nexport const NEGBINOMDIST = statistical.NEGBINOM.DIST\nexport const NETWORKDAYSINTL = dateTime.NETWORKDAYS.INTL\nexport const NORMDIST = statistical.NORM.DIST\nexport const NORMINV = statistical.NORM.INV\nexport const NORMSDIST = statistical.NORM.S.DIST\nexport const NORMSINV = statistical.NORM.S.INV\nexport const PERCENTILEEXC = statistical.PERCENTILE.EXC\nexport const PERCENTILEINC = statistical.PERCENTILE.INC\nexport const PERCENTRANKEXC = statistical.PERCENTRANK.EXC\nexport const PERCENTRANKINC = statistical.PERCENTRANK.INC\nexport const POISSONDIST = statistical.POISSON.DIST\nexport const QUARTILEEXC = statistical.QUARTILE.EXC\nexport const QUARTILEINC = statistical.QUARTILE.INC\nexport const RANKAVG = statistical.RANK.AVG\nexport const RANKEQ = statistical.RANK.EQ\nexport const SKEWP = statistical.SKEW.P\nexport const STDEVP = statistical.STDEV.P\nexport const STDEVS = statistical.STDEV.S\nexport const TDIST = statistical.T.DIST\nexport const TDISTRT = statistical.T.DIST.RT\nexport const TINV = statistical.T.INV\nexport const TTEST = statistical.T.TEST\nexport const VARP = statistical.VAR.P\nexport const VARS = statistical.VAR.S\nexport const WEIBULLDIST = statistical.WEIBULL.DIST\nexport const WORKDAYINTL = dateTime.WORKDAY.INTL\nexport const ZTEST = statistical.Z.TEST\n","import * as error from './utils/error.js'\nimport * as evalExpression from './utils/criteria-eval.js'\nimport * as maths from './math-trig.js'\nimport * as stats from './statistical.js'\nimport * as utils from './utils/common.js'\n\nfunction compact(array) {\n  const result = []\n\n  utils.arrayEach(array, (value) => {\n    if (value) {\n      result.push(value)\n    }\n  })\n\n  return result\n}\n\nexport function FINDFIELD(database, title) {\n  let index = null\n\n  utils.arrayEach(database, (value, i) => {\n    if (value[0] === title) {\n      index = i\n\n      return false\n    }\n  })\n\n  // Return error if the input field title is incorrect\n  if (index == null) {\n    return error.value\n  }\n\n  return index\n}\n\nfunction findResultIndex(database, criterias) {\n  const matches = {}\n\n  for (let i = 1; i < database[0].length; ++i) {\n    matches[i] = true\n  }\n\n  let maxCriteriaLength = criterias[0].length\n\n  for (let i = 1; i < criterias.length; ++i) {\n    if (criterias[i].length > maxCriteriaLength) {\n      maxCriteriaLength = criterias[i].length\n    }\n  }\n\n  for (let k = 1; k < database.length; ++k) {\n    for (let l = 1; l < database[k].length; ++l) {\n      let currentCriteriaResult = false\n      let hasMatchingCriteria = false\n\n      for (let j = 0; j < criterias.length; ++j) {\n        const criteria = criterias[j]\n\n        if (criteria.length < maxCriteriaLength) {\n          continue\n        }\n\n        const criteriaField = criteria[0]\n\n        if (database[k][0] !== criteriaField) {\n          continue\n        }\n\n        hasMatchingCriteria = true\n\n        for (let p = 1; p < criteria.length; ++p) {\n          if (!currentCriteriaResult) {\n            const isWildcard = criteria[p] === void 0 || criteria[p] === '*'\n\n            if (isWildcard) {\n              currentCriteriaResult = true\n            } else {\n              const tokenizedCriteria = evalExpression.parse(criteria[p] + '')\n              const tokens = [evalExpression.createToken(database[k][l], evalExpression.TOKEN_TYPE_LITERAL)].concat(\n                tokenizedCriteria\n              )\n\n              currentCriteriaResult = evalExpression.compute(tokens)\n            }\n          }\n        }\n      }\n\n      if (hasMatchingCriteria) {\n        matches[l] = matches[l] && currentCriteriaResult\n      }\n    }\n  }\n\n  const result = []\n\n  for (let n = 0; n < database[0].length; ++n) {\n    if (matches[n]) {\n      result.push(n - 1)\n    }\n  }\n\n  return result\n}\n\n// Database functions\nexport function DAVERAGE(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  let sum = 0\n\n  utils.arrayEach(resultIndexes, (value) => {\n    sum += targetFields[value]\n  })\n\n  return resultIndexes.length === 0 ? error.div0 : sum / resultIndexes.length\n}\n\nexport function DCOUNT(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  const targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n\n  return stats.COUNT(targetValues)\n}\n\nexport function DCOUNTA(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  const targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n\n  return stats.COUNTA(targetValues)\n}\n\nexport function DGET(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  // Return error if no record meets the criteria\n  if (resultIndexes.length === 0) {\n    return error.value\n  }\n  // Returns the #NUM! error value because more than one record meets the\n  // criteria\n  if (resultIndexes.length > 1) {\n    return error.num\n  }\n\n  return targetFields[resultIndexes[0]]\n}\n\nexport function DMAX(database, field, criteria) {\n  // Return error if field is not a number and not a string\n\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  let maxValue = targetFields[resultIndexes[0]]\n\n  utils.arrayEach(resultIndexes, (value) => {\n    if (maxValue < targetFields[value]) {\n      maxValue = targetFields[value]\n    }\n  })\n\n  return maxValue\n}\n\nexport function DMIN(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  let minValue = targetFields[resultIndexes[0]]\n\n  utils.arrayEach(resultIndexes, (value) => {\n    if (minValue > targetFields[value]) {\n      minValue = targetFields[value]\n    }\n  })\n\n  return minValue\n}\n\nexport function DPRODUCT(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  let targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n  targetValues = compact(targetValues)\n\n  let result = 1\n\n  utils.arrayEach(targetValues, (value) => {\n    result *= value\n  })\n\n  return result\n}\n\nexport function DSTDEV(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  let targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n\n  targetValues = compact(targetValues)\n\n  return stats.STDEV.S(targetValues)\n}\n\nexport function DSTDEVP(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  let targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n\n  targetValues = compact(targetValues)\n\n  return stats.STDEV.P(targetValues)\n}\n\nexport function DSUM(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  const targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n\n  return maths.SUM(targetValues)\n}\n\nexport function DVAR(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  const targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n\n  return stats.VAR.S(targetValues)\n}\n\nexport function DVARP(database, field, criteria) {\n  // Return error if field is not a number and not a string\n\n  if (isNaN(field) && typeof field !== 'string') {\n    return error.value\n  }\n\n  const resultIndexes = findResultIndex(database, criteria)\n  let targetFields = []\n\n  if (typeof field === 'string') {\n    const index = FINDFIELD(database, field)\n    targetFields = utils.rest(database[index])\n  } else {\n    targetFields = utils.rest(database[field])\n  }\n\n  const targetValues = []\n\n  utils.arrayEach(resultIndexes, (value) => {\n    targetValues.push(targetFields[value])\n  })\n\n  return stats.VAR.P(targetValues)\n}\n","import * as error from './utils/error.js'\nimport * as dateTime from './date-time.js'\nimport * as utils from './utils/common.js'\n\nfunction validDate(d) {\n  return d && d.getTime && !isNaN(d.getTime())\n}\n\nfunction ensureDate(d) {\n  return d instanceof Date ? d : new Date(d)\n}\n\nexport function ACCRINT(issue, first, settlement, rate, par, frequency, basis) {\n  // Return error if either date is invalid\n  issue = ensureDate(issue)\n  first = ensureDate(first)\n  settlement = ensureDate(settlement)\n\n  if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\n    return error.value\n  }\n\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num\n  }\n\n  // Return error if frequency is neither 1, 2, or 4\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num\n  }\n\n  // Return error if basis is neither 0, 1, 2, 3, or 4\n  if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\n    return error.num\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num\n  }\n\n  // Set default values\n  par = par || 0\n  basis = basis || 0\n\n  // Compute accrued interest\n\n  return par * rate * dateTime.YEARFRAC(issue, settlement, basis)\n}\n\n// TODO\nexport function ACCRINTM() {\n  throw new Error('ACCRINTM is not implemented')\n}\n\n// TODO\nexport function AMORDEGRC() {\n  throw new Error('AMORDEGRC is not implemented')\n}\n\n// TODO\nexport function AMORLINC() {\n  throw new Error('AMORLINC is not implemented')\n}\n\n// TODO\nexport function COUPDAYBS() {\n  throw new Error('COUPDAYBS is not implemented')\n}\n\n// TODO\nexport function COUPDAYS() {\n  throw new Error('COUPDAYS is not implemented')\n}\n\n// TODO\nexport function COUPDAYSNC() {\n  throw new Error('COUPDAYSNC is not implemented')\n}\n\n// TODO\nexport function COUPNCD() {\n  throw new Error('COUPNCD is not implemented')\n}\n\n// TODO\nexport function COUPNUM() {\n  throw new Error('COUPNUM is not implemented')\n}\n\n// TODO\nexport function COUPPCD() {\n  throw new Error('COUPPCD is not implemented')\n}\n\nexport function CUMIPMT(rate, periods, value, start, end, type) {\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n  value = utils.parseNumber(value)\n\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value\n  }\n\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num\n  }\n\n  if (start < 1 || end < 1 || start > end) {\n    return error.num\n  }\n\n  if (type !== 0 && type !== 1) {\n    return error.num\n  }\n\n  const payment = PMT(rate, periods, value, 0, type)\n  let interest = 0\n\n  if (start === 1) {\n    if (type === 0) {\n      interest = -value\n    }\n\n    start++\n  }\n\n  for (let i = start; i <= end; i++) {\n    if (type === 1) {\n      interest += FV(rate, i - 2, payment, value, 1) - payment\n    } else {\n      interest += FV(rate, i - 1, payment, value, 0)\n    }\n  }\n\n  interest *= rate\n\n  return interest\n}\n\nexport function CUMPRINC(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n  value = utils.parseNumber(value)\n\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num\n  }\n\n  // Compute cumulative principal\n  const payment = PMT(rate, periods, value, 0, type)\n  let principal = 0\n\n  if (start === 1) {\n    if (type === 0) {\n      principal = payment + value * rate\n    } else {\n      principal = payment\n    }\n\n    start++\n  }\n\n  for (let i = start; i <= end; i++) {\n    if (type > 0) {\n      principal += payment - (FV(rate, i - 2, payment, value, 1) - payment) * rate\n    } else {\n      principal += payment - FV(rate, i - 1, payment, value, 0) * rate\n    }\n  }\n\n  // Return cumulative principal\n\n  return principal\n}\n\nexport function DB(cost, salvage, life, period, month) {\n  // Initialize month\n  month = month === undefined ? 12 : month\n\n  cost = utils.parseNumber(cost)\n  salvage = utils.parseNumber(salvage)\n  life = utils.parseNumber(life)\n  period = utils.parseNumber(period)\n  month = utils.parseNumber(month)\n\n  if (utils.anyIsError(cost, salvage, life, period, month)) {\n    return error.value\n  }\n\n  // Return error if any of the parameters is negative\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\n    return error.num\n  }\n\n  // Return error if month is not an integer between 1 and 12\n  if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\n    return error.num\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0\n  }\n\n  // Rate is rounded to three decimals places\n  const rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3)\n\n  // Compute initial depreciation\n  const initial = (cost * rate * month) / 12\n\n  // Compute total depreciation\n  let total = initial\n  let current = 0\n  const ceiling = period === life ? life - 1 : period\n\n  for (let i = 2; i <= ceiling; i++) {\n    current = (cost - total) * rate\n    total += current\n  }\n\n  // Depreciation for the first and last periods are special cases\n  if (period === 1) {\n    // First period\n    return initial\n  } else if (period === life) {\n    // Last period\n\n    return (cost - total) * rate\n  } else {\n    return current\n  }\n}\n\nexport function DDB(cost, salvage, life, period, factor) {\n  // Initialize factor\n  factor = factor === undefined ? 2 : factor\n\n  cost = utils.parseNumber(cost)\n  salvage = utils.parseNumber(salvage)\n  life = utils.parseNumber(life)\n  period = utils.parseNumber(period)\n  factor = utils.parseNumber(factor)\n\n  if (utils.anyIsError(cost, salvage, life, period, factor)) {\n    return error.value\n  }\n\n  // Return error if any of the parameters is negative or if factor is null\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\n    return error.num\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0\n  }\n\n  // Compute depreciation\n  let total = 0\n  let current = 0\n\n  for (let i = 1; i <= period; i++) {\n    current = Math.min((cost - total) * (factor / life), cost - salvage - total)\n    total += current\n  }\n\n  // Return depreciation\n  return current\n}\n\n// TODO\nexport function DISC() {\n  throw new Error('DISC is not implemented')\n}\n\nexport function DOLLARDE(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  dollar = utils.parseNumber(dollar)\n  fraction = utils.parseNumber(fraction)\n\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10)\n\n  // Compute integer part\n  let result = parseInt(dollar, 10)\n\n  // Add decimal part\n  result += ((dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10))) / fraction\n\n  // Round result\n  const power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1)\n  result = Math.round(result * power) / power\n\n  // Return converted dollar price\n  return result\n}\n\nexport function DOLLARFR(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  dollar = utils.parseNumber(dollar)\n  fraction = utils.parseNumber(fraction)\n\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10)\n\n  // Compute integer part\n  let result = parseInt(dollar, 10)\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction\n\n  // Return converted dollar price\n  return result\n}\n\n// TODO\nexport function DURATION() {\n  throw new Error('DURATION is not implemented')\n}\n\nexport function EFFECT(rate, periods) {\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n\n  if (utils.anyIsError(rate, periods)) {\n    return error.value\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10)\n\n  // Return effective annual interest rate\n  return Math.pow(1 + rate / periods, periods) - 1\n}\n\nexport function FV(rate, periods, payment, value, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  value = value || 0\n  type = type || 0\n\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n  payment = utils.parseNumber(payment)\n  value = utils.parseNumber(value)\n  type = utils.parseNumber(type)\n\n  if (utils.anyIsError(rate, periods, payment, value, type)) {\n    return error.value\n  }\n\n  // Return future value\n  let result\n\n  if (rate === 0) {\n    result = value + payment * periods\n  } else {\n    const term = Math.pow(1 + rate, periods)\n\n    if (type === 1) {\n      result = value * term + (payment * (1 + rate) * (term - 1)) / rate\n    } else {\n      result = value * term + (payment * (term - 1)) / rate\n    }\n  }\n\n  return -result\n}\n\nexport function FVSCHEDULE(principal, schedule) {\n  principal = utils.parseNumber(principal)\n  schedule = utils.parseNumberArray(utils.flatten(schedule))\n\n  if (utils.anyIsError(principal, schedule)) {\n    return error.value\n  }\n\n  const n = schedule.length\n  let future = principal\n\n  // Apply all interests in schedule\n\n  for (let i = 0; i < n; i++) {\n    // Apply scheduled interest\n    future *= 1 + schedule[i]\n  }\n\n  // Return future value\n  return future\n}\n\n// TODO\nexport function INTRATE() {\n  throw new Error('INTRATE is not implemented')\n}\n\nexport function IPMT(rate, period, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  future = future || 0\n  type = type || 0\n\n  rate = utils.parseNumber(rate)\n  period = utils.parseNumber(period)\n  periods = utils.parseNumber(periods)\n  present = utils.parseNumber(present)\n  future = utils.parseNumber(future)\n  type = utils.parseNumber(type)\n\n  if (utils.anyIsError(rate, period, periods, present, future, type)) {\n    return error.value\n  }\n\n  // Compute payment\n  const payment = PMT(rate, periods, present, future, type)\n\n  // Compute interest\n  let interest\n\n  if (period === 1) {\n    if (type === 1) {\n      interest = 0\n    } else {\n      interest = -present\n    }\n  } else {\n    if (type === 1) {\n      interest = FV(rate, period - 2, payment, present, 1) - payment\n    } else {\n      interest = FV(rate, period - 1, payment, present, 0)\n    }\n  }\n\n  // Return interest\n  return interest * rate\n}\n\nexport function IRR(values, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  guess = guess || 0\n\n  values = utils.parseNumberArray(utils.flatten(values))\n  guess = utils.parseNumber(guess)\n\n  if (utils.anyIsError(values, guess)) {\n    return error.value\n  }\n\n  // Calculates the resulting amount\n  const irrResult = (values, dates, rate) => {\n    const r = rate + 1\n    let result = values[0]\n\n    for (let i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365)\n    }\n\n    return result\n  }\n\n  // Calculates the first derivation\n  const irrResultDeriv = (values, dates, rate) => {\n    const r = rate + 1\n    let result = 0\n\n    for (let i = 1; i < values.length; i++) {\n      const frac = (dates[i] - dates[0]) / 365\n      result -= (frac * values[i]) / Math.pow(r, frac + 1)\n    }\n\n    return result\n  }\n\n  // Initialize dates and check that values contains at least one positive value and one negative value\n  const dates = []\n  let positive = false\n  let negative = false\n\n  for (let i = 0; i < values.length; i++) {\n    dates[i] = i === 0 ? 0 : dates[i - 1] + 365\n\n    if (values[i] > 0) {\n      positive = true\n    }\n\n    if (values[i] < 0) {\n      negative = true\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num\n  }\n\n  // Initialize guess and resultRate\n  guess = guess === undefined ? 0.1 : guess\n  let resultRate = guess\n\n  // Set maximum epsilon for end of iteration\n  const epsMax = 1e-10\n\n  // Implement Newton's method\n  let newRate, epsRate, resultValue\n  let contLoop = true\n  do {\n    resultValue = irrResult(values, dates, resultRate)\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate)\n    epsRate = Math.abs(newRate - resultRate)\n    resultRate = newRate\n    contLoop = epsRate > epsMax && Math.abs(resultValue) > epsMax\n  } while (contLoop)\n\n  // Return internal rate of return\n  return resultRate\n}\n\nexport function ISPMT(rate, period, periods, value) {\n  rate = utils.parseNumber(rate)\n  period = utils.parseNumber(period)\n  periods = utils.parseNumber(periods)\n  value = utils.parseNumber(value)\n\n  if (utils.anyIsError(rate, period, periods, value)) {\n    return error.value\n  }\n\n  // Return interest\n  return value * rate * (period / periods - 1)\n}\n\n// TODO\nexport function MDURATION() {\n  throw new Error('MDURATION is not implemented')\n}\n\nexport function MIRR(values, finance_rate, reinvest_rate) {\n  values = utils.parseNumberArray(utils.flatten(values))\n  finance_rate = utils.parseNumber(finance_rate)\n  reinvest_rate = utils.parseNumber(reinvest_rate)\n\n  if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\n    return error.value\n  }\n\n  // Initialize number of values\n  const n = values.length\n\n  // Lookup payments (negative values) and incomes (positive values)\n  const payments = []\n  const incomes = []\n\n  for (let i = 0; i < n; i++) {\n    if (values[i] < 0) {\n      payments.push(values[i])\n    } else {\n      incomes.push(values[i])\n    }\n  }\n\n  // Return modified internal rate of return\n  const num = -NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1)\n  const den = NPV(finance_rate, payments) * (1 + finance_rate)\n\n  return Math.pow(num / den, 1 / (n - 1)) - 1\n}\n\nexport function NOMINAL(rate, periods) {\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n\n  if (utils.anyIsError(rate, periods)) {\n    return error.value\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10)\n\n  // Return nominal annual interest rate\n  return (Math.pow(rate + 1, 1 / periods) - 1) * periods\n}\n\nexport function NPER(rate, payment, present, future, type) {\n  type = type === undefined ? 0 : type\n  future = future === undefined ? 0 : future\n\n  rate = utils.parseNumber(rate)\n  payment = utils.parseNumber(payment)\n  present = utils.parseNumber(present)\n  future = utils.parseNumber(future)\n  type = utils.parseNumber(type)\n\n  if (utils.anyIsError(rate, payment, present, future, type)) {\n    return error.value\n  }\n\n  if (rate === 0) {\n    return -(present + future) / payment\n  } else {\n    const num = payment * (1 + rate * type) - future * rate\n    const den = present * rate + payment * (1 + rate * type)\n\n    return Math.log(num / den) / Math.log(1 + rate)\n  }\n}\n\nexport function NPV() {\n  const args = utils.parseNumberArray(utils.flatten(arguments))\n\n  if (args instanceof Error) {\n    return args\n  }\n\n  // Lookup rate\n  const rate = args[0]\n\n  // Initialize net present value\n  let value = 0\n\n  // Loop on all values\n\n  for (let j = 1; j < args.length; j++) {\n    value += args[j] / Math.pow(1 + rate, j)\n  }\n\n  // Return net present value\n  return value\n}\n\n// TODO\nexport function ODDFPRICE() {\n  throw new Error('ODDFPRICE is not implemented')\n}\n\n// TODO\nexport function ODDFYIELD() {\n  throw new Error('ODDFYIELD is not implemented')\n}\n\n// TODO\nexport function ODDLPRICE() {\n  throw new Error('ODDLPRICE is not implemented')\n}\n\n// TODO\nexport function ODDLYIELD() {\n  throw new Error('ODDLYIELD is not implemented')\n}\n\nexport function PDURATION(rate, present, future) {\n  rate = utils.parseNumber(rate)\n  present = utils.parseNumber(present)\n  future = utils.parseNumber(future)\n\n  if (utils.anyIsError(rate, present, future)) {\n    return error.value\n  }\n\n  // Return error if rate <=0\n  if (rate <= 0) {\n    return error.num\n  }\n\n  // Return number of periods\n  return (Math.log(future) - Math.log(present)) / Math.log(1 + rate)\n}\n\nexport function PMT(rate, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  future = future || 0\n  type = type || 0\n\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n  present = utils.parseNumber(present)\n  future = utils.parseNumber(future)\n  type = utils.parseNumber(type)\n\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value\n  }\n\n  // Return payment\n  let result\n\n  if (rate === 0) {\n    result = (present + future) / periods\n  } else {\n    const term = Math.pow(1 + rate, periods)\n\n    if (type === 1) {\n      result = ((future * rate) / (term - 1) + (present * rate) / (1 - 1 / term)) / (1 + rate)\n    } else {\n      result = (future * rate) / (term - 1) + (present * rate) / (1 - 1 / term)\n    }\n  }\n\n  return -result\n}\n\nexport function PPMT(rate, period, periods, present, future, type) {\n  future = future || 0\n  type = type || 0\n\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n  present = utils.parseNumber(present)\n  future = utils.parseNumber(future)\n  type = utils.parseNumber(type)\n\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value\n  }\n\n  return PMT(rate, periods, present, future, type) - IPMT(rate, period, periods, present, future, type)\n}\n\n// TODO\nexport function PRICE() {\n  throw new Error('PRICE is not implemented')\n}\n\n// TODO\nexport function PRICEDISC() {\n  throw new Error('PRICEDISC is not implemented')\n}\n\n// TODO\nexport function PRICEMAT() {\n  throw new Error('PRICEMAT is not implemented')\n}\n\nexport function PV(rate, periods, payment, future, type) {\n  future = future || 0\n  type = type || 0\n\n  rate = utils.parseNumber(rate)\n  periods = utils.parseNumber(periods)\n  payment = utils.parseNumber(payment)\n  future = utils.parseNumber(future)\n  type = utils.parseNumber(type)\n\n  if (utils.anyIsError(rate, periods, payment, future, type)) {\n    return error.value\n  }\n\n  // Return present value\n  if (rate === 0) {\n    return -payment * periods - future\n  } else {\n    return (\n      (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods)\n    )\n  }\n}\n\nexport function RATE(periods, payment, present, future, type, guess) {\n  guess = guess === undefined ? 0.01 : guess\n  future = future === undefined ? 0 : future\n  type = type === undefined ? 0 : type\n\n  periods = utils.parseNumber(periods)\n  payment = utils.parseNumber(payment)\n  present = utils.parseNumber(present)\n  future = utils.parseNumber(future)\n  type = utils.parseNumber(type)\n  guess = utils.parseNumber(guess)\n\n  if (utils.anyIsError(periods, payment, present, future, type, guess)) {\n    return error.value\n  }\n\n  const epsMax = 1e-10\n  const iterMax = 20\n  let rate = guess\n\n  type = type ? 1 : 0\n\n  for (let i = 0; i < iterMax; i++) {\n    if (rate <= -1) {\n      return error.num\n    }\n\n    let y, f\n\n    if (Math.abs(rate) < epsMax) {\n      y = present * (1 + periods * rate) + payment * (1 + rate * type) * periods + future\n    } else {\n      f = Math.pow(1 + rate, periods)\n      y = present * f + payment * (1 / rate + type) * (f - 1) + future\n    }\n\n    if (Math.abs(y) < epsMax) {\n      return rate\n    }\n\n    let dy\n\n    if (Math.abs(rate) < epsMax) {\n      dy = present * periods + payment * type * periods\n    } else {\n      f = Math.pow(1 + rate, periods)\n      const df = periods * Math.pow(1 + rate, periods - 1)\n      dy = present * df + payment * (1 / rate + type) * df + payment * (-1 / (rate * rate)) * (f - 1)\n    }\n\n    rate -= y / dy\n  }\n\n  return rate\n}\n\n// TODO\nexport function RECEIVED() {\n  throw new Error('RECEIVED is not implemented')\n}\n\nexport function RRI(periods, present, future) {\n  periods = utils.parseNumber(periods)\n  present = utils.parseNumber(present)\n  future = utils.parseNumber(future)\n\n  if (utils.anyIsError(periods, present, future)) {\n    return error.value\n  }\n\n  // Return error if periods or present is equal to 0 (zero)\n  if (periods === 0 || present === 0) {\n    return error.num\n  }\n\n  // Return equivalent interest rate\n  return Math.pow(future / present, 1 / periods) - 1\n}\n\nexport function SLN(cost, salvage, life) {\n  cost = utils.parseNumber(cost)\n  salvage = utils.parseNumber(salvage)\n  life = utils.parseNumber(life)\n\n  if (utils.anyIsError(cost, salvage, life)) {\n    return error.value\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num\n  }\n\n  // Return straight-line depreciation\n  return (cost - salvage) / life\n}\n\nexport function SYD(cost, salvage, life, period) {\n  // Return error if any of the parameters is not a number\n  cost = utils.parseNumber(cost)\n  salvage = utils.parseNumber(salvage)\n  life = utils.parseNumber(life)\n  period = utils.parseNumber(period)\n\n  if (utils.anyIsError(cost, salvage, life, period)) {\n    return error.value\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num\n  }\n\n  // Return error if period is lower than 1 or greater than life\n  if (period < 1 || period > life) {\n    return error.num\n  }\n\n  // Truncate period if it is not an integer\n  period = parseInt(period, 10)\n\n  // Return straight-line depreciation\n  return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1))\n}\n\nexport function TBILLEQ(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement)\n  maturity = utils.parseDate(maturity)\n  discount = utils.parseNumber(discount)\n\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num\n  }\n\n  // Return bond-equivalent yield\n  return (365 * discount) / (360 - discount * dateTime.DAYS360(settlement, maturity, false))\n}\n\nexport function TBILLPRICE(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement)\n  maturity = utils.parseDate(maturity)\n  discount = utils.parseNumber(discount)\n\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num\n  }\n\n  // Return bond-equivalent yield\n  return 100 * (1 - (discount * dateTime.DAYS360(settlement, maturity, false)) / 360)\n}\n\nexport function TBILLYIELD(settlement, maturity, price) {\n  settlement = utils.parseDate(settlement)\n  maturity = utils.parseDate(maturity)\n  price = utils.parseNumber(price)\n\n  if (utils.anyIsError(settlement, maturity, price)) {\n    return error.value\n  }\n\n  // Return error if price is lower than or equal to zero\n  if (price <= 0) {\n    return error.num\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num\n  }\n\n  // Return bond-equivalent yield\n  return ((100 - price) * 360) / (price * dateTime.DAYS360(settlement, maturity, false))\n}\n\n// TODO\nexport function VDB() {\n  throw new Error('VDB is not implemented')\n}\n\nexport function XIRR(values, dates, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  values = utils.parseNumberArray(utils.flatten(values))\n  dates = utils.parseDateArray(utils.flatten(dates))\n  guess = utils.parseNumber(guess)\n\n  if (utils.anyIsError(values, dates, guess)) {\n    return error.value\n  }\n\n  // Calculates the resulting amount\n  const irrResult = (values, dates, rate) => {\n    const r = rate + 1\n    let result = values[0]\n\n    for (let i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, dateTime.DAYS(dates[i], dates[0]) / 365)\n    }\n\n    return result\n  }\n\n  // Calculates the first derivation\n  const irrResultDeriv = (values, dates, rate) => {\n    const r = rate + 1\n    let result = 0\n\n    for (let i = 1; i < values.length; i++) {\n      const frac = dateTime.DAYS(dates[i], dates[0]) / 365\n      result -= (frac * values[i]) / Math.pow(r, frac + 1)\n    }\n\n    return result\n  }\n\n  // Check that values contains at least one positive value and one negative value\n  let positive = false\n  let negative = false\n\n  for (let i = 0; i < values.length; i++) {\n    if (values[i] > 0) {\n      positive = true\n    }\n\n    if (values[i] < 0) {\n      negative = true\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num\n  }\n\n  // Initialize guess and resultRate\n  guess = guess || 0.1\n  let resultRate = guess\n\n  // Set maximum epsilon for end of iteration\n  const epsMax = 1e-10\n\n  // Implement Newton's method\n  let newRate, epsRate, resultValue\n  let contLoop = true\n\n  do {\n    resultValue = irrResult(values, dates, resultRate)\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate)\n    epsRate = Math.abs(newRate - resultRate)\n    resultRate = newRate\n    contLoop = epsRate > epsMax && Math.abs(resultValue) > epsMax\n  } while (contLoop)\n\n  // Return internal rate of return\n  return resultRate\n}\n\nexport function XNPV(rate, values, dates) {\n  rate = utils.parseNumber(rate)\n  values = utils.parseNumberArray(utils.flatten(values))\n  dates = utils.parseDateArray(utils.flatten(dates))\n\n  if (utils.anyIsError(rate, values, dates)) {\n    return error.value\n  }\n\n  let result = 0\n\n  for (let i = 0; i < values.length; i++) {\n    result += values[i] / Math.pow(1 + rate, dateTime.DAYS(dates[i], dates[0]) / 365)\n  }\n\n  return result\n}\n\n// TODO\nexport function YIELD() {\n  throw new Error('YIELD is not implemented')\n}\n\n// TODO\nexport function YIELDDISC() {\n  throw new Error('YIELDDISC is not implemented')\n}\n\n// TODO\nexport function YIELDMAT() {\n  throw new Error('YIELDMAT is not implemented')\n}\n","import * as error from './utils/error.js'\nimport * as utils from './utils/common.js'\n\nexport function MATCH(lookupValue, lookupArray, matchType) {\n  if (!lookupValue && !lookupArray) {\n    return error.na\n  }\n\n  if (arguments.length === 2) {\n    matchType = 1\n  }\n\n  if (!(lookupArray instanceof Array)) {\n    return error.na\n  }\n\n  lookupArray = utils.flatten(lookupArray)\n\n  if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n    return error.na\n  }\n\n  let index\n  let indexValue\n\n  for (let idx = 0; idx < lookupArray.length; idx++) {\n    if (matchType === 1) {\n      if (lookupArray[idx] === lookupValue) {\n        return idx + 1\n      } else if (lookupArray[idx] < lookupValue) {\n        if (!indexValue) {\n          index = idx + 1\n          indexValue = lookupArray[idx]\n        } else if (lookupArray[idx] > indexValue) {\n          index = idx + 1\n          indexValue = lookupArray[idx]\n        }\n      }\n    } else if (matchType === 0) {\n      if (typeof lookupValue === 'string') {\n        lookupValue = lookupValue.replace(/\\?/g, '.')\n\n        if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {\n          return idx + 1\n        }\n      } else {\n        if (lookupArray[idx] === lookupValue) {\n          return idx + 1\n        }\n      }\n    } else if (matchType === -1) {\n      if (lookupArray[idx] === lookupValue) {\n        return idx + 1\n      } else if (lookupArray[idx] > lookupValue) {\n        if (!indexValue) {\n          index = idx + 1\n          indexValue = lookupArray[idx]\n        } else if (lookupArray[idx] < indexValue) {\n          index = idx + 1\n          indexValue = lookupArray[idx]\n        }\n      }\n    }\n  }\n\n  return index || error.na\n}\n\nexport function VLOOKUP(needle, table, index, rangeLookup) {\n  if (!table || !index) {\n    return error.na\n  }\n\n  rangeLookup = !(rangeLookup === 0 || rangeLookup === false)\n  let result = error.na\n  const isNumberLookup = typeof needle === 'number'\n  let exactMatchOnly = false\n\n  for (let i = 0; i < table.length; i++) {\n    const row = table[i]\n\n    if (row[0] === needle) {\n      result = index < row.length + 1 ? row[index - 1] : error.ref\n      break\n    } else if (\n      !exactMatchOnly &&\n      ((isNumberLookup && rangeLookup && row[0] <= needle) ||\n        (rangeLookup && typeof row[0] === 'string' && row[0].localeCompare(needle) < 0))\n    ) {\n      result = index < row.length + 1 ? row[index - 1] : error.ref\n    }\n\n    if (isNumberLookup && row[0] > needle) {\n      exactMatchOnly = true\n    }\n  }\n\n  return result\n}\n\nexport function HLOOKUP(needle, table, index, rangeLookup) {\n  return VLOOKUP(needle, utils.transpose(table), index, rangeLookup)\n}\n\nexport function LOOKUP(searchCriterion, array, resultArray) {\n  array = utils.flatten(array)\n  resultArray = resultArray ? utils.flatten(resultArray) : array\n\n  const isNumberLookup = typeof searchCriterion === 'number'\n  let result = error.na\n\n  for (let i = 0; i < array.length; i++) {\n    if (array[i] === searchCriterion) {\n      return resultArray[i]\n    } else if (\n      (isNumberLookup && array[i] <= searchCriterion) ||\n      (typeof array[i] === 'string' && array[i].localeCompare(searchCriterion) < 0)\n    ) {\n      result = resultArray[i]\n    } else if (isNumberLookup && array[i] > searchCriterion) {\n      return result\n    }\n  }\n\n  return result\n}\n\nexport function INDEX(cellRange, rowNumber, columnNumber) {\n  const someError = utils.anyError(cellRange, rowNumber, columnNumber)\n\n  if (someError) {\n    return someError\n  }\n\n  if (!Array.isArray(cellRange)) {\n    return error.value\n  }\n\n  const isOneDimensionRange = cellRange.length > 0 && !Array.isArray(cellRange[0])\n\n  if (isOneDimensionRange && !columnNumber) {\n    columnNumber = rowNumber\n    rowNumber = 1\n  } else {\n    columnNumber = columnNumber || 1\n    rowNumber = rowNumber || 1\n  }\n\n  if (columnNumber < 0 || rowNumber < 0) {\n    return error.value\n  }\n\n  if (isOneDimensionRange && rowNumber === 1 && columnNumber <= cellRange.length) {\n    return cellRange[columnNumber - 1]\n  } else if (rowNumber <= cellRange.length && columnNumber <= cellRange[rowNumber - 1].length) {\n    return cellRange[rowNumber - 1][columnNumber - 1]\n  }\n\n  return error.ref\n}\n","import * as error from './utils/error.js'\nimport * as information from './information.js'\nimport * as utils from './utils/common.js'\n\nexport function AND() {\n  const args = utils.flatten(arguments)\n  let result = error.value\n\n  for (let i = 0; i < args.length; i++) {\n    if (args[i] instanceof Error) {\n      return args[i]\n    }\n\n    if (args[i] === undefined || args[i] === null || typeof args[i] === 'string') {\n      continue\n    }\n\n    if (result === error.value) {\n      result = true\n    }\n\n    if (!args[i]) {\n      result = false\n    }\n  }\n\n  return result\n}\n\nexport function CHOOSE() {\n  if (arguments.length < 2) {\n    return error.na\n  }\n\n  const index = arguments[0]\n\n  if (index < 1 || index > 254) {\n    return error.value\n  }\n\n  if (arguments.length < index + 1) {\n    return error.value\n  }\n\n  return arguments[index]\n}\n\nexport function FALSE() {\n  return false\n}\n\nexport function IF(test, then_value, otherwise_value) {\n  if (test instanceof Error) {\n    return test\n  }\n\n  then_value = arguments.length >= 2 ? then_value : true\n\n  if (then_value === undefined || then_value === null) {\n    then_value = 0\n  }\n\n  otherwise_value = arguments.length === 3 ? otherwise_value : false\n\n  if (otherwise_value === undefined || otherwise_value === null) {\n    otherwise_value = 0\n  }\n\n  return test ? then_value : otherwise_value\n}\n\nexport function IFS() {\n  for (let i = 0; i < arguments.length / 2; i++) {\n    if (arguments[i * 2]) {\n      return arguments[i * 2 + 1]\n    }\n  }\n\n  return error.na\n}\n\nexport function IFERROR(value, valueIfError) {\n  if (information.ISERROR(value)) {\n    return valueIfError\n  }\n\n  return value\n}\n\nexport function IFNA(value, value_if_na) {\n  return value === error.na ? value_if_na : value\n}\n\nexport function NOT(logical) {\n  if (typeof logical === 'string') {\n    return error.value\n  }\n\n  if (logical instanceof Error) {\n    return logical\n  }\n\n  return !logical\n}\n\nexport function OR() {\n  const args = utils.flatten(arguments)\n  let result = error.value\n\n  for (let i = 0; i < args.length; i++) {\n    if (args[i] instanceof Error) {\n      return args[i]\n    }\n\n    if (args[i] === undefined || args[i] === null || typeof args[i] === 'string') {\n      continue\n    }\n\n    if (result === error.value) {\n      result = false\n    }\n\n    if (args[i]) {\n      result = true\n    }\n  }\n\n  return result\n}\n\nexport function TRUE() {\n  return true\n}\n\nexport function XOR() {\n  const args = utils.flatten(arguments)\n  let result = error.value\n\n  for (let i = 0; i < args.length; i++) {\n    if (args[i] instanceof Error) {\n      return args[i]\n    }\n\n    if (args[i] === undefined || args[i] === null || typeof args[i] === 'string') {\n      continue\n    }\n\n    if (result === error.value) {\n      result = 0\n    }\n\n    if (args[i]) {\n      result++\n    }\n  }\n\n  if (result === error.value) {\n    return result\n  }\n\n  return !!(Math.floor(Math.abs(result)) & 1)\n}\n\nexport function SWITCH() {\n  let result\n\n  if (arguments.length > 0) {\n    const targetValue = arguments[0]\n    const argc = arguments.length - 1\n    const switchCount = Math.floor(argc / 2)\n    let switchSatisfied = false\n    const hasDefaultClause = argc % 2 !== 0\n    const defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1]\n\n    if (switchCount) {\n      for (let index = 0; index < switchCount; index++) {\n        if (targetValue === arguments[index * 2 + 1]) {\n          result = arguments[index * 2 + 2]\n          switchSatisfied = true\n          break\n        }\n      }\n    }\n\n    if (!switchSatisfied) {\n      result = hasDefaultClause ? defaultClause : error.na\n    }\n  } else {\n    result = error.value\n  }\n\n  return result\n}\n"],"names":["nil","Error","div0","value","ref","name","num","na","error","data","flattenShallow","array","reduce","a","b","aIsArray","Array","isArray","bIsArray","concat","push","isFlat","i","length","flatten","result","argsToArray","apply","arguments","args","arrayEach","numbers","possibleNumbers","filter","el","cleanFloat","number","power","Math","round","parseBool","bool","up","toUpperCase","Date","isNaN","error.value","parseNumber","string","parseFloat","parseString","toString","parseNumberArray","arr","len","parsed","parseDate","date","d","error.num","serial","utc_days","floor","date_info","fractional_day","total_seconds","seconds","hours","minutes","days","getDate","month","getMonth","getFullYear","serialNumberToDate","parseDateArray","anyError","n","isDefined","arg","anyIsError","anyIsString","arrayValuesToNumbers","rest","idx","slice","iteratee","index","d1900","UTC","WEEK_STARTS","undefined","WEEK_TYPES","WEEKEND_TYPES","startOfDay","newDate","setHours","DAYS","end_date","start_date","utils.parseDate","DAYS360","method","utils.parseBool","sd","ed","sm","em","smd","emd","ISOWEEKNUM","setDate","getDay","yearStart","ceil","NETWORKDAYS","holidays","INTL","WORKDAY","isLeapYear","year","daysBetween","YEARFRAC","basis","sy","ey","ylength","date1","date2","year1","mar1year1","year2","mar1year2","feb29Between","years","average","addOn","weekend","isMask","maskDays","maskIndex","maskRegex","RegExp","test","split","h","total","day","getTimezoneOffset","getUTCDay","dec","includes","j","holiday","utils.parseNumber","factory","BESSEL","version","M","_horner","v","z","_bessel_iter","x","f0","f1","sign","tdx","f2","o","_bessel_wrap","bessel0","bessel1","nonzero","Infinity","NaN","W","b0_a1a","b0_a2a","b0_a1b","b0_a2b","b1_a1a","b1_a2a","b1_a1b","b1_a2b","b0_a","b0_b","b1_a","b1_b","besselj","reverse","a1","a2","y","xx","sqrt","cos","sin","abs","isFinite","ret","jsum","bjp","sum","bj","bjm","tox","bessely","log","besseli","exp","bip","bi","bim","besselk","DO_NOT_EXPORT_BESSEL","exports","module","jStat","prototype","Object","calcRdx","m","val","pow","LOG10E","call","isFunction","isNumber","toVector","_init","retZero","retOne","retIdent","fn","map","this","seq","toArray","constructor","utils","_random_fn","random","setRandom","TypeError","extend","obj","rows","cols","dimensions","row","rowa","col","submat","arange","forEach","ind","column","cola","diag","nrow","res","antidiag","transpose","objArr","func","toAlter","ncol","cumreduce","alter","create","zeros","ones","rand","identity","symmetric","size","clear","min","max","cnt","hival","step","current","start","end","rl","_slice","list","copy","rcSlice","colSlice","rowSlice","sliceAssign","A","B","nl","ml","diagonal","diagArray","mat","t","jProto","sort","splice","funcs","passfunc","results","self","setTimeout","ascNum","clip","sumsqrd","sumsqerr","tmp","mean","sumrow","product","prod","low","high","unique","hash","_arr","meansqerr","geomean","median","arrlen","cumsum","cumprod","diff","diffs","arrLen","rank","distinctNumbers","numberCounts","sortedDistinctNumbers","numberRanks","currentRank","count","mode","maxCount","numMaxCount","mode_arr","range","variance","flag","pooledvariance","samples","deviation","dev","stdev","pooledstdev","meandev","meddev","coeffvar","quartiles","quantiles","quantilesArray","alphap","betap","p","aleph","k","gamma","sortedArray","quantileVals","percentile","exclusive","realIndex","parseInt","frac","percentileOfScore","score","kind","counter","strict","histogram","binCnt","first","binWidth","bins","covariance","arr1","arr2","u","arr1Len","sq_dev","corrcoeff","spearmancoeff","stanMoment","mu","sigma","skewSum","skewness","kurtosis","fullbool","tmpthis","callbackFunction","argsToPass","curriedFunction","vector","gammaln","cof","ser","loggam","x0","x2","xp","gl","gl0","PI","gammafn","yi","q","fact","xden","xnum","gammap","lowRegGamma","an","aln","ap","del","c","ITMAX","factorialln","factorial","combination","combinationln","permutation","betafn","betaln","betacf","m2","aa","fpmin","qab","qap","qam","gammapinv","pp","lna1","afac","EPS","gln","erf","ty","isneg","dd","erfc","erfcinv","err","ibetainv","lna","lnb","al","w","b1","ibeta","bt","randn","randg","shape","oalph","betinc","eps","c9","a0","b0","m9","laplaceSign","tukeyWprob","rr","cc","nleg","ihalf","C1","C2","C3","bb","wlar","wincr1","wincr2","xleg","aleg","qsqz","wincr","pr_w","normal","cdf","blb","binc","bub","einsum","cc1","wi","elsum","jj","ac","qexpo","rinsum","tukeyQinv","p0","q0","p1","q1","p2","q2","p3","q3","p4","q4","c1","c2","c3","c4","c5","vmax","ps","f","_a","_b","_c","newthis","sample","vals","fnfunc","beta","pdf","alpha","inv","centralF","df1","df2","binomial","cauchy","local","scale","atan","tan","chisquare","dof","exponential","rate","invgamma","kumaraswamy","lognormal","noncentralt","ncp","tol","studentt","min_iterations","flip","prob","lastvalue","std","pareto","SQRT2","dof2","weibull","uniform","betacdf","s","negbin","r","hypgeom","N","scaledPDF","samplesDone","scaledCDF","factor","poisson","l","sumarr","sampleSmall","L","sampleLarge","U","V","slam","loglam","invalpha","vr","us","lam","triangular","arcsine","asin","laplace","tukey","nmeans","df","nlegq","ihalfq","eps1","eps2","dhaf","dquar","deigh","dlarg","ulen1","ulen2","ulen3","ulen4","xlegq","alegq","Number","ulen","f2lf","f21","ff4","ans","otsum","twa1","t1","maxiter","x1","valx0","valx1","iter","isUsable","add","subtract","divide","multiply","nrescols","rescols","outer","dot","left","right","norm","nnorm","angle","acos","aug","newarr","gauss_jordan","det","alen","alend","rowshift","colshift","mrow","mcol","gauss_elimination","maug","pivot","temp","y2","maxrow","triaUpSolve","parts","matrix_mode","triaLowSolve","lu","R","cholesky","T","gauss_jacobi","xv","xk","gauss_seidel","SOR","householder","QR","qr2","lstsq","R_I","I","Aj","cAi","Ij","cIi","qr_solve","array_mode","Q","attrs","Q1","RI","Q2","jacobi","maxim","theta","condition","e","ev","rungekutta","t_j","u_j","order","k1","k2","k3","romberg","h1","g","richardson","X","pos","y1","h_min","simpson","hermite","F","dF","dl","lagrange","cubic_spline","sq","gauss_quadrature","PCA","temp1","D","temp2","Y","Bt","C","Vt","differenceOfProportions","n1","n2","pooled","zscore","ztest","sides","tscore","ttest","anovafscore","expVar","sampMean","sampSampMean","tmpargs","unexpVar","anovaftest","ftest","fscore","anovaftes","qscore","mean1","mean2","qtest","tukeyhsd","arrays","means","normalci","change","tci","significant","pvalue","oneSidedDifferenceOfProportions","twoSidedDifferenceOfProportions","models","sub_regress","exog","var_count","endog_index","exog_index","ols","endog","nobs","df_model","df_resid","coef","predict","resid","ybar","SSE","SSR","SST","R2","t_test","model","subModelList","sigmaHat","seBetaHat","mod","tStatistic","pValue","leftppf","interval95","se","F_test","F_statistic","ols_wrap","adjust_R2","buildxmatrix","matrixRows","builddxmatrix","buildjxmatrix","jMat","pass","buildymatrix","buildjymatrix","matrixmult","regress","jMatX","jMatY","innerinv","xtranspxinv","xtransp","next","regresst","compile","jMatYBar","yBar","yAverage","anova","residuals","ssr","msr","sse","mse","sst","mst","r2","fratio","rmse","r2adj","stats","sds","ts","covar","xtranspx","inner","matrixsubtract","CHAR","String","fromCharCode","CODE","text","utils.anyIsError","charCodeAt","CONCATENATE","utils.flatten","someError","utils.anyError","trueFound","indexOf","falseFound","join","CONCAT","REPT","utils.parseString","UNICHAR","UNICODE","isValidBinaryNumber","COMPLEX","real","imaginary","suffix","ERF","lower_bound","upper_bound","ERFC","IMABS","inumber","IMREAL","IMAGINARY","plus","replace","minus","last","substring","unit","IMARGUMENT","error.div0","IMCOS","IMCOSH","IMDIV","inumber1","inumber2","unit1","unit2","den","IMSIN","IMSINH","PRECISE","validSymbols","_TOKEN_TYPE_OPERATOR","_TOKEN_TYPE_LITERAL","SUPPORTED_TOKENS","TOKEN_TYPE_OPERATOR","TOKEN_TYPE_LITERAL","createToken","type","analyzeTokens","tokens","literalValue","analyzedTokens","token","castValueToCorrectType","unshift","parse","expression","expressionLength","cursorIndex","processedValue","processedSymbol","char","charAt","tokenizeExpression","compute","operator","values","evaluate","ERROR","ISERR","error.ref","error.name","error.nil","ISERROR","error.na","ISLOGICAL","ISNUMBER","ISTEXT","UNIQUE","hasElement","element","TYPE","error_val","error.data","FLATTEN","AVERAGE","flatArguments","flatArgumentsDefined","utils.isDefined","utils.numbers","AVERAGEA","BETA","cumulative","probability","BINOM","successes","trials","DIST","RANGE","successes2","mathTrig.COMBIN","INV","CHISQ","RT","TEST","observed","expected","xsqr","Pi","ChiSq","CONFIDENCE","COUNT","COUNTA","COUNTBLANK","blanks","NORM","COVARIANCE","P","array1","array2","utils.parseNumberArray","S","EXPON","lambda","FORECAST","data_y","data_x","xmean","ymean","GAMMA","GAMMALN","d1","d2","sumOfSquares","mathTrig.SUM","HYPGEOM","LARGE","LINEST","LOGNORM","MAX","MEDIAN","utils.arrayValuesToNumbers","MIN","MODE","currentItem","maxItems","MULT","NEGBINOM","PEARSON","den1","den2","PERCENTILE","fl","utils.cleanFloat","PERCENTRANK","EXC","significance","uniques","misc.UNIQUE","match","INC","POISSON","QUARTILE","quart","RANK","SKEW","SMALL","AVG","EQ","m3","STDEV","VAR","tails","mean_x","mean_y","s_x","s_y","VARA","VARPA","WEIBULL","Z","CEILING","precision","ROUND","COMBIN","number_chosen","FACT","MATH","MEMOIZED_FACT","FLOOR","ISO","POWER","PRODUCT","digits","SUM","utils.arrayEach","utils.argsToArray","inner_result","BETADIST","statistical.BETA","BETAINV","BINOMDIST","statistical.BINOM","CEILINGMATH","mathTrig.CEILING","CEILINGPRECISE","CHIDIST","statistical.CHISQ","CHIDISTRT","CHIINV","CHIINVRT","CHITEST","COVAR","statistical.COVARIANCE","COVARIANCEP","COVARIANCES","CRITBINOM","ERFCPRECISE","engineering.ERFC","ERFPRECISE","engineering.ERF","EXPONDIST","statistical.EXPON","FDIST","statistical.F","FDISTRT","FINV","FINVRT","FLOORMATH","mathTrig.FLOOR","FLOORPRECISE","FTEST","GAMMADIST","statistical.GAMMA","GAMMAINV","GAMMALNPRECISE","statistical.GAMMALN","HYPGEOMDIST","statistical.HYPGEOM","LOGINV","statistical.LOGNORM","LOGNORMDIST","LOGNORMINV","MODEMULT","statistical.MODE","MODESNGL","SNGL","NEGBINOMDIST","statistical.NEGBINOM","NETWORKDAYSINTL","dateTime.NETWORKDAYS","NORMDIST","statistical.NORM","NORMINV","NORMSDIST","NORMSINV","PERCENTILEEXC","statistical.PERCENTILE","PERCENTILEINC","PERCENTRANKEXC","statistical.PERCENTRANK","PERCENTRANKINC","POISSONDIST","statistical.POISSON","QUARTILEEXC","statistical.QUARTILE","QUARTILEINC","RANKAVG","statistical.RANK","RANKEQ","SKEWP","statistical.SKEW","STDEVP","statistical.STDEV","STDEVS","TDIST","statistical.T","TDISTRT","TINV","TTEST","VARP","statistical.VAR","VARS","WEIBULLDIST","statistical.WEIBULL","WORKDAYINTL","dateTime.WORKDAY","ZTEST","statistical.Z","compact","FINDFIELD","database","title","findResultIndex","criterias","matches","maxCriteriaLength","currentCriteriaResult","hasMatchingCriteria","criteria","criteriaField","tokenizedCriteria","evalExpression.parse","evalExpression.createToken","evalExpression.TOKEN_TYPE_LITERAL","evalExpression.compute","validDate","getTime","ensureDate","FV","periods","payment","term","IPMT","period","present","future","PMT","NPV","VLOOKUP","needle","table","rangeLookup","isNumberLookup","exactMatchOnly","localeCompare","issue","settlement","par","frequency","dateTime.YEARFRAC","num1","num2","function_num","options","ref1","ref2","statistical.AVERAGE","statistical.COUNT","statistical.COUNTA","statistical.MAX","statistical.MIN","statistical.MEDIAN","statistical.LARGE","statistical.SMALL","CM","CD","XC","XL","IX","IV","number_x","number_y","atan2","average_range","flatAverageRange","flatAverageRangeDefined","average_count","isWildcard","criteriaLength","isMeetCondition","computedResult","radix","min_length","bessel","stringified","places","text.REPT","number1","number2","shift","matrix","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Ti","Gi","Mi","ki","unit_prefixes","E","G","from","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","e2","interest","principal","start_date_year","start_date_month","start_date_day","end_date_year","end_date_month","end_date_day","setFullYear","setMonth","date_text","field","resultIndexes","targetFields","utils.rest","serial_number","cost","salvage","life","toFixed","initial","ceiling","targetValues","stats.COUNT","stats.COUNTA","dividend","divisor","maxValue","minValue","dollar","fraction","LN10","LN2","stats.STDEV","maths.SUM","stats.VAR","months","value1","value2","text1","text2","error.error","FACTDOUBLE","find_text","within_text","position","found_index","e2y","schedule","r0","ri","known_y","known_x","new_x","use_const","avg_x","avg_y","avg_xy","avg_xx","new_y","utils.anyIsString","negative","toLowerCase","decimal","getHours","line","then_value","otherwise_value","valueIfError","information.ISERROR","value_if_na","cellRange","rowNumber","columnNumber","isOneDimensionRange","second","hour","sec","guess","irrResult","dates","irrResultDeriv","positive","newRate","epsRate","resultValue","resultRate","contLoop","separator","pop","textAsString","base","LOG2E","searchCriterion","resultArray","lookupValue","lookupArray","matchType","indexValue","begin","getMinutes","finance_rate","reinvest_rate","payments","incomes","modulus","multiple","factor1","factor2","logical","decimal_separator","group_separator","mathTrig.FACT","exponent","lower","upper","sorted","txt","substr","numerator","denominator","bottom","top","epsMax","dy","context","reference","path","opening","regular_expression","full","replacement","new_text","key","roman","foundAt","getSeconds","coefficients","lft","old_text","occurrence","function_code","sumRange","sumValue","valueToTest","_i","_ij","_ij_arg","_i_arg","information.ISNUMBER","array_x","array_y","targetValue","argc","switchCount","switchSatisfied","hasDefaultClause","defaultClause","maturity","discount","dateTime.DAYS360","price","delimiter","ignore_empty","_len","_key","flatArgs","textToJoin","chunks","item","minute","time_text","new_data_x","linest","trim","percent","isPercent","output","return_type","week_start","jan","inc","utils.parseDateArray","dateTime.DAYS"],"mappings":"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"}